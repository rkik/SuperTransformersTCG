{
  "SaveName": "SuperDestinyCleanLoad",
  "GameMode": "Super Destiny",
  "Gravity": 0.5,
  "Date": "10/11/2018 8:27:39 PM",
  "Table": "Table_Custom_Square",
  "TableURL": "http://cloud-3.steamusercontent.com/ugc/922547277902504571/4C206C65460313386BFA3A08981FECD188A8DEB8/",
  "Sky": "Sky_Regal",
  "SkyURL": "http://cloud-3.steamusercontent.com/ugc/257091087996710277/5A167BD78A3FA4181A524A6C6C725E5DFBE6E12D/",
  "Note": "",
  "Rules": "",
  "XmlUI": "<Panel\r\n   id=\"main_menu_panel\"\r\n   visibility=\"Host\"\r\n   active=\"false\"\r\n   rectAlignment=\"MiddleCenter\"\r\n   offsetXY=\"0 175\"\r\n   width=\"480\"\r\n   height=\"240\"\r\n   allowDragging=\"true\"\r\n   returnToOriginalPositionWhenReleased=\"false\"\r\n>\r\n\r\n<Button\r\n   offsetXY=\"0 0\"\r\n   width=\"226\"\r\n   height=\"226\"\r\n   onClick=\"2a325b/twoPlayerModernFromGUI\"\r\n   image=\"main_menu_button\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>2-Player\r\nModern\r\n(beta)</Button>\r\n<Button\r\n   id=\"change_table_color_button\"\r\n   active=\"true\"\r\n   offsetXY=\"0 -250\"\r\n   width=\"226\"\r\n   height=\"226\"\r\n   onClick=\"enableTableThumbnails\"\r\n   image=\"main_menu_button\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Options</Button>\r\n\r\n<Panel\r\n   id=\"table_thumbnail_panel\"\r\n   active=\"false\"\r\n   offsetXY=\"-80 0\"\r\n>\r\n<Button\r\n   id=\"table_black\"\r\n   offsetXY=\"-320 -250\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_black\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Super Black\r\n</Button>\r\n<Button\r\n   id=\"table_classic_blue\"\r\n   offsetXY=\"-160 -250\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_classic_blue\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Classic Blue\r\n</Button>\r\n<Button\r\n   id=\"table_felt_black\"\r\n   offsetXY=\"0 -250\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_black\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Black\r\n</Button>\r\n<Button\r\n   id=\"table_felt_dark_gray\"\r\n   offsetXY=\"160 -250\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_dark_gray\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Dark Gray\r\n</Button>\r\n<Button\r\n   id=\"table_felt_gray\"\r\n   offsetXY=\"320 -250\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_gray\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Gray\r\n</Button>\r\n<Button\r\n   id=\"table_felt_white\"\r\n   offsetXY=\"480 -250\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_white\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt White\r\n</Button>\r\n<Button\r\n   id=\"table_felt_blue\"\r\n   offsetXY=\"-320 -410\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_blue\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Blue\r\n</Button>\r\n<Button\r\n   id=\"table_felt_aqua\"\r\n   offsetXY=\"-160 -410\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_aqua\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Aqua\r\n</Button>\r\n<Button\r\n   id=\"table_felt_green\"\r\n   offsetXY=\"0 -410\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_green\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Green\r\n</Button>\r\n<Button\r\n   id=\"table_felt_red\"\r\n   offsetXY=\"160 -410\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_red\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Red\r\n</Button>\r\n<Button\r\n   id=\"table_felt_purple\"\r\n   offsetXY=\"320 -410\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_felt_purple\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Felt Purple\r\n</Button>\r\n<Button\r\n   id=\"table_camo_green\"\r\n   offsetXY=\"480 -410\"\r\n   width=\"150\"\r\n   height=\"150\"\r\n   onClick=\"setTableDesign\"\r\n   image=\"thumbnail_camo_green\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Camo Green\r\n</Button>\r\n<Image\r\n   offsetXY=\"-320 -250\"\r\n   id=\"table_design_marker\"\r\n   width=\"170\"\r\n   height=\"170\"\r\n   image=\"table_design_marker\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n<Text\r\n   id=\"table_design_loading\"\r\n   active=\"false\"\r\n   offsetXY=\"0 -144\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#888888\"\r\n>Table Design Loading...</Text>\r\n</Panel>\r\n\r\n<Panel\r\n   id=\"table_mat_panel\"\r\n   active=\"false\"\r\n   offsetXY=\"0 -550\"\r\n>\r\n<Button\r\n   id=\"board_super_black\"\r\n   offsetXY=\"-135 0\"\r\n   width=\"250\"\r\n   height=\"80\"\r\n   onClick=\"setBoardStyle\"\r\n   image=\"thumbnail_board_black\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Super Black Boards\r\n</Button>\r\n<Button\r\n   id=\"board_transparent\"\r\n   offsetXY=\"135 0\"\r\n   width=\"250\"\r\n   height=\"80\"\r\n   onClick=\"setBoardStyle\"\r\n   image=\"thumbnail_board_transparent\"\r\n   fontSize=\"32\"\r\n   textColor=\"#FFFFFF\"\r\n>Transparent Boards\r\n</Button>\r\n<Image\r\n   offsetXY=\"135 0\"\r\n   id=\"board_style_marker\"\r\n   width=\"270\"\r\n   height=\"100\"\r\n   image=\"board_style_marker\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n</Panel>\r\n\r\n</Panel>\r\n\r\n\r\n\r\n<Panel\r\n   id=\"blue_panel\"\r\n   visibility=\"Blue\"\r\n   active=\"false\"\r\n   rectAlignment=\"LowerRight\"\r\n   width=\"265\"\r\n   height=\"318\"\r\n   image=\"ingame_gui_background\"\r\n   allowDragging=\"true\"\r\n   returnToOriginalPositionWhenReleased=\"false\"\r\n>\r\n<Image\r\n   offsetXY=\"0 115\"\r\n   width=\"265\"\r\n   height=\"80\"\r\n   image=\"ingame_blue_panel_overlay\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n<Text\r\n   id=\"blue_panel_red_cards\"\r\n   offsetXY=\"-20 133\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Text\r\n   id=\"blue_panel_blue_cards\"\r\n   offsetXY=\"-20 98\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Button\r\n   offsetXY=\"100 180\"\r\n   width=\"30\"\r\n   height=\"30\"\r\n   onClick=\"guiToggle\"\r\n   image=\"ingame_gui_minimize\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"-60 -92\"\r\n   width=\"92\"\r\n   height=\"92\"\r\n   toolTip=\"Shuffle your hand\"\r\n   onClick=\"guiShuffle\"\r\n   image=\"ingame_gui_shuffle\"\r\n   tooltipPosition=\"Above\"\r\n   tooltipBackgroundColor=\"rgba(0,0,0,1)\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"60 -92\"\r\n   width=\"92\"\r\n   height=\"92\"\r\n   toolTip=\"Discard a random card\"\r\n   onClick=\"guiDiscard\"\r\n   image=\"ingame_gui_discard\"\r\n   tooltipPosition=\"Above\"\r\n   tooltipBackgroundColor=\"rgba(0,0,0,1)\"\r\n   fontSize=\"32\"\r\n   textColor=\"#000000\"\r\n></Button>\r\n</Panel>\r\n\r\n\r\n\r\n<Panel\r\n   id=\"red_panel\"\r\n   visibility=\"Red\"\r\n   active=\"false\"\r\n   rectAlignment=\"LowerRight\"\r\n   width=\"265\"\r\n   height=\"318\"\r\n   image=\"ingame_gui_background\"\r\n   allowDragging=\"true\"\r\n   returnToOriginalPositionWhenReleased=\"false\"\r\n>\r\n<Image\r\n   offsetXY=\"0 115\"\r\n   width=\"265\"\r\n   height=\"80\"\r\n   image=\"ingame_red_panel_overlay\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n<Text\r\n   id=\"red_panel_blue_cards\"\r\n   offsetXY=\"-20 133\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Text\r\n   id=\"red_panel_red_cards\"\r\n   offsetXY=\"-20 98\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Button\r\n   offsetXY=\"100 180\"\r\n   width=\"30\"\r\n   height=\"30\"\r\n   onClick=\"guiToggle\"\r\n   image=\"ingame_gui_minimize\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"-60 -92\"\r\n   width=\"92\"\r\n   height=\"92\"\r\n   toolTip=\"Shuffle your hand\"\r\n   onClick=\"guiShuffle\"\r\n   image=\"ingame_gui_shuffle\"\r\n   tooltipPosition=\"Above\"\r\n   tooltipBackgroundColor=\"rgba(0,0,0,1)\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"60 -92\"\r\n   width=\"92\"\r\n   height=\"92\"\r\n   toolTip=\"Discard a random card\"\r\n   onClick=\"guiDiscard\"\r\n   image=\"ingame_gui_discard\"\r\n   tooltipPosition=\"Above\"\r\n   tooltipBackgroundColor=\"rgba(0,0,0,1)\"\r\n   fontSize=\"32\"\r\n   textColor=\"#000000\"\r\n></Button>\r\n</Panel>",
  "CustomUIAssets": [
    {
      "Name": "ingame_gui_background",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666385380/A47369F346253BDE02F44153C4940D47AA0E6E67/"
    },
    {
      "Name": "ingame_gui_resource",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666388925/ACEB3703278FB7DFB707BFE2DE931571529BD372/"
    },
    {
      "Name": "ingame_gui_pass",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666388357/43FDE0C7B097A67D681F9D35D91535A8EA66F3EE/"
    },
    {
      "Name": "ingame_gui_shuffle",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666389375/842D3237A768D7171668FCD28264F81C30BFEE0D/"
    },
    {
      "Name": "ingame_gui_discard",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666386672/85210903AED7A7F638BA6784A45A042013DD28FC/"
    },
    {
      "Name": "ingame_blue_panel_overlay",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666384731/E921F14A80CFA7C3BC20C7D7C61D7319443D0169/"
    },
    {
      "Name": "ingame_gui_maximize",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666387411/82FAD658AECC1F80A3413BEB32A2971FF168E4BF/"
    },
    {
      "Name": "ingame_gui_minimize",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666387875/C5EF88F206BBFA0A135436274D1C10C0D922A838/"
    },
    {
      "Name": "ingame_red_panel_overlay",
      "URL": "http://cloud-3.steamusercontent.com/ugc/948454725666389779/69DCF9BD43E89F93351F7F2F8E87D5CFFD7E3EF7/"
    },
    {
      "Name": "main_menu_button",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952958746594259776/2B2E59525D64EFA5F682CC08C4825A0FE3AF61E7/"
    },
    {
      "Name": "main_menu_panel",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952958746594265164/ACD71BEEB7A3D7E3768FAAE0265125873F9FCA87/"
    },
    {
      "Name": "red_battlefield_claim",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959000918850667/5CBF41F8886AC21025405DE4568BE998F478165E/"
    },
    {
      "Name": "blue_battlefield_claim",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959000918851189/EE82D1A6844C4548CDA3AA486D91D00BE7FFE048/"
    },
    {
      "Name": "thumbnail_felt_gray",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191175680420/E46946AC7FA11E6B5DD00FEED7C2025041A8BEB3/"
    },
    {
      "Name": "thumbnail_black",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191175680910/5F8A33B311807868066AF6FE8BB2686386534E46/"
    },
    {
      "Name": "thumbnail_classic_blue",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191175693237/C1BF0DB570B7750940CAC7F2A37BE9EDF8BA23A8/"
    },
    {
      "Name": "thumbnail_felt_dark_gray",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191175952477/EE8201E085C4EAC979BD14D20DB455034CB733FC/"
    },
    {
      "Name": "thumbnail_felt_black",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191175963555/A8E236F91FDCCFC26BC80D48EE79C135FB0DDB84/"
    },
    {
      "Name": "thumbnail_felt_blue",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191176031053/EA13F9423119957B840360DBAF734C350B78C78C/"
    },
    {
      "Name": "thumbnail_felt_aqua",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191176031551/3FE5A98E79850FB429A0E96CC738F3D9C5B79E24/"
    },
    {
      "Name": "thumbnail_felt_green",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191176064972/DD74EF55C9156B2F3CE99335F44634E7E4DED8E2/"
    },
    {
      "Name": "thumbnail_felt_red",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191176066217/D82C72D645E60E396DD47FAE011D34E142F32584/"
    },
    {
      "Name": "thumbnail_felt_purple",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959191176067934/A20C1666BE8E53BDF865D68A45FE3505155A0B5D/"
    },
    {
      "Name": "card_plus_button",
      "URL": "http://cloud-3.steamusercontent.com/ugc/932693183049785426/CD098AC296A5D9124CB9A7F7526BEF7D91881249/"
    },
    {
      "Name": "card_minus_button",
      "URL": "http://cloud-3.steamusercontent.com/ugc/932693183049785038/A3CE1312007B6D4BCDEB2D84F9EB5B498D122C4B/"
    },
    {
      "Name": "card_shield",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959316956336450/435B327FE88014C1537D79BE7C14AFE2DFD8D8E0/"
    },
    {
      "Name": "card_damage",
      "URL": "http://cloud-3.steamusercontent.com/ugc/952959316956327073/77138A8358F3B5A0DD96FBE1EB931FC32FCF1841/"
    },
    {
      "Name": "thumbnail_camo_green",
      "URL": "http://cloud-3.steamusercontent.com/ugc/981107421962185725/5D3AD80A178A4F75069A2486C61D0EA1A8AAF55A/"
    },
    {
      "Name": "thumbnail_felt_white",
      "URL": "http://cloud-3.steamusercontent.com/ugc/981107421962186647/78531E32B4A0FB077077DBC9F8B768E4BC9B4C93/"
    },
    {
      "Name": "table_design_marker",
      "URL": "http://cloud-3.steamusercontent.com/ugc/981107421962276701/A236259884D58CA2E1E7858D9C3F32EFDD73AD16/"
    },
    {
      "Name": "board_style_marker",
      "URL": "http://cloud-3.steamusercontent.com/ugc/981107421962366024/1AC6DC9A594CB90AED5487D18BD502903553F0CB/"
    },
    {
      "Name": "thumbnail_board_black",
      "URL": "http://cloud-3.steamusercontent.com/ugc/981107421964453185/C63E6DEB256AFEE7361C939A0FA90F8DB7CE1A07/"
    },
    {
      "Name": "thumbnail_board_transparent",
      "URL": "http://cloud-3.steamusercontent.com/ugc/981107421964459469/565D395B4C8281C5E6AF8B92D8023ED915708372/"
    }
  ],
  "LuaScript": "-- Modified by Rkik in 2018 for Transformers TCG.\r\n\r\nfunction onload()\r\n  -- In case the mod was just loaded, start as Blue so the menu is right side up.\r\n  Player.White.changeColor('Blue')\r\n\r\n  SUPER_TRANSFORMERS_VERSION       = \"0.0.1\"\r\n\r\n  menuGuid                    = '2a325b'\r\n  blueBoardsTransparentGuid   = '4e185d'\r\n  blueBoardsBlackGuid         = 'd70420'\r\n  redBoardsTransparentGuid    = '59f7a8'\r\n  redBoardsBlackGuid          = '7c57f9'\r\n\r\n  trashBagAGuid               = 'dbae5f'\r\n  trashBagBGuid               = 'a5d1bd'\r\n\r\n  -- Rivals setup.\r\n  numWinchesterPlayers     = 0\r\n  limboCheckEnabled        = false\r\n  periodicLimboCheckWaitID = nil\r\n  pleaseWaitBoardGuid      = '251e70'\r\n  passLeftBoardGuid        = '652fd2'\r\n  passRightBoardGuid       = 'fbdc80'\r\n  winchesterBoardGuid      = 'b12301'\r\n  winchesterStockZones     = {}\r\n  winchesterDraftZones     = {}\r\n  winchesterBasePositions  = {}\r\n  winchesterNumZoneCards   = {}\r\n  -- NOTE:  The number of Winchester packs should be a multiple of 4 or things may break and/or be unbalanced (like more first dice picks).\r\n  -- NOTE:  The number of Winchester packs MUST be a multiple of 2, or else the final card may not be dealt correctly.\r\n  numWinchesterPacks       = 8\r\n  winchesterPickCount      = 0\r\n  winchesterPickCountText  = nil\r\n  dealHeight               = 0\r\n\r\n  -- The please wait board already exists in the world.\r\n  pleaseWaitBoard          = getObjectFromGUID(pleaseWaitBoardGuid)\r\n\r\n  -- Make sure it cannot be interacted with.\r\n  pleaseWaitBoard.use_gravity = false\r\n  pleaseWaitBoard.interactable = false\r\n  pleaseWaitBoard.setLock(true)\r\n\r\n  -- These boards have not yet spawned.\r\n  winchesterBoard          = nil\r\n  passLeftBoard            = nil\r\n  passRightBoard           = nil\r\n\r\n  mainMenuPanelOpen        = true\r\n  modernInterfaceActive    = true\r\n  draftGameStarted         = false\r\n  normalGameStarted        = false\r\n  cubeCompatibilityMode    = false\r\n  areBoardsInteractable    = false\r\n  diceSpawnDebug           = false\r\n  curHostColor             = nil\r\n  passRound                = 1\r\n  curWinchesterPlayer      = nil\r\n  rivalsMode               = \"None\"\r\n  packSelections           = nil\r\n  nextExpansionIndex       = {}\r\n  rivalsExpansionPacks     = nil\r\n  mixedPacksDeck           = nil\r\n  dealtCards               = {}\r\n  numPacksDealt            = 0\r\n  seatedPlayers            = {}\r\n\r\n  boardStyle               = \"board_transparent\"\r\n\r\n  blueBoardsPrefab         = nil\r\n  blueResourceZone         = nil\r\n  blueBattlefieldZone      = nil\r\n  blueMatZone              = nil\r\n  redBoardsPrefab          = nil\r\n  redResourceZone          = nil\r\n  redBattlefieldZone       = nil\r\n  redMatZone               = nil\r\n\r\n  bluePanelMaximized       = true\r\n  blueHandCount            = 0\r\n  blueResourceCount        = 0\r\n  redPanelMaximized        = true\r\n  redHandCount             = 0\r\n  redResourceCount         = 0\r\n\r\n  -- Use a small startup delay that blocks dice from spawning.  Otherwise if a midgame save file is loaded, more dice will spawn.\r\n  loadDelayFinished        = false\r\n  Wait.time(function() loadDelayFinished = true end, 1.0)\r\n\r\n  scanSeatedPlayers()\r\n  -- Make sure the panels are hidden to start with.\r\n  UI.setAttribute(\"blue_panel\", \"active\", false)\r\n  UI.setAttribute(\"red_panel\", \"active\", false)\r\n  -- Start a repeating function to check hand counts.\r\n  Wait.time(periodicHandCheck, 0.5)\r\n\r\n  -- Initialize base positions used for Winchester cards.\r\n  winchesterBasePositions[1] = { 21.10, 1.00, 7.10}\r\n  winchesterBasePositions[2] = {  9.20, 1.00, 7.10}\r\n  winchesterBasePositions[3] = { -2.68, 1.00, 7.10}\r\n  winchesterBasePositions[4] = {-14.58, 1.00, 7.10}\r\n\r\n  -- Initialize card counts for Winchester zones.\r\n  winchesterNumZoneCards[1] = 0\r\n  winchesterNumZoneCards[2] = 0\r\n  winchesterNumZoneCards[3] = 0\r\n  winchesterNumZoneCards[4] = 0\r\n\r\n  setupBagGuid             = '771f25'\r\n\r\n  setupObject = getObjectFromGUID(setupBagGuid)\r\n  if setupObject != nil then\r\n    setupObject.interactable = true\r\n  end\r\n\r\n  gameTableReference       = nil\r\n  tempTableDesignObject    = nil\r\n  tableDesignLoading       = false\r\n\r\n  -- Use a ray cast to get a reference to the table.\r\n  local castParameters = {origin={0,2,0}, direction={0,-1,0}, type=1}\r\n  local hitObjects = Physics.cast(castParameters)\r\n  for hitIndex,curHit in ipairs(hitObjects) do\r\n    if curHit.hit_object.tag == \"Surface\" then\r\n      gameTableReference = curHit.hit_object\r\n      break\r\n    end\r\n  end\r\n\r\n  matKeys                  = {}\r\n  matImages                = {}\r\n  matKeys[1]               = 'art'\r\n  matKeys[2]               = 'hyp'\r\n  matKeys[3]               = 'reb'\r\n  matKeys[4]               = 'gld'\r\n  matKeys[5]               = 'kor'\r\n  matKeys[6]               = 'DL1'\r\n  matKeys[7]               = 'DL2'\r\n  matImages[\"art\"]         = 'http://cloud-3.steamusercontent.com/ugc/919177062066839900/DDD5D7A493F214C1DEA9F1ED58391DF77163C9E2/'\r\n  matImages[\"hyp\"]         = 'http://cloud-3.steamusercontent.com/ugc/919177062067046601/96ECA6342810F724B1ED851D101C754917D04FBD/'\r\n  matImages[\"reb\"]         = 'http://cloud-3.steamusercontent.com/ugc/948454511079982384/AC0ADA96B12CD5E88E75EEB109E8E6B548857ACD/'\r\n  matImages[\"gld\"]         = 'http://cloud-3.steamusercontent.com/ugc/920304477969141605/5D7397B74461A96CD86F438129FCDC0B1AA0A9D4/'\r\n  matImages[\"kor\"]         = 'http://cloud-3.steamusercontent.com/ugc/952959191178358429/AE3BB1947C78495EA4EC63FA58B116A55E116310/'\r\n  matImages[\"DL1\"]         = 'http://cloud-3.steamusercontent.com/ugc/920304477969169347/2D3828075808D4531890FC9B0CAB9F03DC358BBF/'\r\n  matImages[\"DL2\"]         = 'http://cloud-3.steamusercontent.com/ugc/920304477969169845/95318949E96B74FA31C108524A6C0DB4380C05B2/'\r\n\r\n  randomizeMats()\r\n\r\n  updateBagColors()\r\n\r\n  -- Wait before making things uninteractable, or else it does not seem to work, presumably because of reload() in randomizeMats().\r\n  Wait.time(makeDraftTilesUninteractable, 0.5)\r\n  Wait.time(function() setInteractableBoards(areBoardsInteractable) end, 0.5)\r\n\r\n  tokenplayerone = {\r\n      damageone = \"http://cloud-3.steamusercontent.com/ugc/194046562280483535/A29691412CEC7FDE752A603736EBB99405CC347B/\",\r\n      damagethree = \"http://cloud-3.steamusercontent.com/ugc/194046562280484252/758430B535676DA603F0041356827EE9BD7B830A/\",\r\n      shield = \"http://cloud-3.steamusercontent.com/ugc/194046562280485442/DA82F2C7D32BF37A2CB403635876FF96D7D1B0E8/\",\r\n      resource = \"http://cloud-3.steamusercontent.com/ugc/194046562280484903/A696882BD4631043881D60F55CC823EE1FC7BE1D/\"\r\n  }\r\n  tokenplayertwo = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/194046562280483535/A29691412CEC7FDE752A603736EBB99405CC347B/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/194046562280484252/758430B535676DA603F0041356827EE9BD7B830A/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/194046562280485442/DA82F2C7D32BF37A2CB403635876FF96D7D1B0E8/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/194046562280484903/A696882BD4631043881D60F55CC823EE1FC7BE1D/\"\r\n  }\r\n\r\n  printToAll(\"===========================================\", {1,1,1})\r\n  printToAll(\"Super Transformers TCG version \" .. SUPER_TRANSFORMERS_VERSION, {1,1,1})\r\n  printToAll(\"\", {1,1,1})\r\n  printToAll(\"Type \\\"!help\\\" in chat for a command list.\", {1,1,1})\r\n  printToAll(\"===========================================\", {1,1,1})\r\nend\r\n\r\n-- Data for seats.  Each entry contains information on the following:\r\n--\r\n-- Whether the seat is filled.\r\n-- Guid of an object to hold dice.\r\n-- Vector indicating which direction dice should be spawned.\r\n-- Vector indicating which direction dice rows grow.\r\n-- Guid of an object to hold the Rivals deck.\r\n-- Guid of an object to hold a Pass button.\r\n-- Guid for a draft card scripting zone.\r\n-- Guid of an object to hold the limbo deck.\r\n-- Whether this seat has a Pass button.\r\n-- Whether this seat should have a Pass button.\r\n-- The limbo deck.\r\n-- The draw deck.  NOTE:  This variable may occasionally be invalid, such as when a player is down to their last card,\r\n--                        or if a deck is combined with another deck.  If it becomes invalid, the script zone must\r\n--                        be searched.\r\n-- Whether this player's draft stack has cards.\r\n-- Whether this player's limbo area has cards.\r\n-- How many pass turns this player finished.\r\n-- A horizontal offset for placing dice for this player.\r\n-- A row offset for placing dice for this player.\r\nseatData = {\r\n  [\"Green\"]   = { filled=false, diceHolderGuid='e603b5', diceDirectionVector={-1,0,0}, diceRowDirectionVector={0,0,-1}, rivalsDeckHolderGuid='4297fe', passButtonHolderGuid='71f70f', scriptZoneGuid='f05de1', limboHolderGuid='7a0028', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='64ea2a', hiddenZonePosition={-11.57, 35, 23.71}, matGuid='ab8055'},\r\n  [\"Blue\"]    = { filled=false, diceHolderGuid='38f77f', diceDirectionVector={-1,0,0}, diceRowDirectionVector={0,0,-1}, rivalsDeckHolderGuid='6d097a', passButtonHolderGuid='6214b1', scriptZoneGuid='645473', limboHolderGuid='0bd257', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='0b4a6e', hiddenZonePosition={  7.51, 35, 23.71}, matGuid='2cdefc'},\r\n  [\"Purple\"]  = { filled=false, diceHolderGuid='dfd6c9', diceDirectionVector={0,0,1},  diceRowDirectionVector={-1,0,0}, rivalsDeckHolderGuid='f61d1d', passButtonHolderGuid='61ba3d', scriptZoneGuid='f43f15', limboHolderGuid='3da4dc', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='db8bab', hiddenZonePosition={ 23.71, 35, 11.57}, matGuid='e51074'},\r\n  [\"Pink\"]    = { filled=false, diceHolderGuid='79e39b', diceDirectionVector={0,0,1},  diceRowDirectionVector={-1,0,0}, rivalsDeckHolderGuid='f5eeef', passButtonHolderGuid='623f55', scriptZoneGuid='54b60a', limboHolderGuid='bab556', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='bb0332', hiddenZonePosition={ 23.71, 35, -7.51}, matGuid='5dc222'},\r\n  [\"White\"]   = { filled=false, diceHolderGuid='41c691', diceDirectionVector={1,0,0},  diceRowDirectionVector={0,0,1},  rivalsDeckHolderGuid='78a6a5', passButtonHolderGuid='bbd437', scriptZoneGuid='6c8d53', limboHolderGuid='cf5444', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='5aa86f', hiddenZonePosition={ 11.57, 35,-23.71}, matGuid='96f199'},\r\n  [\"Red\"]     = { filled=false, diceHolderGuid='301d4c', diceDirectionVector={1,0,0},  diceRowDirectionVector={0,0,1},  rivalsDeckHolderGuid='cb63fc', passButtonHolderGuid='0b4f1d', scriptZoneGuid='e88ebb', limboHolderGuid='750faf', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='aeedb8', hiddenZonePosition={ -7.51, 35,-23.71}, matGuid='772bad'},\r\n  [\"Orange\"]  = { filled=false, diceHolderGuid='25c131', diceDirectionVector={0,0,-1}, diceRowDirectionVector={1,0,0},  rivalsDeckHolderGuid='795944', passButtonHolderGuid='7b408b', scriptZoneGuid='a2c916', limboHolderGuid='90cb62', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='19c306', hiddenZonePosition={-23.71, 35,-11.57}, matGuid='737a7e'},\r\n  [\"Yellow\"]  = { filled=false, diceHolderGuid='7a43ac', diceDirectionVector={0,0,-1}, diceRowDirectionVector={1,0,0},  rivalsDeckHolderGuid='41b6c1', passButtonHolderGuid='2a267a', scriptZoneGuid='b99e98', limboHolderGuid='1cf0d6', hasButton=false, shouldHaveButton=false, limboDeck=nil, drawDeck=nil, draftStackHasCards=false, limboHasCards=false, passTurnsFinished=0, dieOffset=0, dieRowOffset=0, hiddenZoneGuid='0c446e', hiddenZonePosition={-23.71, 35,  7.51}, matGuid='827083'}\r\n}\r\n\r\ncharacterGUILuaScript = [[\r\nfunction onload()\r\n  -- Load inside the script since global images do not work for players who join late.\r\n  local resourceAssets = {\r\n    {\r\n      name = \"card_minus_button\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/932693183049785038/A3CE1312007B6D4BCDEB2D84F9EB5B498D122C4B/\"\r\n    },\r\n    {\r\n      name = \"card_plus_button\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/932693183049785426/CD098AC296A5D9124CB9A7F7526BEF7D91881249/\"\r\n    },\r\n    {\r\n      name = \"card_shield\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/952959316956336450/435B327FE88014C1537D79BE7C14AFE2DFD8D8E0/\"\r\n    }\r\n  }\r\n  self.UI.setCustomAssets(resourceAssets)\r\n\r\n  self.UI.setXml(Global.getVar(\"characterGUIXMLScript\"))\r\n\r\n  -- The XML buttons do nothing and are implemented by hidden classic buttons, since GUI XML buttons can be triggered by middle/right click with no way to differentiate.\r\n  self.createButton({\r\n    click_function=\"shieldMinus\", function_owner=self,\r\n    position={-1.290, 1.060, -3.205}, width=430, height=430, font_size=72, color={0,0,0,0}\r\n  })\r\n  self.createButton({\r\n    click_function=\"shieldPlus\", function_owner=self,\r\n    position={ 0.655, 1.060, -3.205}, width=430, height=430, font_size=72, color={0,0,0,0}\r\n  })\r\n\r\n  self.locked = true\r\n  self.interactable = false\r\nend\r\n\r\nfunction shieldMinus(buttonObject, playerColor, altClick)\r\n  if ((playerColor == owner) and (altClick == false)) then\r\n    if (shields > 0) then\r\n      shields = (shields - 1)\r\n      self.UI.setAttribute(\"shields\", \"text\", shields)\r\n      self.UI.setAttribute(\"opponent_view_shields\", \"text\", shields)\r\n\r\n      if ((shields == 6) or (shields == 9)) then\r\n        self.UI.setAttribute(\"shields_underline\", \"text\", \"_\")\r\n        self.UI.setAttribute(\"opponent_view_shields_underline\", \"text\", \"_\")\r\n      else\r\n        self.UI.setAttribute(\"shields_underline\", \"text\", \"\")\r\n        self.UI.setAttribute(\"opponent_view_shields_underline\", \"text\", \"\")\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction shieldPlus(buttonObject, playerColor, altClick)\r\n  if ((playerColor == owner) and (altClick == false)) then\r\n    shields = (shields + 1)\r\n    self.UI.setAttribute(\"shields\", \"text\", shields)\r\n    self.UI.setAttribute(\"opponent_view_shields\", \"text\", shields)\r\n\r\n    if ((shields == 6) or (shields == 9)) then\r\n      self.UI.setAttribute(\"shields_underline\", \"text\", \"_\")\r\n      self.UI.setAttribute(\"opponent_view_shields_underline\", \"text\", \"_\")\r\n    else\r\n      self.UI.setAttribute(\"shields_underline\", \"text\", \"\")\r\n      self.UI.setAttribute(\"opponent_view_shields_underline\", \"text\", \"\")\r\n    end\r\n  end\r\nend\r\n]]\r\n\r\ncharacterGUIXMLScript = [[\r\n<Panel\r\n   id=\"card_gui\"\r\n   active=\"false\"\r\n   position=\"0 200 -108\"\r\n   rotation=\"0 0 180\"\r\n   rectAlignment=\"MiddleCenter\"\r\n   width=\"128\"\r\n   height=\"128\"\r\n   raycastTarget=\"false\"\r\n>\r\n<Button\r\n   offsetXY=\"-129 520\"\r\n   width=\"80\"\r\n   height=\"80\"\r\n   image=\"card_minus_button\"\r\n   raycastTarget=\"false\"\r\n></Button>\r\n<Text\r\n   id=\"shields_underline\"\r\n   offsetXY=\"-32 520\"\r\n   scale=\"1.5 1.5\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"72\"\r\n   color=\"#FFFFFF\"\r\n></Text>\r\n<Text\r\n   id=\"shields\"\r\n   offsetXY=\"-32 520\"\r\n   scale=\"1.5 1.5\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"72\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Button\r\n   offsetXY=\"65 520\"\r\n   width=\"80\"\r\n   height=\"80\"\r\n   image=\"card_plus_button\"\r\n   raycastTarget=\"false\"\r\n></Button>\r\n<Image\r\n   offsetXY=\"160 520\"\r\n   width=\"80\"\r\n   height=\"80\"\r\n   image=\"card_shield\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n</Panel>\r\n\r\n<Panel\r\n   id=\"opponent_card_gui\"\r\n   active=\"false\"\r\n   position=\"0 200 -108\"\r\n   rotation=\"0 0 180\"\r\n   rectAlignment=\"MiddleCenter\"\r\n   width=\"128\"\r\n   height=\"128\"\r\n   raycastTarget=\"false\"\r\n>\r\n<Text\r\n   id=\"opponent_view_shields_underline\"\r\n   offsetXY=\"-32 520\"\r\n   rotation=\"0 0 180\"\r\n   scale=\"1.5 1.5\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"72\"\r\n   color=\"#FFFFFF\"\r\n></Text>\r\n<Text\r\n   id=\"opponent_view_shields\"\r\n   offsetXY=\"-32 520\"\r\n   rotation=\"0 0 180\"\r\n   scale=\"1.5 1.5\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"72\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Image\r\n   offsetXY=\"55 520\"\r\n   rotation=\"0 0 180\"\r\n   width=\"80\"\r\n   height=\"80\"\r\n   image=\"card_shield\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n</Panel>\r\n]]\r\n\r\nfunction makeDraftTilesUninteractable()\r\n  local curTile = nil\r\n\r\n  -- Make various draft tiles uninteractable to prevent alt-zooming them.\r\n  for i,someSeat in pairs(seatData) do\r\n    curTile = getObjectFromGUID(someSeat.diceHolderGuid)\r\n    if curTile != nil then\r\n      curTile.interactable = false\r\n    end\r\n\r\n    curTile = getObjectFromGUID(someSeat.rivalsDeckHolderGuid)\r\n    if curTile != nil then\r\n      curTile.interactable = false\r\n    end\r\n\r\n    curTile = getObjectFromGUID(someSeat.passButtonHolderGuid)\r\n    if curTile != nil then\r\n      curTile.interactable = false\r\n    end\r\n\r\n    curTile = getObjectFromGUID(someSeat.limboHolderGuid)\r\n    if curTile != nil then\r\n      curTile.interactable = false\r\n    end\r\n  end\r\nend\r\n\r\n-- TODO what about loading midgame?\r\nfunction setInteractableBoards(shouldBeInteractable)\r\n  -- Make mats uninteractable to prevent alt-zooming them.\r\n  local curMat = nil\r\n  for i,someSeat in pairs(seatData) do\r\n    curMat = getObjectFromGUID(someSeat.matGuid)\r\n\r\n    if curMat != nil then\r\n      curMat.interactable = shouldBeInteractable\r\n      -- These are made interactable but technically left locked so they do not fall off the bottom of the table.\r\n    end\r\n  end\r\n\r\n  -- Handle 2-player board prefabs.\r\n\r\n  if (blueBoardsPrefab != nil) then\r\n    blueBoardsPrefab.locked         = (not shouldBeInteractable)\r\n    blueBoardsPrefab.interactable   = shouldBeInteractable\r\n  end\r\n\r\n  if (redBoardsPrefab != nil) then\r\n    redBoardsPrefab.locked          = (not shouldBeInteractable)\r\n    redBoardsPrefab.interactable    = shouldBeInteractable\r\n  end\r\nend\r\n\r\nfunction initBoards()\r\n  -- Make certain objects uninteractable so that players do not alt-zoom or unlock them.\r\n  for i,someSeat in pairs(seatData) do\r\n    local someObject = getObjectFromGUID(someSeat.diceHolderGuid)\r\n    someObject.interactable = false\r\n\r\n    someObject = getObjectFromGUID(someSeat.rivalsDeckHolderGuid)\r\n    someObject.interactable = false\r\n\r\n    someObject = getObjectFromGUID(someSeat.passButtonHolderGuid)\r\n    someObject.interactable = false\r\n\r\n    someObject = getObjectFromGUID(someSeat.limboHolderGuid)\r\n    someObject.interactable = false\r\n\r\n    -- Leave mats interactable if players unlock them so that they can use custom images if desired.\r\n    someObject = getObjectFromGUID(someSeat.matGuid)\r\n    someObject.setLock(true)\r\n  end\r\n\r\n  -- Spawn boards under the table to avoid white flash(es) while they load.\r\n  winchesterBoard = setupObject.takeObject({position={0,-4,8}, rotation={0,0,0}, guid=winchesterBoardGuid, flip=false, smooth=false, callback='setupWinchesterPickCounter', callback_owner=self})\r\n  winchesterBoard.use_gravity = false\r\n  winchesterBoard.interactable = false\r\n  winchesterBoard.setLock(true)\r\n  winchesterBoard.setPosition({0,-2.4,0})\r\n  passLeftBoard = setupObject.takeObject({position={0,-4,8}, rotation={0,0,0}, guid=passLeftBoardGuid, flip=false, smooth=false})\r\n  passLeftBoard.use_gravity = false\r\n  passLeftBoard.interactable = false\r\n  passLeftBoard.setLock(true)\r\n  passLeftBoard.setPosition({0,-2.2,0})\r\n  passRightBoard = setupObject.takeObject({position={0,-4,8}, rotation={0,0,0}, guid=passRightBoardGuid, flip=false, smooth=false})\r\n  passRightBoard.use_gravity = false\r\n  passRightBoard.interactable = false\r\n  passRightBoard.setLock(true)\r\n  passRightBoard.setPosition({0,-2.1,0})\r\n\r\n  -- Create script zones for the Winchester draft stacks.  These are created under the table to avoid white flash(es).\r\n  local obj_parameters = {}\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = {11.09, 5.10, 33.29}\r\n  obj_parameters.position = {18.010,-4.000, -6.390}\r\n  obj_parameters.rotation = { 0.000, 0.000,  0.000}\r\n  winchesterDraftZones[1] = spawnObject(obj_parameters)\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = {11.09, 5.10, 33.29}\r\n  obj_parameters.position = { 5.900,-4.000, -6.390}\r\n  obj_parameters.rotation = { 0.000, 0.000,  0.000}\r\n  winchesterDraftZones[2] = spawnObject(obj_parameters)\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = {11.09, 5.10, 33.29}\r\n  obj_parameters.position = {-5.900,-4.000, -6.390}\r\n  obj_parameters.rotation = { 0.000, 0.000,  0.000}\r\n  winchesterDraftZones[3] = spawnObject(obj_parameters)\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = {11.09, 5.10, 33.29}\r\n  obj_parameters.position = {-18.010,-4.000, -6.390}\r\n  obj_parameters.rotation = {  0.000, 0.000,  0.000}\r\n  winchesterDraftZones[4] = spawnObject(obj_parameters)\r\n\r\n  -- Create a script zones for Winchester stock decks.  These are created under the table to avoid white flash(es).\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = {5, 5, 6}\r\n  obj_parameters.position = {28.25, -4, 6.60}\r\n  obj_parameters.rotation = {0, 0, 0}\r\n  winchesterStockZones[\"Blue\"] = spawnObject(obj_parameters)\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = {5, 5, 6}\r\n  obj_parameters.position = {(-28.25), -4, 6.60}\r\n  obj_parameters.rotation = {0, 0, 0}\r\n  winchesterStockZones[\"Green\"] = spawnObject(obj_parameters)\r\nend\r\n\r\nfunction getColorByIndex(colorIndex)\r\n  if colorIndex == 1 then\r\n    returnColor = \"Green\"\r\n  elseif colorIndex == 2 then\r\n    returnColor = \"Blue\"\r\n  elseif colorIndex == 3 then\r\n    returnColor = \"Purple\"\r\n  elseif colorIndex == 4 then\r\n    returnColor = \"Pink\"\r\n  elseif colorIndex == 5 then\r\n    returnColor = \"White\"\r\n  elseif colorIndex == 6 then\r\n    returnColor = \"Red\"\r\n  elseif colorIndex == 7 then\r\n    returnColor = \"Orange\"\r\n  elseif colorIndex == 8 then\r\n    returnColor = \"Yellow\"\r\n  else\r\n    printToAll(\"Invalid color index \" .. colorIndex, {1,0,0})\r\n  end\r\n\r\n  return returnColor\r\nend\r\n\r\nfunction onChat(message, chatPlayer)\r\n  if string.sub(message, 1, 5) == \"!help\" then\r\n    -- Note that the chat font is not necessarily fixed-width, so alignment is done manually.\r\n    printToColor(\"\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"Chat commands:\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"==================\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"!help                      Print this message\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"!unlockboards       Unlock boards in 2-player games\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"!lockboards           Lock boards in 2-player games\", chatPlayer.color, {1,1,1})\r\n    printToColor(\"\", chatPlayer.color, {1,1,1})\r\n    --printToColor(\"!mat                       Change draft mat (draft etc. only)\", chatPlayer.color, {1,1,1})\r\n    --printToColor(\"!randomseats        Randomize seats before starting draft etc.\", chatPlayer.color, {1,1,1})\r\n    --printToColor(\"\", chatPlayer.color, {1,1,1})\r\n  elseif message == \"!unlockboards\" then\r\n    areBoardsInteractable = true\r\n    setInteractableBoards(areBoardsInteractable)\r\n    printToAll(\"Boards unlocked.\", {0,0.8,0})\r\n  elseif message == \"!lockboards\" then\r\n    areBoardsInteractable = false\r\n    setInteractableBoards(areBoardsInteractable)\r\n    printToAll(\"Boards locked.\", {0,0.8,0})\r\n  --elseif string.sub(message, 1, 4) == \"!mat\" then\r\n  --  matIndexString = string.sub(message, 6)\r\n  --  if matImages[matIndexString] != nil then\r\n  --    -- Update seat image\r\n  --    local matObject = getObjectFromGUID(seatData[chatPlayer.color].matGuid)\r\n  --    if matObject != nil then\r\n  --      local customObject = matObject.getCustomObject()\r\n  --      customObject.image = matImages[matIndexString]\r\n  --      matObject.setCustomObject(customObject)\r\n  --      matObject.reload()\r\n  --\r\n  --      -- Wait before adjusting interactable flags.  Otherwise, it does not seem to work, presumably because of reload().\r\n  --      Wait.time(function() setInteractableBoards(areBoardsInteractable) end, 0.5)\r\n  --    end\r\n  --  else\r\n  --    if (normalGameStarted == false) then\r\n  --      printToColor(\"\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"Usage:\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"\", chatPlayer.color, {1,1,1})\r\n  --      -- Note that the chat font is not necessarily fixed-width, so alignment is done manually.\r\n  --      printToColor(\"!mat art       Artificery mat\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"!mat hyp      Hyperloops mat\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"!mat reb       I Rebel mat\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"!mat gld       Golden Dice mat\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"!mat kor       Knights of Ren mat\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"!mat DL1       Destiny League mat 1\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"!mat DL2       Destiny League mat 2\", chatPlayer.color, {1,1,1})\r\n  --      printToColor(\"\", chatPlayer.color, {1,1,1})\r\n  --    end\r\n  --  end\r\n  --elseif string.sub(message, 1, 12) == \"!randomseats\" then\r\n  --  local colorFound = false\r\n  --  local availableColors = {}\r\n  --  local randomColorIndex\r\n  --  local randomColor\r\n  --\r\n  --  -- Only allow the host to randomize seats.\r\n  --  if (chatPlayer.host == true) then\r\n  --    if ((normalGameStarted == false) and (draftGameStarted == false)) then\r\n  --      local allPlayers = Player.getPlayers()\r\n  --\r\n  --      if #allPlayers <= 8 then\r\n  --        for colorIndex=1,8 do\r\n  --          availableColors[colorIndex] = true\r\n  --        end\r\n  --\r\n  --        -- Move all players to spectator.\r\n  --        for i,somePlayer in pairs(allPlayers) do\r\n  --          somePlayer.changeColor(\"Grey\")\r\n  --        end\r\n  --\r\n  --        -- Assign all players random seats.\r\n  --        for i,somePlayer in pairs(allPlayers) do\r\n  --          colorFound = false\r\n  --\r\n  --          while colorFound == false do\r\n  --            randomColorIndex = math.random(1, 8)\r\n  --            if availableColors[randomColorIndex] == true then\r\n  --              availableColors[randomColorIndex] = false\r\n  --              colorFound = true\r\n  --\r\n  --              -- Switch the player to the given color.\r\n  --              randomColor = getColorByIndex(randomColorIndex)\r\n  --              printToAll(\"Changing \" .. somePlayer.steam_name .. \" to \" .. randomColor, stringColorToRGB(randomColor))\r\n  --              somePlayer.changeColor(getColorByIndex(randomColorIndex))\r\n  --            end\r\n  --          end\r\n  --        end\r\n  --\r\n  --        -- Reset seat data now that players have possibly changed places.\r\n  --        scanSeatedPlayers()\r\n  --      else\r\n  --        printToAll(\"8 players are the maximum supported for draft.\", {1,0,0})\r\n  --      end\r\n  --    else\r\n  --      printToAll(\"Seats cannot be randomized after a game has started.\", {1,0,0})\r\n  --    end\r\n  --  else\r\n  --    printToAll(\"Only the host can randomize seats.\", {1,0,0})\r\n  --  end\r\n  else\r\n    -- Nothing needs done.\r\n  end\r\nend\r\n\r\nfunction enableTableThumbnails(player)\r\n  UI.setAttribute(\"change_table_color_button\", \"active\", false)\r\n  UI.setAttribute(\"table_thumbnail_panel\", \"active\", true)\r\n  UI.setAttribute(\"table_mat_panel\", \"active\", true)\r\nend\r\n\r\n-- NOTE:  Buttons do not use the \"value\" parameter.\r\nfunction setTableDesign(player, value, id)\r\n  if (gameTableReference != nil) then\r\n    if (not tableDesignLoading) then\r\n      local imageURL = nil\r\n\r\n      -- Move the marker.\r\n      UI.setAttribute(\"table_design_marker\", \"offsetXY\", UI.getAttribute(id, \"offsetXY\"))\r\n\r\n      if id == \"table_black\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/922547277902504571/4C206C65460313386BFA3A08981FECD188A8DEB8/\"\r\n      elseif id == \"table_classic_blue\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/87094544885068211/999D58ABF92A84B0F9DEC49F26494FEA118B9617/\"\r\n      elseif id == \"table_felt_black\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191175993071/DD605FB1E7C2686C411DED76AAC862C76CEC732B/\"\r\n      elseif id == \"table_felt_dark_gray\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191175993758/5BAF51C16974164CC188E6437420A3168EEF1489/\"\r\n      elseif id == \"table_felt_gray\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191175664857/CBBE2E1CC5BF288811907068F2B5E2D1B87A51C0/\"\r\n      elseif id == \"table_felt_blue\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191176028154/B7FD413C09EC98B96C66FF9E79060CE0BE285028/\"\r\n      elseif id == \"table_felt_aqua\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191176028666/CD65C281ABE4F9F672414F5ED24876C205D2D0BC/\"\r\n      elseif id == \"table_felt_green\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191176071242/AD48C0979DBCB857DC0537ECFFC097B9AEA4BBF4/\"\r\n      elseif id == \"table_felt_red\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191176071726/320D8CAA90D9B4B2BE475792AA205568D3F42A3E/\"\r\n      elseif id == \"table_felt_purple\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/952959191176072302/5793FB14E4A4F3553E488052843C5B1524F3CA4F/\"\r\n      elseif id == \"table_felt_white\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/981107421962128802/DB5B554923DD3BDE8716DFC87CAB4757A91765FB/\"\r\n      elseif id == \"table_camo_green\" then\r\n        imageURL = \"http://cloud-3.steamusercontent.com/ugc/981107421962121474/344EB3E1A469A47632EC02FFC63DBABE553D10CE/\"\r\n      else\r\n        -- This should never happen.\r\n        printToAll(\"Error, unknown table design \\\"\" .. id .. \"\\\".\", {1,0,0})\r\n      end\r\n\r\n      if imageURL != nil then\r\n        tableDesignLoading = true\r\n\r\n        local obj_parameters = {}\r\n        obj_parameters.type = 'Custom_Tile'\r\n        obj_parameters.position = {0,-4,0}\r\n        obj_parameters.rotation = {0,0,0}\r\n        obj_parameters.scale = {1,1,1}\r\n        obj_parameters.sound = false\r\n        obj_parameters.callback_function = function(newObject) updateTempTableDesignObject(imageURL) end\r\n        tempTableDesignObject = spawnObject(obj_parameters)\r\n\r\n        -- Enable loading text.\r\n        UI.setAttribute(\"table_design_loading\", \"active\", true)\r\n      end\r\n    end\r\n  else\r\n    -- This should never happen.\r\n    printToAll(\"Error, no table reference available.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction updateTempTableDesignObject(imageURL)\r\n  tempTableDesignObject.setCustomObject({image=imageURL})\r\n  tempTableDesignObject = tempTableDesignObject.reload()\r\n\r\n  local checkForImageLoadingFinished = function() return (not tempTableDesignObject.loading_custom) end\r\n\r\n  -- Wait for table image to finish loading.\r\n  Wait.condition(function() finishSetTableDesign(imageURL) end, checkForImageLoadingFinished, 10, tableLoadingTimeout)\r\nend\r\n\r\nfunction tableLoadingTimeout()\r\n  printToAll(\"Table design failed to load.\", {1,0,0})\r\n  tableDesignLoading = false\r\n\r\n  -- Disable loading text after a short delay to prevent a super quick flash.\r\n  Wait.time(function() UI.setAttribute(\"table_design_loading\", \"active\", false) end, 0.5)\r\nend\r\n\r\n-- Now that the texture has loaded, set the table design so that it changes very quickly.\r\nfunction finishSetTableDesign(imageURL)\r\n  gameTableReference.setCustomObject({image=imageURL})\r\n  gameTableReference = gameTableReference.reload()\r\n\r\n  -- After a short delay, clean up.  Unfortunately the table object always seems to return loading_custom == true so there is no way to check if the load finished.\r\n  Wait.time(handleTableFinishedUpdating, 0.5)\r\nend\r\n\r\nfunction handleTableFinishedUpdating()\r\n  tempTableDesignObject.destruct()\r\n  tempTableDesignObject = nil\r\n\r\n  tableDesignLoading = false\r\n\r\n  -- Disable loading text after a short delay to prevent a super quick flash.\r\n  Wait.time(function() UI.setAttribute(\"table_design_loading\", \"active\", false) end, 0.5)\r\nend\r\n\r\n-- NOTE:  Buttons do not use the \"value\" parameter.\r\nfunction setBoardStyle(player, value, id)\r\n  -- Move the marker.\r\n  UI.setAttribute(\"board_style_marker\", \"offsetXY\", UI.getAttribute(id, \"offsetXY\"))\r\n\r\n  -- Update the board style.\r\n  boardStyle = id\r\nend\r\n\r\n-- REMOVE RESOURCE\r\n--function guiResource(player)\r\n--  if player.color == \"Blue\" then\r\n--    blueBoardsPrefab.call('spawnResource')\r\n--  else\r\n--    redBoardsPrefab.call('spawnResource')\r\n--  end\r\n--end\r\n\r\n-- REMOVE PASS\r\n--function guiPass(player)\r\n--  if player.color == \"Blue\" then\r\n--    blueBoardsPrefab.call('passButton')\r\n--  else\r\n--    redBoardsPrefab.call('passButton')\r\n--  end\r\n--end\r\n\r\nfunction guiShuffle(player)\r\n  if player.color == \"Blue\" then\r\n    blueBoardsPrefab.call('shuffleHand')\r\n  else\r\n    redBoardsPrefab.call('shuffleHand')\r\n  end\r\nend\r\n\r\nfunction guiDiscard(player)\r\n  if player.color == \"Blue\" then\r\n    if (blueHandCount > 0) then\r\n      blueBoardsPrefab.call('randomDiscard')\r\n      blueHandCount = (blueHandCount - 1)\r\n    else\r\n      printToAll(player.color .. \"'s hand is empty.\", stringColorToRGB(player.color))\r\n    end\r\n  else\r\n    if (redHandCount > 0) then\r\n      redBoardsPrefab.call('randomDiscard')\r\n      redHandCount = (redHandCount - 1)\r\n    else\r\n      printToAll(player.color .. \"'s hand is empty.\", stringColorToRGB(player.color))\r\n    end\r\n  end\r\nend\r\n\r\nfunction guiToggle(player)\r\n  if normalGameStarted == true then\r\n    if player.color == \"Blue\" then\r\n      bluePanelMaximized = (not bluePanelMaximized)\r\n    else\r\n      redPanelMaximized = (not redPanelMaximized)\r\n    end\r\n\r\n    updatePanelVisibility()\r\n  end\r\nend\r\n\r\n-- These functions make sure the middle and right mouse buttons were not clicked.\r\n\r\nfunction blueClaimBattlefield(buttonObject, playerColor, altClick)\r\n  if ((playerColor == \"Blue\") and (altClick == false)) then\r\n    claimBattlefield(buttonObject, playerColor, altClick)\r\n  end\r\nend\r\n\r\nfunction redClaimBattlefield(buttonObject, playerColor, altClick)\r\n  if ((playerColor == \"Red\") and (altClick == false)) then\r\n    claimBattlefield(buttonObject, playerColor, altClick)\r\n  end\r\nend\r\n\r\nfunction claimBattlefield(buttonObject, playerColor, altClick)\r\n  local zoneObjects = nil\r\n  local blueBattlefieldCard = nil\r\n  local redBattlefieldCard = nil\r\n  local atLeastOneBattlefieldFound = false\r\n\r\n  if normalGameStarted == true then\r\n    zoneObjects = blueBattlefieldZone.getObjects()\r\n    for objectIndex,curObject in ipairs(zoneObjects) do\r\n      if curObject.tag == \"Card\" then\r\n        blueBattlefieldCard = curObject\r\n        atLeastOneBattlefieldFound = true\r\n        break\r\n      end\r\n    end\r\n\r\n    zoneObjects = redBattlefieldZone.getObjects()\r\n    for objectIndex,curObject in ipairs(zoneObjects) do\r\n      if curObject.tag == \"Card\" then\r\n        redBattlefieldCard = curObject\r\n        atLeastOneBattlefieldFound = true\r\n        break\r\n      end\r\n    end\r\n\r\n    if playerColor == \"Blue\" then\r\n      if blueBattlefieldCard != nil then\r\n        animateBattlefieldInPlace(blueBattlefieldCard)\r\n      elseif redBattlefieldCard != nil then\r\n        animateBattlefieldMove(redBattlefieldCard, redBattlefieldCard.getRotation(), blueBattlefieldZone, 25)\r\n      else\r\n        printToAll(\"Error, no battlefield found.\", {1,0,0})\r\n      end\r\n\r\n      if atLeastOneBattlefieldFound == true then\r\n        -- Hide the button while the animation plays.\r\n        blueBoardsPrefab.UI.setAttribute(\"claim_button\", \"position\", \"-255 690 40\")\r\n        Wait.time(function() blueBoardsPrefab.UI.setAttribute(\"claim_button\", \"position\", \"-255 690 -10\") end, 1.0)\r\n\r\n        -- Announce to all players.\r\n        broadcastToAll('Claim', {0.1,0.5,1.0})\r\n      end\r\n    else\r\n      if redBattlefieldCard != nil then\r\n        animateBattlefieldInPlace(redBattlefieldCard)\r\n      elseif blueBattlefieldCard != nil then\r\n        animateBattlefieldMove(blueBattlefieldCard, blueBattlefieldCard.getRotation(), redBattlefieldZone, 25)\r\n      else\r\n        printToAll(\"Error, no battlefield found.\", {1,0,0})\r\n      end\r\n\r\n      if atLeastOneBattlefieldFound == true then\r\n        -- Hide the button while the animation plays.\r\n        redBoardsPrefab.UI.setAttribute(\"claim_button\", \"position\", \"-255 690 40\")\r\n        Wait.time(function() redBoardsPrefab.UI.setAttribute(\"claim_button\", \"position\", \"-255 690 -10\") end, 1.0)\r\n\r\n        -- Announce to all players.\r\n        broadcastToAll('Claim', {0.8,0.1,0.1})\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction animateBattlefieldInPlace(battlefieldCard)\r\n  animateBattlefieldInPlaceFull(battlefieldCard, battlefieldCard.getPosition(), battlefieldCard.getRotation(), 25)\r\nend\r\n\r\nfunction animateBattlefieldInPlaceFull(battlefieldCard, startPosition, startRotation, percentage)\r\n  local newPosition = {x = startPosition.x, y = startPosition.y, z = startPosition.z}\r\n  local newRotation = {x = startRotation.x, y = startRotation.y, z = startRotation.z}\r\n\r\n  if (percentage == 25) then\r\n    newPosition.y = (newPosition.y + 2)\r\n    newRotation.y = (newRotation.y + 90)\r\n  elseif (percentage == 50) then\r\n    newPosition.y = (newPosition.y + 4)\r\n    newRotation.y = (newRotation.y + 180)\r\n  elseif (percentage == 75) then\r\n    newPosition.y = (newPosition.y + 2)\r\n    newRotation.y = (newRotation.y + 270)\r\n  elseif (percentage == 100) then\r\n    -- Nothing needs done, since the final position and rotation match the start.\r\n  end\r\n\r\n  battlefieldCard.setPositionSmooth(newPosition, false, false)\r\n  battlefieldCard.setRotationSmooth(newRotation, false, false)\r\n  percentage = (percentage + 25)\r\n\r\n  if (percentage <= 100) then\r\n    Wait.time(function() animateBattlefieldInPlaceFull(battlefieldCard, startPosition, startRotation, percentage) end, 0.24)\r\n  end\r\nend\r\n\r\nfunction animateBattlefieldMove(battlefieldCard, startRotation, endBattlefieldZone, percentage)\r\n  local zonePosition = endBattlefieldZone.getPosition()\r\n  local newPosition = {x = zonePosition.x, y = zonePosition.y, z = zonePosition.z}\r\n  local newRotation = {x = startRotation.x, y = startRotation.y, z = startRotation.z}\r\n\r\n  -- Use a number rather than the zone position because the zone position is midair.\r\n  if (percentage == 25) then\r\n    newPosition.y = (1.18 + 2)\r\n    newRotation.y = (newRotation.y + 90)\r\n    battlefieldCard.setRotationSmooth(newRotation, false, false)\r\n  elseif (percentage == 50) then\r\n    newPosition.y = (1.18 + 4)\r\n    newRotation.y = (newRotation.y + 180)\r\n    battlefieldCard.setRotationSmooth(newRotation, false, false)\r\n  elseif (percentage == 75) then\r\n    newPosition.y = (1.18 + 2)\r\n  elseif (percentage == 100) then\r\n    newPosition.y = 1.18\r\n  end\r\n\r\n  battlefieldCard.setPositionSmooth(newPosition, false, false)\r\n  percentage = (percentage + 25)\r\n\r\n  if (percentage <= 100) then\r\n    Wait.time(function() animateBattlefieldMove(battlefieldCard, startRotation, endBattlefieldZone, percentage) end, 0.25)\r\n  end\r\nend\r\n\r\nfunction handleNormalGameStarted()\r\n  normalGameStarted = true\r\n  if modernInterfaceActive == true then\r\n    UI.setAttribute(\"blue_panel\", \"active\", true)\r\n    UI.setAttribute(\"red_panel\", \"active\", true)\r\n  end\r\nend\r\n\r\nfunction setupWinchesterPickCounter()\r\n  local obj_parameters = {}\r\n\r\n  -- NOTE:  According to people on the internet, assigning rotation here apparently does not work for 3DText.\r\n  -- NOTE:  Unfortunately, using a callback when spawning 3DText does not seem to work at all anymore, so a delay is used instead.\r\n  obj_parameters.type = \"3DText\"\r\n  obj_parameters.position = {0,-4,0}\r\n  winchesterPickCountText = spawnObject(obj_parameters)\r\n\r\n  Wait.time(setupWinchesterText, 0.5)\r\nend\r\n\r\nfunction setupWinchesterText()\r\n  winchesterPickCountText.TextTool.setValue(\" \")\r\n  winchesterPickCountText.setRotation({90,180,0})\r\n  winchesterPickCountText.setScale({2,2,2})\r\n  winchesterPickCountText.interactable = false\r\nend\r\n\r\nfunction passButtonClickedGeneral(buttonColor, playerColor)\r\n  if playerColor == buttonColor then\r\n    -- Attempt to avoid synchronization problems where one player is stuck.\r\n    startLuaCoroutine(self, (\"passButtonClickedCoroutine\" .. playerColor))\r\n  else\r\n    printToAll(playerColor .. \" clicked the wrong Pass button.\", stringColorToRGB(playerColor))\r\n  end\r\nend\r\n\r\nfunction passButtonClickedCoroutine(playerColor)\r\n  -- Source deck to move.\r\n  local sourceDeck = nil\r\n  -- Default to the current player.\r\n  local destinationPlayerColor = playerColor\r\n\r\n  -- Make sure this is actually passing and not a player clicking a Done button.\r\n  if seatData[playerColor].passTurnsFinished < 14 then\r\n    -- First, determine the pass destination player color.\r\n    if (passRound == 1) then\r\n      destinationPlayerColor = getSeatedPlayerLeft(playerColor)\r\n    else\r\n      destinationPlayerColor = getSeatedPlayerRight(playerColor)\r\n    end\r\n\r\n    -- Next, check if the source stack has cards.\r\n    sourceDeck = seatData[playerColor].drawDeck\r\n\r\n    -- Check the source stack card count.\r\n    local sourceDeckCount = 0\r\n    if sourceDeck != nil then\r\n      if sourceDeck.tag == \"Deck\" then\r\n        sourceDeckCount = #(sourceDeck.getObjects())\r\n      else\r\n        -- Assume a single card was found.\r\n        sourceDeckCount = 1\r\n      end\r\n    else\r\n      -- This case should only happen if a single card is left in the script zone, since the deck object is no longer valid.\r\n      -- It may also happen if a player messes up the deck by dragging a card on / off by accident, or because they changed\r\n      -- their mind.\r\n      local scriptZoneObjects = getObjectFromGUID(seatData[playerColor].scriptZoneGuid).getObjects()\r\n      for deckIndex,curDeck in ipairs(scriptZoneObjects) do\r\n        sourceDeck = curDeck\r\n        seatData[playerColor].drawDeck = sourceDeck\r\n\r\n        if curDeck.tag == \"Deck\" then\r\n          sourceDeckCount = #(sourceDeck.getObjects())\r\n        else\r\n          -- Assume a single card was found.\r\n          sourceDeckCount = 1\r\n        end\r\n\r\n        break\r\n      end\r\n    end\r\n\r\n    -- Check conditions and print a message if needed.  Otherwise, perform the pass.\r\n    if (sourceDeck == nil) then\r\n      broadcastToColor(\"You have no cards to pass.\", playerColor, stringColorToRGB(playerColor))\r\n    elseif (seatData[destinationPlayerColor].limboHasCards == true) then\r\n      broadcastToColor(\"The next player is not ready for cards.\", playerColor, stringColorToRGB(playerColor))\r\n    elseif (sourceDeckCount != (14 - seatData[playerColor].passTurnsFinished)) then\r\n      broadcastToColor(\"You must pass \" .. (14 - seatData[playerColor].passTurnsFinished) .. \" cards.\", playerColor, stringColorToRGB(playerColor))\r\n    elseif (seatData[playerColor].passTurnsFinished == 14) then\r\n      printToAll(playerColor .. \" tried to pass an extra time.\", stringColorToRGB(playerColor))\r\n    else\r\n      local destinationPosition = getObjectFromGUID(seatData[destinationPlayerColor].limboHolderGuid).getPosition()\r\n      local destinationRotation = getObjectFromGUID(seatData[destinationPlayerColor].limboHolderGuid).getRotation()\r\n\r\n      -- The pass was successful, so delete the Pass button for the passing player.\r\n      local passButtonHolder = getObjectFromGUID(seatData[playerColor].passButtonHolderGuid)\r\n      passButtonHolder.clearButtons()\r\n      seatData[playerColor].hasButton = false\r\n      seatData[playerColor].shouldHaveButton = false\r\n\r\n      -- Adjust the limbo position slightly in an attempt to avoid limbo deck(s) rarely falling from the bottom of the table.\r\n      destinationPosition.y = destinationPosition.y - 0.2\r\n\r\n      -- The deck will be uninteractable with no gravity while in limbo, and it will be locked so it does not float around.\r\n      sourceDeck.interactable = false\r\n      sourceDeck.use_gravity = false\r\n      sourceDeck.setLock(true)\r\n\r\n      -- Move the deck.\r\n      sourceDeck.setPosition(destinationPosition)\r\n      sourceDeck.setRotation({ destinationRotation.x + 180, destinationRotation.y, destinationRotation.z })\r\n\r\n      -- Link the deck as the limbo deck for the destination player.\r\n      seatData[destinationPlayerColor].limboDeck = sourceDeck\r\n      seatData[destinationPlayerColor].limboHasCards = true\r\n\r\n      -- Update the pass count for the passing player.\r\n      if (seatData[playerColor].passTurnsFinished < 14) then\r\n        seatData[playerColor].passTurnsFinished = seatData[playerColor].passTurnsFinished+1\r\n      end\r\n\r\n      -- Clear the draw deck variable for the passing player, and mark their draft stack as empty.\r\n      seatData[playerColor].drawDeck = nil\r\n      seatData[playerColor].draftStackHasCards = false\r\n    end\r\n  elseif seatData[playerColor].passTurnsFinished == 14 then\r\n    -- Make sure the player took their last card.\r\n    if seatData[playerColor].drawDeck != nil then\r\n      broadcastToColor(\"You must take your last card.\", playerColor, stringColorToRGB(playerColor))\r\n    else\r\n      -- Delete the button.\r\n      local passButtonHolder = getObjectFromGUID(seatData[playerColor].passButtonHolderGuid)\r\n      passButtonHolder.clearButtons()\r\n      seatData[playerColor].hasButton = false\r\n      seatData[playerColor].shouldHaveButton = false\r\n\r\n      -- Record a final pass turn.  This lets scanForDraftRoundFinish() detect when all players are ready.\r\n      seatData[playerColor].passTurnsFinished = seatData[playerColor].passTurnsFinished+1\r\n      -- Scan for whether everyone has finished the draft round.\r\n      scanForDraftRoundFinish()\r\n    end\r\n  else\r\n    -- This should never happen.\r\n    printToAll(\"Error, it should be impossible to pass after clicking the Done button.\", {1,0,0})\r\n  end\r\n\r\n  return 1\r\nend\r\n\r\nfunction periodicLimboCheck()\r\n  -- Use a coroutine to avoid synchronization problems.\r\n  startLuaCoroutine(self, \"periodicLimboCheckCoroutine\")\r\nend\r\n\r\nfunction periodicLimboCheckCoroutine()\r\n  if limboCheckEnabled == true then\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      if ((seatData[somePlayer].limboHasCards == true) and (seatData[somePlayer].draftStackHasCards == false)) then\r\n        local limboDeck = seatData[somePlayer].limboDeck\r\n        local destinationPosition = getObjectFromGUID(seatData[somePlayer].scriptZoneGuid).getPosition()\r\n        local destinationRotation = getObjectFromGUID(seatData[somePlayer].scriptZoneGuid).getRotation()\r\n\r\n        -- The deck will be placed above the table.\r\n        destinationPosition.y = 1\r\n\r\n        -- Move the deck from limbo to the script zone.\r\n        seatData[somePlayer].limboDeck = nil\r\n        limboDeck.setPosition(destinationPosition)\r\n        limboDeck.setRotation({ destinationRotation.x + 180, destinationRotation.y, destinationRotation.z })\r\n        seatData[somePlayer].drawDeck = limboDeck\r\n\r\n        -- The deck can now be interacted with, gravity is enabled, and it is unlocked.\r\n        limboDeck.interactable = true\r\n        limboDeck.use_gravity = true\r\n        limboDeck.setLock(false)\r\n\r\n        -- Update the draft stack and limbo state variables.\r\n        seatData[somePlayer].draftStackHasCards = true\r\n        seatData[somePlayer].limboHasCards = false\r\n\r\n        -- Mark that the destination player should have a pass button.\r\n        seatData[somePlayer].shouldHaveButton = true\r\n\r\n        -- After a delay, create the Pass button for the destination player.\r\n        Wait.time(function() createPassButton(somePlayer) end, 1.0)\r\n      end\r\n    end\r\n\r\n    -- Set up the next periodic wait.\r\n    periodicLimboCheckWaitID = Wait.time(periodicLimboCheck, 1.0)\r\n  end\r\n\r\n  return 1\r\nend\r\n\r\nfunction createPassButton(playerColor)\r\n  local passButtonHolder = getObjectFromGUID(seatData[playerColor].passButtonHolderGuid)\r\n\r\n  if (seatData[playerColor].shouldHaveButton == true) then\r\n    if (seatData[playerColor].hasButton == false) then\r\n      if (seatData[playerColor].passTurnsFinished < 14) then\r\n        passButtonHolder.createButton({\r\n          label='Pass', click_function = (\"passButtonClicked\" .. playerColor), function_owner=Global,\r\n          position={0,1,0}, rotation={0,-90,0}, width=870, height=750, font_size=400,\r\n          color=stringColorToRGB(playerColor)\r\n        })\r\n      else\r\n        passButtonHolder.createButton({\r\n          label='Done', click_function = (\"passButtonClicked\" .. playerColor), function_owner=Global,\r\n          position={0,1,0}, rotation={0,-90,0}, width=870, height=750, font_size=400,\r\n          color=stringColorToRGB(playerColor)\r\n        })\r\n      end\r\n\r\n      seatData[playerColor].hasButton = true\r\n    else\r\n      printToAll(\"Error, createPassButton() called but a button already exists.\", {1,0,0})\r\n    end\r\n  else\r\n    printToAll(\"Error, createPassButton() called but a button should NOT be created.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction endRoundOneCoroutine()\r\n  -- Disable the limbo check.  This must be done inside a coroutine to make sure the limbo check is not currently running.\r\n  limboCheckEnabled = false\r\n\r\n  -- Reset pass counts.\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    seatData[somePlayer].passTurnsFinished = 0\r\n  end\r\n\r\n  passRound = 2\r\n  draftReadyForDeal()\r\n\r\n  return 1\r\nend\r\n\r\nfunction endRoundTwoCoroutine()\r\n  -- Stop the periodic limbo check.  This must be done inside a coroutine to make sure the limbo check is not currently running.\r\n  limboCheckEnabled = false\r\n  if periodicLimboCheckWaitID != nil then\r\n    stop(periodicLimboCheckWaitID)\r\n    periodicLimboCheckWaitID = nil\r\n  end\r\n\r\n  -- Indicate drafting is over.\r\n  passRound = 0\r\n\r\n  -- Mark everyone as not needing a Pass button, and Delete all Pass buttons.\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    seatData[somePlayer].hasButton = false\r\n    seatData[somePlayer].shouldHaveButton = false\r\n\r\n    local buttonHolder = getObjectFromGUID(seatData[somePlayer].passButtonHolderGuid)\r\n    buttonHolder.clearButtons()\r\n  end\r\n\r\n  -- Destruct the sign.\r\n  passRightBoard.destruct()\r\n\r\n  -- Cleanup the table.\r\n  cleanupTable()\r\n\r\n  printToAll(\"DRAFT COMPLETE.\", {0,0.8,0})\r\n  printToAll(\"===========================================\", {1,1,1})\r\n  printToAll(\"REMEMBER TO RIGHT CLICK AND SAVE YOUR DECK\", {1,1,1})\r\n  printToAll(\"===========================================\", {1,1,1})\r\n\r\n  -- Set up the deckbuilding zones.\r\n  setupHiddenZones()\r\n\r\n  return 1\r\nend\r\n\r\nfunction scanForDraftRoundFinish()\r\n  local roundFinished = true\r\n\r\n  if passRound == 1 then\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      if seatData[somePlayer].passTurnsFinished != 15 then\r\n        roundFinished = false\r\n        break\r\n      end\r\n    end\r\n\r\n    if roundFinished == true then\r\n      startLuaCoroutine(self, \"endRoundOneCoroutine\")\r\n    end\r\n  elseif passRound == 2 then\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      if seatData[somePlayer].passTurnsFinished != 15 then\r\n        roundFinished = false\r\n        break\r\n      end\r\n    end\r\n\r\n    if roundFinished == true then\r\n      startLuaCoroutine(self, \"endRoundTwoCoroutine\")\r\n    end\r\n  else\r\n    -- This should never happen.\r\n    printToAll(\"Error, it should be impossible to pass once draft rounds are over.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction spawnDraftDice()\r\n  printToAll(\"Spawning dice...\", {1,1,1})\r\n\r\n  for playerIndex,curPlayer in pairs(seatedPlayers) do\r\n    local draftDeckZoneObjects = getObjectFromGUID(seatData[curPlayer].scriptZoneGuid).getObjects()\r\n    local diceHolder = getObjectFromGUID(seatData[curPlayer].diceHolderGuid)\r\n    local diceVector = seatData[curPlayer].diceDirectionVector\r\n    local diceRowVector = seatData[curPlayer].diceRowDirectionVector\r\n    local horizontalOffset = (-3)\r\n    local verticalOffset = 2\r\n\r\n    local dieOffset = seatData[curPlayer].dieOffset+horizontalOffset\r\n    local dieRowOffset = seatData[curPlayer].dieRowOffset\r\n\r\n    for deckIndex,curDeck in ipairs(draftDeckZoneObjects) do\r\n      if curDeck.tag == \"Deck\" then\r\n        -- Record the initial deck for this player.\r\n        seatData[curPlayer].drawDeck = curDeck\r\n\r\n        local cardsToScan = dealtCards[curPlayer]\r\n        for cardIndex,curCard in ipairs(cardsToScan) do\r\n          local cardFound = false\r\n          for i in ipairs(cardstable) do\r\n            if cubeCompatibilityMode == true then\r\n              if (cardstable[i][\"cardname\"]) == curCard then\r\n                cardFound = true\r\n              end\r\n            else\r\n              if (cardstable[i][\"set\"] .. ' ' .. cardstable[i][\"number\"]) == curCard then\r\n                cardFound = true\r\n              end\r\n            end\r\n\r\n            if cardFound == true then\r\n              if cardstable[i][\"diceimage\"] != nil then\r\n                local custom = {}\r\n                local obj_parameters = {}\r\n                obj_parameters.type = 'Custom_Dice'\r\n                obj_parameters.scale = {1.7,1.7,1.7}\r\n                obj_parameters.position = {diceHolder.getPosition()[1]+(diceVector[1]*dieOffset)+(diceRowVector[1]*dieRowOffset),\r\n                                           diceHolder.getPosition()[2]+verticalOffset,\r\n                                           diceHolder.getPosition()[3]+(diceVector[3]*dieOffset)+(diceRowVector[3]*dieRowOffset)}\r\n                obj_parameters.rotation = {diceHolder.getRotation()[1], diceHolder.getRotation()[2]+180, diceHolder.getRotation()[3]}\r\n\r\n                dieOffset = dieOffset+2\r\n\r\n                -- Add a row offset if there are a lot of dice.\r\n                if (dieOffset == (horizontalOffset + 14)) then\r\n                  dieOffset = horizontalOffset\r\n                  dieRowOffset = dieRowOffset+2\r\n                end\r\n\r\n                local dice = spawnObject(obj_parameters)\r\n                custom.image = cardstable[i][\"diceimage\"]\r\n                dice.setCustomObject(custom)\r\n              end\r\n\r\n              break\r\n            end\r\n          end\r\n        end\r\n\r\n        break\r\n      else\r\n        -- This should never happen.\r\n        printToAll(\"Error, only one card found.\", {1,0,0})\r\n      end\r\n    end\r\n\r\n    seatData[curPlayer].dieOffset = dieOffset-horizontalOffset\r\n    seatData[curPlayer].dieRowOffset = dieRowOffset\r\n  end\r\n\r\n  -- If this was for the first round, some state needs updated.\r\n  if passRound == 1 then\r\n    printToAll(\"Packs generated.\", {1,1,1})\r\n\r\n    printToAll(\"SETUP COMPLETE.\", {0,0.8,0})\r\n\r\n    showPassLeft()\r\n    scanSeatedPlayers()\r\n  else\r\n    printToAll(\"ROUND 2 START.\", {0,0.8,0})\r\n\r\n    showPassRight()\r\n    scanSeatedPlayers()\r\n  end\r\nend\r\n\r\nfunction periodicHandCheck()\r\n  if normalGameStarted == true then\r\n    -- Use a coroutine to avoid synchronization problems.\r\n    startLuaCoroutine(self, \"periodicHandCheckCoroutine\")\r\n  end\r\n\r\n  Wait.time(periodicHandCheck, 0.5)\r\nend\r\n\r\nfunction periodicHandCheckCoroutine()\r\n  local zoneObjects = nil\r\n  local foundResourceCount = 0\r\n\r\n  if ((normalGameStarted == true) and (modernInterfaceActive == true)) then\r\n    -- Scan for cards.\r\n\r\n    if Player[\"blue\"] != nil then\r\n      blueHandCount = #(Player[\"blue\"].getHandObjects())\r\n    end\r\n\r\n    if Player[\"red\"] != nil then\r\n      redHandCount = #(Player[\"red\"].getHandObjects())\r\n    end\r\n\r\n    -- REMOVE RESOURCES\r\n    -- Scan for resources.\r\n\r\n    --if blueResourceZone != nil then\r\n    --  zoneObjects = blueResourceZone.getObjects()\r\n    --  foundResourceCount = 0\r\n    --\r\n    --  for objectIndex,curObject in ipairs(zoneObjects) do\r\n    --    if curObject.getName() == \"1 resource\" then\r\n    --      foundResourceCount = (foundResourceCount + 1)\r\n    --    end\r\n    --  end\r\n    --\r\n    --  blueResourceCount = foundResourceCount\r\n    --end\r\n    --\r\n    --if redResourceZone != nil then\r\n    --  zoneObjects = redResourceZone.getObjects()\r\n    --  foundResourceCount = 0\r\n    --\r\n    --  for objectIndex,curObject in ipairs(zoneObjects) do\r\n    --    if curObject.getName() == \"1 resource\" then\r\n    --      foundResourceCount = (foundResourceCount + 1)\r\n    --    end\r\n    --  end\r\n    --\r\n    --  redResourceCount = foundResourceCount\r\n    --end\r\n\r\n    -- Update UI elements.\r\n\r\n    UI.setAttribute(\"blue_panel_blue_cards\", \"text\", blueHandCount)\r\n    --UI.setAttribute(\"blue_panel_blue_resources\", \"text\", blueResourceCount)\r\n    UI.setAttribute(\"blue_panel_red_cards\", \"text\", redHandCount)\r\n    --UI.setAttribute(\"blue_panel_red_resources\", \"text\", redResourceCount)\r\n\r\n    UI.setAttribute(\"red_panel_blue_cards\", \"text\", blueHandCount)\r\n    --UI.setAttribute(\"red_panel_blue_resources\", \"text\", blueResourceCount)\r\n    UI.setAttribute(\"red_panel_red_cards\", \"text\", redHandCount)\r\n    --UI.setAttribute(\"red_panel_red_resources\", \"text\", redResourceCount)\r\n\r\n    if blueBoardsPrefab != nil then\r\n      blueBoardsPrefab.UI.setAttribute(\"blue_panel_blue_cards\", \"text\", blueHandCount)\r\n      --blueBoardsPrefab.UI.setAttribute(\"blue_panel_blue_resources\", \"text\", blueResourceCount)\r\n      blueBoardsPrefab.UI.setAttribute(\"blue_panel_red_cards\", \"text\", redHandCount)\r\n      --blueBoardsPrefab.UI.setAttribute(\"blue_panel_red_resources\", \"text\", redResourceCount)\r\n    end\r\n\r\n    if redBoardsPrefab != nil then\r\n      redBoardsPrefab.UI.setAttribute(\"red_panel_blue_cards\", \"text\", blueHandCount)\r\n      --redBoardsPrefab.UI.setAttribute(\"red_panel_blue_resources\", \"text\", blueResourceCount)\r\n      redBoardsPrefab.UI.setAttribute(\"red_panel_red_cards\", \"text\", redHandCount)\r\n      --redBoardsPrefab.UI.setAttribute(\"red_panel_red_resources\", \"text\", redResourceCount)\r\n    end\r\n\r\n  end\r\n\r\n  return 1\r\nend\r\n\r\nfunction updatePanelVisibility()\r\n  Global.UI.setAttribute(\"main_menu_panel\", \"active\", mainMenuPanelOpen)\r\n\r\n  if modernInterfaceActive == true then\r\n    if normalGameStarted == false then\r\n       UI.setAttribute(\"blue_panel\", \"active\", false)\r\n       UI.setAttribute(\"red_panel\", \"active\", false)\r\n\r\n       if blueBoardsPrefab != nil then\r\n         blueBoardsPrefab.UI.setAttribute(\"blue_panel\", \"active\", false)\r\n       end\r\n\r\n       if redBoardsPrefab != nil then\r\n         redBoardsPrefab.UI.setAttribute(\"red_panel\", \"active\", false)\r\n       end\r\n    else\r\n       UI.setAttribute(\"blue_panel\", \"active\", bluePanelMaximized)\r\n       UI.setAttribute(\"red_panel\", \"active\", redPanelMaximized)\r\n\r\n       if blueBoardsPrefab != nil then\r\n         blueBoardsPrefab.UI.setAttribute(\"blue_panel\", \"active\", (not bluePanelMaximized))\r\n       end\r\n\r\n       if redBoardsPrefab != nil then\r\n         redBoardsPrefab.UI.setAttribute(\"red_panel\", \"active\", (not redPanelMaximized))\r\n       end\r\n    end\r\n  else\r\n    UI.setAttribute(\"blue_panel\", \"active\", false)\r\n    UI.setAttribute(\"red_panel\", \"active\", false)\r\n  end\r\nend\r\n\r\nfunction updateBagColors()\r\n  local trashBag = nil\r\n\r\n  trashBag = getObjectFromGUID(trashBagAGuid)\r\n  if trashBag != nil then\r\n    trashBag.setColorTint({1,1,1})\r\n  end\r\n\r\n  trashBag = getObjectFromGUID(trashBagBGuid)\r\n  if trashBag != nil then\r\n    trashBag.setColorTint({1,1,1})\r\n  end\r\nend\r\n\r\nfunction onPlayerConnect(player)\r\n  updatePanelVisibility()\r\n  updateBagColors()\r\nend\r\n\r\nfunction onPlayerChangedColor(player)\r\n  updatePanelVisibility()\r\n  updateBagColors()\r\nend\r\n\r\n--function onScriptingButtonUp(index, playerColor)\r\n--  if index == 5 then\r\n--    for playerIndex,curPlayer in pairs(seatedPlayers) do\r\n--      local scriptZoneObjects = getObjectFromGUID(seatData[curPlayer].scriptZoneGuid).getObjects()\r\n--      for deckIndex,curDeck in ipairs(scriptZoneObjects) do\r\n--        if curDeck.tag == \"Deck\" then\r\n--          local curDeckObjects = curDeck.getObjects()\r\n--          local numDeckObjects = #curDeckObjects\r\n--          local numDealtCards = #(dealtCards[curPlayer])\r\n--          local numMatches = 0\r\n--          local actualDeckIndex = numDealtCards\r\n--\r\n--          -- Check the player deck backwards because the first cards end up on the bottom.\r\n--          for cardIndex=1,numDealtCards do\r\n--            if cubeCompatibilityMode == true then\r\n--              if curDeckObjects[actualDeckIndex].nickname == dealtCards[curPlayer][cardIndex] then\r\n--                numMatches = numMatches + 1\r\n--              end\r\n--            else\r\n--              if curDeckObjects[actualDeckIndex].description == dealtCards[curPlayer][cardIndex] then\r\n--                numMatches = numMatches + 1\r\n--              end\r\n--            end\r\n--\r\n--            actualDeckIndex = actualDeckIndex - 1\r\n--          end\r\n--\r\n--          if numMatches == numDealtCards then\r\n--            printToAll(curPlayer .. \" player:  All \" .. numMatches .. \" cards matched.\", {0,0.8,0})\r\n--          else\r\n--            printToAll(curPlayer .. \" player:  Only \" .. numMatches .. \" cards matched.\", {1,0,0})\r\n--          end\r\n--\r\n--          break\r\n--        end\r\n--      end\r\n--    end\r\n--  elseif index == 7 then\r\n--    if diceSpawnDebug == false then\r\n--      diceSpawnDebug = true\r\n--      printToAll(\"Dice spawn debugging turned on.\", {1,1,1})\r\n--    else\r\n--      diceSpawnDebug = false\r\n--      printToAll(\"Dice spawn debugging turned off.\", {1,1,1})\r\n--    end\r\n--  end\r\n--end\r\n\r\nfunction onObjectDrop(playerColor, dropObject)\r\n  if (dropObject.tag == \"Card\") then\r\n    dropObject.setVar(\"curLiftingPlayer\", nil)\r\n\r\n    -- If the card was already in a spawning zone, handle spawning the GUI.  This also handles updating the GUI position.\r\n    if ((dropObject.getVar(\"curMatZone\") == \"Blue\") or (dropObject.getVar(\"curBattlefieldZone\") == \"Blue\")) then\r\n      blueBoardsPrefab.call('handlePossibleDiceSpawn', {cardObject=dropObject})\r\n    elseif ((dropObject.getVar(\"curMatZone\") == \"Red\") or (dropObject.getVar(\"curBattlefieldZone\") == \"Red\")) then\r\n      redBoardsPrefab.call('handlePossibleDiceSpawn', {cardObject=dropObject})\r\n    else\r\n      -- Nothing needs done.\r\n    end\r\n  end\r\nend\r\n\r\nfunction onObjectPickUp(playerColor, pickUpObject)\r\n  if (pickUpObject.tag == \"Card\") then\r\n    pickUpObject.setVar(\"curLiftingPlayer\", playerColor)\r\n  end\r\nend\r\n\r\nfunction onObjectEnterScriptingZone(zone, enterObject)\r\n  local zoneObjects = nil\r\n  local spawnBluePerspective = false\r\n  local spawnRedPerspective = false\r\n  local objectY = enterObject.getPosition().y\r\n  local rotationZ = enterObject.getRotation().z\r\n\r\n  if ((normalGameStarted == true) and (modernInterfaceActive == true)) then\r\n    -- Only check cards.\r\n    if (enterObject.tag == \"Card\") then\r\n      -- Check if the zone should spawn dice.\r\n      if (zone == blueMatZone) then\r\n        enterObject.setVar(\"curMatZone\", \"Blue\")\r\n        print(\"blue zone\")\r\n        spawnBluePerspective = true\r\n      elseif (zone == redMatZone) then\r\n        enterObject.setVar(\"curMatZone\", \"Red\")\r\n        spawnRedPerspective = true\r\n      end\r\n\r\n      -- Only check for spawning here if no one is currently lifting the card.\r\n      if (spawnBluePerspective == true) then\r\n        if (enterObject.getVar(\"curLiftingPlayer\") == nil) then\r\n          print(\"do blue spawn\")\r\n          blueBoardsPrefab.call('handlePossibleBotSpawn', {cardObject=enterObject})\r\n        end\r\n      elseif (spawnRedPerspective == true) then\r\n        if (enterObject.getVar(\"curLiftingPlayer\") == nil) then\r\n          redBoardsPrefab.call('handlePossibleBotSpawn', {cardObject=enterObject})\r\n        end\r\n      else\r\n        -- Nothing needs done.\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction onObjectLeaveScriptingZone(zone, leaveObject)\r\n  if ((normalGameStarted == true) and (modernInterfaceActive == true)) then\r\n    -- Only check cards.\r\n    if (leaveObject.tag == \"Card\") then\r\n      -- Check if the card is leaving a mat zone.\r\n      if ((zone == blueMatZone) or (zone == redMatZone)) then\r\n        leaveObject.setVar(\"curMatZone\", nil)\r\n\r\n        -- Hide the GUI when the card leaves a mat zone.\r\n        local linkedGUIHolder = leaveObject.getVar(\"linkedGUIHolder\")\r\n        if (linkedGUIHolder != nil) then\r\n          linkedGUIHolder.UI.setAttribute(\"card_gui\", \"active\", false)\r\n          linkedGUIHolder.UI.setAttribute(\"opponent_card_gui\", \"active\", false)\r\n        end\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction onObjectDestroy(destroyObject)\r\n  if ((normalGameStarted == true) and (modernInterfaceActive == true)) then\r\n    -- Only check cards.\r\n    if (destroyObject.tag == \"Card\") then\r\n      local linkedGUIHolder = destroyObject.getVar(\"linkedGUIHolder\")\r\n\r\n      -- Destruct the GUI holder.\r\n      if (linkedGUIHolder != nil) then\r\n        linkedGUIHolder.destruct()\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction dealPackForEachPlayer(dealExpansion, dealPositionForPlayer, dealRotationForPlayer)\r\n  for playerIndex,somePlayer in pairs(seatedPlayers) do\r\n    local baseDealPosition = dealPositionForPlayer[somePlayer]\r\n\r\n    -- Deal an entire pack to each player.\r\n    for cardIndex=1,5 do\r\n      coroutine.yield(0)\r\n\r\n      local curExpansionIndex = nextExpansionIndex[dealExpansion]\r\n      local curNameOrDescription = rivalsExpansionPacks[dealExpansion][curExpansionIndex]\r\n\r\n      -- Record the name or description for verification purposes.\r\n      table.insert(dealtCards[somePlayer], curNameOrDescription)\r\n\r\n      -- Find the card.\r\n      local deckObjects = mixedPacksDeck.getObjects()\r\n      local cardFound = false\r\n      for checkIndex,checkCard in ipairs(deckObjects) do\r\n        if cubeCompatibilityMode == true then\r\n          if checkCard.nickname == curNameOrDescription then\r\n            cardFound = true\r\n            local pullGuid = checkCard.guid\r\n            mixedPacksDeck.takeObject({position={ baseDealPosition.x,\r\n                                                  (baseDealPosition.y + dealHeight + (cardIndex * 0.3)),\r\n                                                  baseDealPosition.z },\r\n                                      rotation=dealRotationForPlayer[somePlayer],\r\n                                      guid=pullGuid,\r\n                                      flip=false,\r\n                                      smooth=false})\r\n            break\r\n          end\r\n        else\r\n          if checkCard.description == curNameOrDescription then\r\n            cardFound = true\r\n            local pullGuid = checkCard.guid\r\n            mixedPacksDeck.takeObject({position={ baseDealPosition.x,\r\n                                                  (baseDealPosition.y + dealHeight + (cardIndex * 0.3)),\r\n                                                  baseDealPosition.z },\r\n                                      rotation=dealRotationForPlayer[somePlayer],\r\n                                      guid=pullGuid,\r\n                                      flip=false,\r\n                                      smooth=false})\r\n            break\r\n          end\r\n        end\r\n      end\r\n\r\n      if cardFound == false then\r\n        printToAll(\"Error, card \\\"\" .. curNameOrDescription .. \"\\\" not found.\", {1,0,0})\r\n      end\r\n\r\n      nextExpansionIndex[dealExpansion] = nextExpansionIndex[dealExpansion] + 1\r\n    end\r\n  end\r\n\r\n  -- Provide a bit of room between each pack.\r\n  dealHeight = dealHeight + 1.9\r\nend\r\n\r\nfunction draftReadyForDeal()\r\n  startLuaCoroutine(self, \"draftReadyForDealCoroutine\")\r\nend\r\n\r\nfunction draftReadyForDealCoroutine()\r\n  local numPacksToDeal = 0\r\n\r\n  if rivalsMode == \"Normal Sealed\" then\r\n    numPacksToDeal = 8\r\n  elseif rivalsMode == \"Winchester Draft\" then\r\n    numPacksToDeal = numWinchesterPacks\r\n  elseif rivalsMode == \"Normal Draft\" then\r\n    numPacksToDeal = 3\r\n  elseif rivalsMode == \"Cube Draft\" then\r\n    numPacksToDeal = 3\r\n  else\r\n    -- This should never happen.\r\n    printToAll(\"Error, unknown mode \" .. rivalsMode, {1,0,0})\r\n  end\r\n\r\n  -- Scan seats in case players were shuffled before the round starts.\r\n  if (passRound == 1) then\r\n    scanSeatedPlayers()\r\n    draftGameStarted = true\r\n    cleanupMats()\r\n  end\r\n\r\n  local dealPositionForPlayer = {}\r\n  local dealRotationForPlayer = {}\r\n\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    dealtCards[somePlayer] = {}\r\n\r\n    local zonePosition = getObjectFromGUID(seatData[somePlayer].scriptZoneGuid).getPosition()\r\n    local zoneRotation = getObjectFromGUID(seatData[somePlayer].scriptZoneGuid).getRotation()\r\n\r\n    dealPositionForPlayer[somePlayer] = {}\r\n    dealRotationForPlayer[somePlayer] = {}\r\n\r\n    if rivalsMode != \"Winchester Draft\" then\r\n      dealPositionForPlayer[somePlayer].x = zonePosition.x\r\n      -- Cards are dealt in the air in case the Rivals deck is underneath.\r\n      dealPositionForPlayer[somePlayer].y = 2.5\r\n      dealPositionForPlayer[somePlayer].z = zonePosition.z\r\n      dealRotationForPlayer[somePlayer].x = (zoneRotation.x + 180)\r\n      dealRotationForPlayer[somePlayer].y = zoneRotation.y\r\n      dealRotationForPlayer[somePlayer].z = zoneRotation.z\r\n    else\r\n      -- Override the card position for Winchester mode.\r\n      if somePlayer == \"Blue\" then\r\n        dealPositionForPlayer[somePlayer].x = 28.25\r\n        dealPositionForPlayer[somePlayer].y = 2.5\r\n        dealPositionForPlayer[somePlayer].z = 6.60\r\n        dealRotationForPlayer[somePlayer].x = 0\r\n        dealRotationForPlayer[somePlayer].y = 0\r\n        dealRotationForPlayer[somePlayer].z = 180\r\n      elseif somePlayer == \"Green\" then\r\n        dealPositionForPlayer[somePlayer].x = (-28.25)\r\n        dealPositionForPlayer[somePlayer].y = 2.5\r\n        dealPositionForPlayer[somePlayer].z = 6.60\r\n        dealRotationForPlayer[somePlayer].x = 0\r\n        dealRotationForPlayer[somePlayer].y = 0\r\n        dealRotationForPlayer[somePlayer].z = 180\r\n      else\r\n        -- This should never happen.\r\n        printToAll(\"Error, Winchester draft only supports Blue and Green seated players.\", {1,0,0})\r\n        return\r\n      end\r\n    end\r\n  end\r\n\r\n  -- Cards are dealt in the air to form a deck.\r\n  dealHeight = 0\r\n\r\n  if rivalsMode == \"Winchester Draft\" then\r\n    winchesterBoard.setPosition({0,1,-4.8})\r\n  end\r\n\r\n  -- Deal in reverse order so the first selected expansion pack ends up on the top of the stack.\r\n  local packSelectionIndex = (numPacksDealt + numPacksToDeal)\r\n\r\n  for dealPackIndex=1,numPacksToDeal do\r\n    dealPackForEachPlayer(packSelections[packSelectionIndex], dealPositionForPlayer, dealRotationForPlayer)\r\n    packSelectionIndex = packSelectionIndex - 1\r\n\r\n    -- Delay between packs to prevent the packs from blending together.\r\n    coroutine.yield(0)\r\n    coroutine.yield(0)\r\n    coroutine.yield(0)\r\n  end\r\n\r\n  numPacksDealt = numPacksDealt + numPacksToDeal\r\n\r\n  -- Sealed mode is almost ready at this point.  Draft modes still need dice spawned.\r\n  if rivalsMode == \"Normal Sealed\" then\r\n    cleanupTable()\r\n\r\n    printToAll(\"SEALED GENERATION COMPLETE.\", {0,0.8,0})\r\n    printToAll(\"===========================================\", {1,1,1})\r\n    printToAll(\"REMEMBER TO RIGHT CLICK AND SAVE YOUR DECK\", {1,1,1})\r\n    printToAll(\"===========================================\", {1,1,1})\r\n\r\n    -- Set up the deckbuilding zones.\r\n    setupHiddenZones()\r\n  elseif rivalsMode == \"Winchester Draft\" then\r\n    cleanupTable()\r\n\r\n    printToAll(\"WINCHESTER GENERATION COMPLETE.\", {0,0.8,0})\r\n\r\n    -- Move certain script zones above the table now.  This prevents the zones from flashing briefly.\r\n\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      local newZonePosition = winchesterStockZones[somePlayer].getPosition()\r\n      newZonePosition.y = 1\r\n      winchesterStockZones[somePlayer].setPosition(newZonePosition)\r\n    end\r\n\r\n    for curZoneIndex=1,4 do\r\n      newZonePosition = winchesterDraftZones[curZoneIndex].getPosition()\r\n      newZonePosition.y = 1.270\r\n      winchesterDraftZones[curZoneIndex].setPosition(newZonePosition)\r\n    end\r\n\r\n    Wait.time(startWinchesterDeal, 2.0)\r\n  elseif ((rivalsMode == \"Normal Draft\") or (rivalsMode == \"Cube Draft\")) then\r\n    Wait.time(spawnDraftDice, 1.5)\r\n  else\r\n    -- This should never happen.\r\n    printToAll(\"Error, it should be impossible to pass after clicking the Done button.\", {1,0,0})\r\n  end\r\n\r\n  return 1\r\nend\r\n\r\nfunction cleanupTable()\r\n  -- Set a small delay in case any last cards are still being pulled from decks.\r\n  Wait.time(cleanupTableAfterWait, 0.5)\r\nend\r\n\r\nfunction cleanupTableAfterWait()\r\n  -- Destruct the sign.\r\n  if pleaseWaitBoard != nil then\r\n    pleaseWaitBoard.destruct()\r\n  end\r\n\r\n  -- Destruct leftover decks.\r\n\r\n  if mixedPacksDeck != nil then\r\n    mixedPacksDeck.destruct()\r\n  end\r\n\r\n  if draftDiceCardDeck != nil then\r\n    draftDiceCardDeck.destruct()\r\n  end\r\n\r\n  if draftUncommonDeck != nil then\r\n    draftUncommonDeck.destruct()\r\n  end\r\n\r\n  if draftCommonDeck != nil then\r\n    draftCommonDeck.destruct()\r\n  end\r\n\r\n  -- Destruct the setup bag.\r\n  if setupObject != nil then\r\n    setupObject.destruct()\r\n  end\r\nend\r\n\r\nfunction setupHiddenZones()\r\n  -- Move hidden deckbuilding zones out of the sky.\r\n\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    local hiddenZone = getObjectFromGUID(seatData[somePlayer].hiddenZoneGuid)\r\n    local zoneScale = {18.75, 80.00, 13.12}\r\n    local zonePosition = seatData[somePlayer].hiddenZonePosition\r\n\r\n    -- For Winchester draft, use bigger deckbuilding zones.\r\n    if rivalsMode == \"Winchester Draft\" then\r\n      zoneScale[3] = 21.00\r\n      zonePosition[3] = 20.00\r\n    end\r\n\r\n    hiddenZone.setScale(zoneScale)\r\n    hiddenZone.setPosition(zonePosition)\r\n  end\r\nend\r\n\r\nfunction startWinchesterDeal()\r\n  -- Deal 2 cards from each seated player's stock deck.\r\n\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    local scriptZoneObjects = winchesterStockZones[somePlayer].getObjects()\r\n    for i,curDeck in ipairs(scriptZoneObjects) do\r\n      local dealPosition = {}\r\n\r\n      -- Mark the deck as not interactable.\r\n      curDeck.interactable = false\r\n\r\n      -- For Winchester, new cards are dealt on top of the Winchester board and next to any existing cards.\r\n      --\r\n      -- NOTE:  Only checking for the \"Deck\" tag is fine because all Winchester source decks are currently\r\n      --        required to contain an even number of cards.  This means the 2 last cards of a deck will\r\n      --        be dealt simultaneously.\r\n\r\n      if somePlayer == \"Blue\" then\r\n        dealPosition[1] = (winchesterBasePositions[1][1] - ((winchesterNumZoneCards[1] % 3) * 3.26))\r\n        dealPosition[2] = 2\r\n        dealPosition[3] = (winchesterBasePositions[1][3] - (math.floor(winchesterNumZoneCards[1] / 3) * 4.45))\r\n\r\n        if curDeck.tag == \"Deck\" then\r\n          curDeck.takeObject({position=dealPosition, rotation={0,0,0}, flip=false, smooth=false})\r\n          winchesterNumZoneCards[1] = (winchesterNumZoneCards[1] + 1)\r\n        end\r\n\r\n        dealPosition[1] = (winchesterBasePositions[2][1] - ((winchesterNumZoneCards[2] % 3) * 3.26))\r\n        dealPosition[2] = 2\r\n        dealPosition[3] = (winchesterBasePositions[2][3] - (math.floor(winchesterNumZoneCards[2] / 3) * 4.45))\r\n\r\n        if curDeck.tag == \"Deck\" then\r\n          curDeck.takeObject({position=dealPosition, rotation={0,0,0}, flip=false, smooth=false})\r\n          winchesterNumZoneCards[2] = (winchesterNumZoneCards[2] + 1)\r\n        end\r\n      elseif somePlayer == \"Green\" then\r\n        dealPosition[1] = (winchesterBasePositions[3][1] - ((winchesterNumZoneCards[3] % 3) * 3.26))\r\n        dealPosition[2] = 2\r\n        dealPosition[3] = (winchesterBasePositions[3][3] - (math.floor(winchesterNumZoneCards[3] / 3) * 4.45))\r\n\r\n        if curDeck.tag == \"Deck\" then\r\n          curDeck.takeObject({position=dealPosition, rotation={0,0,0}, flip=false, smooth=false})\r\n          winchesterNumZoneCards[3] = (winchesterNumZoneCards[3] + 1)\r\n        end\r\n\r\n        dealPosition[1] = (winchesterBasePositions[4][1] - ((winchesterNumZoneCards[4] % 3) * 3.26))\r\n        dealPosition[2] = 2\r\n        dealPosition[3] = (winchesterBasePositions[4][3] - (math.floor(winchesterNumZoneCards[4] / 3) * 4.45))\r\n\r\n        if curDeck.tag == \"Deck\" then\r\n          curDeck.takeObject({position=dealPosition, rotation={0,0,0}, flip=false, smooth=false})\r\n          winchesterNumZoneCards[4] = (winchesterNumZoneCards[4] + 1)\r\n        end\r\n      else\r\n        -- This should never happen.\r\n        printToAll(\"Error, Winchester draft only supports Blue and Green seated players.\", {1,0,0})\r\n        return\r\n      end\r\n    end\r\n  end\r\n\r\n  Wait.time(handleWinchesterDealFinished, 0.75)\r\nend\r\n\r\nfunction handleWinchesterDealFinished()\r\n  -- If this is the first round, determine the number of Winchester players.  This should always be 1 or 2.\r\n  if numWinchesterPlayers == 0 then\r\n    local lastSeatedPlayer = nil\r\n\r\n    numWinchesterPlayers = 0\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      lastSeatedPlayer = somePlayer\r\n      numWinchesterPlayers = numWinchesterPlayers+1\r\n    end\r\n\r\n    if numWinchesterPlayers == 0 then\r\n      -- This should never happen.\r\n      printToAll(\"Error, no seated players found.\", {1,0,0})\r\n      pleaseWaitBoard.destruct()\r\n      return\r\n    elseif numWinchesterPlayers == 1 then\r\n      -- Calculate the Winchester pick count.\r\n      winchesterPickCount = (((numWinchesterPacks * 5) / 2) + 1)\r\n\r\n      curWinchesterPlayer = lastSeatedPlayer\r\n      printToAll(curWinchesterPlayer .. \" is the only player and will go first.\", stringColorToRGB(curWinchesterPlayer))\r\n    elseif numWinchesterPlayers == 2 then\r\n      -- Calculate the Winchester pick count.\r\n      winchesterPickCount = (((numWinchesterPacks * 5) / 2) + 3)\r\n\r\n      -- Randomly pick the first player.\r\n      if (math.random(1, 2) == 1) then\r\n        curWinchesterPlayer = \"Blue\"\r\n      else\r\n        curWinchesterPlayer = \"Green\"\r\n      end\r\n      printToAll(curWinchesterPlayer .. \" was randomly selected to go first.\", stringColorToRGB(curWinchesterPlayer))\r\n    else\r\n      printToAll(\"Error, Winchester draft only supports 2 seated players.\", {1,0,0})\r\n      pleaseWaitBoard.destruct()\r\n      return\r\n    end\r\n\r\n    -- Make the pick counter visible.\r\n    winchesterPickCountText.TextTool.setValue(\"Turns left:  \" .. winchesterPickCount)\r\n    winchesterPickCountText.setPosition({0, 1.2, 14.5})\r\n  end\r\n\r\n  -- Start the Winchester turn.\r\n  startLuaCoroutine(self, \"startWinchesterTurnCoroutine\")\r\nend\r\n\r\nfunction startWinchesterTurnCoroutine()\r\n  local winchesterZoneHasCards = {}\r\n\r\n  -- Scan all draft zones and lock all card(s) in them.  Making them uninteractable would prevent zooming with Alt.\r\n  for curZoneIndex=1,4 do\r\n    winchesterZoneHasCards[curZoneIndex] = false\r\n\r\n    -- Note that the tags must be checked since the board or other object(s) may be detected in these script zones.\r\n    local scriptZoneObjects = winchesterDraftZones[curZoneIndex].getObjects()\r\n    for deckIndex,curDeck in ipairs(scriptZoneObjects) do\r\n      if ((curDeck.tag == \"Deck\") or (curDeck.tag == \"Card\")) then\r\n        curDeck.setLock(true)\r\n        winchesterZoneHasCards[curZoneIndex] = true\r\n      end\r\n    end\r\n  end\r\n\r\n  -- Create buttons for each draft zone if they have card(s).  Since the Winchester board is scaled differently from the\r\n  -- main table, these values are hardcoded here.\r\n\r\n  if winchesterZoneHasCards[1] == true then\r\n    winchesterBoard.createButton({\r\n      label='Take', click_function = (\"takeButton1Clicked\"), function_owner=Global,\r\n      position={-0.850,0.2,0.80}, rotation={0,0,0}, width=160, height=85, font_size=60, color=stringColorToRGB(curWinchesterPlayer)\r\n    })\r\n  end\r\n\r\n  if winchesterZoneHasCards[2] == true then\r\n    winchesterBoard.createButton({\r\n      label='Take', click_function = (\"takeButton2Clicked\"), function_owner=Global,\r\n      position={-0.285,0.2,0.80}, rotation={0,0,0}, width=160, height=85, font_size=60, color=stringColorToRGB(curWinchesterPlayer)\r\n    })\r\n  end\r\n\r\n  if winchesterZoneHasCards[3] == true then\r\n    winchesterBoard.createButton({\r\n      label='Take', click_function = (\"takeButton3Clicked\"), function_owner=Global,\r\n      position={0.285,0.2,0.80}, rotation={0,0,0}, width=160, height=85, font_size=60, color=stringColorToRGB(curWinchesterPlayer)\r\n    })\r\n  end\r\n\r\n  if winchesterZoneHasCards[4] == true then\r\n    winchesterBoard.createButton({\r\n      label='Take', click_function = (\"takeButton4Clicked\"), function_owner=Global,\r\n      position={0.850,0.2,0.80}, rotation={0,0,0}, width=160, height=85, font_size=60, color=stringColorToRGB(curWinchesterPlayer)\r\n    })\r\n  end\r\n\r\n  return 1\r\nend\r\n\r\nfunction takeButtonGeneral(buttonObject, playerColor, whichButton)\r\n  if playerColor == curWinchesterPlayer then\r\n    local draftFinalPosition = getObjectFromGUID(seatData[playerColor].scriptZoneGuid).getPosition()\r\n    local draftFinalRotation = getObjectFromGUID(seatData[playerColor].scriptZoneGuid).getRotation()\r\n\r\n    -- Move the card above the table to fall on the player's card(s), if any.\r\n    -- The card will be moved without collision, and it will be moved fast.\r\n    -- Just using setPosition() instead would result in the card hovering.\r\n    draftFinalPosition.y = 2\r\n\r\n    -- Delete the buttons.  More buttons will be created as needed.\r\n    winchesterBoard.clearButtons()\r\n\r\n    -- Note that the tags must be checked since the board or other object(s) may be detected in these script zones.\r\n    local scriptZoneObjects = winchesterDraftZones[whichButton].getObjects()\r\n    local draftStack = nil\r\n    for objectIndex,curObject in ipairs(scriptZoneObjects) do\r\n      if (curObject.tag == \"Card\") then\r\n        curObject.setLock(false)\r\n        curObject.setPositionSmooth(draftFinalPosition, false, true)\r\n        curObject.setRotation({ draftFinalRotation.x + 180, draftFinalRotation.y, draftFinalRotation.z })\r\n        -- Lift each card slightly so they fall in sequence.\r\n        draftFinalPosition.y = draftFinalPosition.y + 0.3\r\n      elseif (curObject.tag == \"Deck\") then\r\n        -- This should never happen.\r\n        printToAll(\"Error, deck found in Winchester zone.\", {1,0,0})\r\n      else\r\n        -- Nothing needs done.\r\n      end\r\n    end\r\n\r\n    -- Mark the zone as having no cards.\r\n    winchesterNumZoneCards[whichButton] = 0\r\n\r\n    -- If there are two players, switch the current player.\r\n    if numWinchesterPlayers == 2 then\r\n      if curWinchesterPlayer == \"Blue\" then\r\n        curWinchesterPlayer = \"Green\"\r\n      else\r\n        curWinchesterPlayer = \"Blue\"\r\n      end\r\n    end\r\n\r\n    -- Decrement the pick count.\r\n    if winchesterPickCount > 0 then\r\n      winchesterPickCount = winchesterPickCount-1\r\n\r\n      -- Update the pick counter.\r\n      winchesterPickCountText.TextTool.setValue(\"Turns left:  \" .. winchesterPickCount)\r\n\r\n      if winchesterPickCount == 0 then\r\n        finishWinchesterDraft()\r\n        return\r\n      end\r\n    else\r\n      -- This should never happen.\r\n      printToAll(\"Error, it should be impossible to click a button after the final pick.\", {1,0,0})\r\n    end\r\n\r\n    -- Prepare to deal more cards.\r\n    Wait.time(startWinchesterDeal, 0.5)\r\n  else\r\n    printToAll(playerColor .. \" tried to take cards out of turn.\", stringColorToRGB(playerColor))\r\n  end\r\nend\r\n\r\nfunction takeButton1Clicked(buttonObject, playerColor)\r\n  takeButtonGeneral(buttonObject, playerColor, 1)\r\nend\r\n\r\nfunction takeButton2Clicked(buttonObject, playerColor)\r\n  takeButtonGeneral(buttonObject, playerColor, 2)\r\nend\r\n\r\nfunction takeButton3Clicked(buttonObject, playerColor)\r\n  takeButtonGeneral(buttonObject, playerColor, 3)\r\nend\r\n\r\nfunction takeButton4Clicked(buttonObject, playerColor)\r\n  takeButtonGeneral(buttonObject, playerColor, 4)\r\nend\r\n\r\nfunction finishWinchesterDraft()\r\n  -- NOTE:  Destroying the Winchester board may be visually jarring, so it is left in place.\r\n\r\n  winchesterPickCountText.destruct()\r\n  printToAll(\"WINCHESTER DRAFT COMPLETE.\", {0,0.8,0})\r\n  printToAll(\"===========================================\", {1,1,1})\r\n  printToAll(\"REMEMBER TO RIGHT CLICK AND SAVE YOUR DECK\", {1,1,1})\r\n  printToAll(\"===========================================\", {1,1,1})\r\n\r\n  -- Set up the deckbuilding zones.\r\n  setupHiddenZones()\r\nend\r\n\r\nfunction showPleaseWait()\r\n  pleaseWaitBoard.setPosition({0,1.5,0})\r\n\r\n  -- This is a convenient function that gets called for all draft / sealed modes.  Scale all hand zones down so they don't grab cards.\r\n  for i,someSeat in pairs(seatData) do\r\n    local handTransform = Player[i].getHandTransform()\r\n    handTransform.scale.x = 0.01\r\n    handTransform.scale.y = 0.01\r\n    handTransform.scale.z = 0.01\r\n    Player[i].setHandTransform(handTransform)\r\n  end\r\nend\r\n\r\nfunction showPassLeft()\r\n  pleaseWaitBoard.destruct()\r\n  passLeftBoard.setPosition({0,1,0})\r\n\r\n  -- All seated players should have Pass buttons at the start of the round.\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    seatData[somePlayer].draftStackHasCards = true\r\n    seatData[somePlayer].limboHasCards = false\r\n    seatData[somePlayer].shouldHaveButton = true\r\n  end\r\n\r\n  -- Start a repeating loop to check limbo areas.\r\n  periodicLimboCheckWaitID = Wait.time(periodicLimboCheck, 1.0)\r\n  limboCheckEnabled = true\r\nend\r\n\r\nfunction showPassRight()\r\n  passLeftBoard.destruct()\r\n  passRightBoard.setPosition({0,1,0})\r\n\r\n  -- All seated players should have Pass buttons at the start of the round.\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    seatData[somePlayer].draftStackHasCards = true\r\n    seatData[somePlayer].limboHasCards = false\r\n    seatData[somePlayer].shouldHaveButton = true\r\n  end\r\n\r\n  -- Enable the limbo check again.\r\n  limboCheckEnabled = true\r\nend\r\n\r\n-- Note:  These two functions could be made smaller with another data structure, but they work at present in their silly form.\r\n\r\nfunction getSeatedPlayerLeft(playerColor)\r\n  -- Default to the current player.\r\n  local returnPlayer = playerColor\r\n\r\n  if playerColor == \"Green\" then\r\n     if seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Blue\" then\r\n     if seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Purple\" then\r\n     if seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Pink\" then\r\n     if seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"White\" then\r\n     if seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Red\" then\r\n     if seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Orange\" then\r\n     if seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Yellow\" then\r\n     if seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  end\r\n\r\n  return returnPlayer\r\nend\r\n\r\nfunction getSeatedPlayerRight(playerColor)\r\n  -- Default to the current player.\r\n  local returnPlayer = playerColor\r\n\r\n  if playerColor == \"Green\" then\r\n     if seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Blue\" then\r\n     if seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Purple\" then\r\n     if seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Pink\" then\r\n     if seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"White\" then\r\n     if seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Red\" then\r\n     if seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     elseif seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Orange\" then\r\n      if seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     elseif seatData[\"Yellow\"].filled == true then\r\n        returnPlayer = \"Yellow\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  elseif playerColor == \"Yellow\" then\r\n      if seatData[\"Orange\"].filled == true then\r\n        returnPlayer = \"Orange\"\r\n     elseif seatData[\"Red\"].filled == true then\r\n        returnPlayer = \"Red\"\r\n     elseif seatData[\"White\"].filled == true then\r\n        returnPlayer = \"White\"\r\n     elseif seatData[\"Pink\"].filled == true then\r\n        returnPlayer = \"Pink\"\r\n     elseif seatData[\"Purple\"].filled == true then\r\n        returnPlayer = \"Purple\"\r\n     elseif seatData[\"Blue\"].filled == true then\r\n        returnPlayer = \"Blue\"\r\n     elseif seatData[\"Green\"].filled == true then\r\n        returnPlayer = \"Green\"\r\n     else\r\n        printToAll(\"Only one player in game.\", {1,1,1})\r\n     end\r\n  end\r\n\r\n  return returnPlayer\r\nend\r\n\r\nfunction passButtonClickedCoroutineGreen()\r\n  return passButtonClickedCoroutine(\"Green\")\r\nend\r\n\r\nfunction passButtonClickedCoroutineBlue()\r\n  return passButtonClickedCoroutine(\"Blue\")\r\nend\r\n\r\nfunction passButtonClickedCoroutinePurple()\r\n  return passButtonClickedCoroutine(\"Purple\")\r\nend\r\n\r\nfunction passButtonClickedCoroutinePink()\r\n  return passButtonClickedCoroutine(\"Pink\")\r\nend\r\n\r\nfunction passButtonClickedCoroutineWhite()\r\n  return passButtonClickedCoroutine(\"White\")\r\nend\r\n\r\nfunction passButtonClickedCoroutineRed()\r\n  return passButtonClickedCoroutine(\"Red\")\r\nend\r\n\r\nfunction passButtonClickedCoroutineOrange()\r\n  return passButtonClickedCoroutine(\"Orange\")\r\nend\r\n\r\nfunction passButtonClickedCoroutineYellow()\r\n  return passButtonClickedCoroutine(\"Yellow\")\r\nend\r\n\r\nfunction passButtonClickedGreen(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Green\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedBlue(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Blue\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedPurple(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Purple\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedPink(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Pink\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedWhite(passButton, playerColor)\r\n  passButtonClickedGeneral(\"White\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedRed(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Red\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedOrange(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Orange\", playerColor)\r\nend\r\n\r\nfunction passButtonClickedYellow(passButton, playerColor)\r\n  passButtonClickedGeneral(\"Yellow\", playerColor)\r\nend\r\n\r\nfunction scanSeatedPlayers()\r\n  if (draftGameStarted == false) then\r\n    -- Note that getSeatedPlayers() never returns Grey or Black players, and it only returns colors.\r\n    seatedPlayers = getSeatedPlayers()\r\n\r\n    -- Initialize the seated states.\r\n    for i,someSeat in pairs(seatData) do\r\n       someSeat.filled = false\r\n    end\r\n\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      seatData[somePlayer].filled = true\r\n    end\r\n  end\r\n\r\n  for i,someSeat in pairs(seatData) do\r\n    -- Record the host's color.\r\n    if (Player[i].host == true) then\r\n      curHostColor = i\r\n    end\r\n\r\n    -- Spawn/destruct if needed.\r\n    if ((rivalsMode == \"Normal Draft\") or (rivalsMode == \"Cube Draft\")) then\r\n      local buttonHolder = getObjectFromGUID(someSeat.passButtonHolderGuid)\r\n\r\n      if (someSeat.filled == true) then\r\n        if ((someSeat.shouldHaveButton == true) and (someSeat.hasButton == false)) then\r\n          -- Create the button.\r\n          createPassButton(i)\r\n        end\r\n      else\r\n        if (someSeat.hasButton == true) then\r\n          -- The player is not seated.  Destruct the button.\r\n          buttonHolder.clearButtons()\r\n          someSeat.hasButton = false\r\n        end\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction moveAllMatsUp()\r\n  local curMat = nil\r\n  local curZone = nil\r\n  local curPosition = nil\r\n\r\n  for i,someSeat in pairs(seatData) do\r\n    curMat = getObjectFromGUID(someSeat.matGuid)\r\n\r\n    curPosition = curMat.getPosition()\r\n    curPosition.y = 0.96\r\n    curMat.setPosition(curPosition)\r\n\r\n    -- Also, move the deck scripting zone up for this seat.\r\n    curZone = getObjectFromGUID(someSeat.scriptZoneGuid)\r\n    curPosition = curZone.getPosition()\r\n    curPosition.y = 3.51\r\n    curZone.setPosition(curPosition)\r\n  end\r\n\r\n  -- This is also a convenient place to move the Rivals deck scripting zone up.\r\n  local rivalsDeckZone = getObjectFromGUID(rivalsDeckZoneGuid)\r\n  if rivalsDeckZone != nil then\r\n    curPosition = rivalsDeckZone.getPosition()\r\n    curPosition.y = 3.51\r\n    rivalsDeckZone.setPosition(curPosition)\r\n  end\r\nend\r\n\r\nfunction randomizeMats()\r\n  local curMat = nil\r\n  local customObject = nil\r\n  local randomKeyIndex = 0\r\n\r\n  for i,someSeat in pairs(seatData) do\r\n    curMat = getObjectFromGUID(someSeat.matGuid)\r\n\r\n    -- Update seat image\r\n    if (curMat != nil) then\r\n      customObject = curMat.getCustomObject()\r\n\r\n      randomKeyIndex = math.random(1, #matKeys)\r\n      customObject.image = matImages[matKeys[randomKeyIndex]]\r\n\r\n      curMat.setCustomObject(customObject)\r\n      curMat.reload()\r\n    end\r\n  end\r\nend\r\n\r\nfunction cleanupMats()\r\n  local curMat = nil\r\n\r\n  if (draftGameStarted == true) then\r\n    for i,someSeat in pairs(seatData) do\r\n      if (someSeat.filled == false) then\r\n        curMat = getObjectFromGUID(someSeat.matGuid)\r\n        if (curMat != nil) then\r\n          curMat.destruct()\r\n        end\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\n--[[ The Update function. This is called once per frame. --]]\r\nfunction update ()\r\n    --[[ print('Update loop!') --]]\r\nend\r\n\r\n--function fixCardName(params)\r\n--  local possiblyBrokenName = params[1]\r\n--  local fixedName = possiblyBrokenName\r\n--\r\n--  for testIndex,testFix in ipairs(cardNameFixes) do\r\n--    if possiblyBrokenName == testFix.brokenName then\r\n--      fixedName = testFix.fixedName\r\n--      break\r\n--    end\r\n--  end\r\n--\r\n--  return fixedName\r\n--end\r\n\r\n---- NOTE:  These are just a few card names to fix legacy exports.\r\n----        This list is not complete, and a new export from SWDDB should be used instead, since it will generate dice correctly for all cards.\r\n--cardNameFixes = {\r\n--}\r\n--\r\n---- UPDATE CARDS TABLE\r\n--cardstable = {\r\n---- Wave 1\r\n--  {  cardname = 'Arcee', cardsubname = 'Skilled Fighter', cost = '5', type = 'Character', rarity = 'RT', number = '01', set = 'T40'  },\r\n--  {  cardname = 'Autobot Cosmos', cardsubname = 'Recon & Communication', cost = '11', type = 'Character', rarity = 'RT', number = '02', set = 'T40'  },\r\n--  {  cardname = 'Autobot Hound', cardsubname = 'Long Range Scout', cost = '8', type = 'Character', rarity = 'CT', number = '03', set = 'T40'  },\r\n--  {  cardname = 'Autobot Jazz', cardsubname = 'Special Ops', cost = '6', type = 'Character', rarity = 'UT', number = '04', set = 'T40'  },\r\n--  {  cardname = 'Autobot Mirage', cardsubname = 'Lone Wolf', cost = '9', type = 'Character', rarity = 'UT', number = '05', set = 'T40'  },\r\n--  {  cardname = 'Barrage', cardsubname = 'Merciless Insecticon', cost = '7', type = 'Character', rarity = 'CT', number = '06', set = 'T40'  },\r\n--  {  cardname = 'Bombshell', cardsubname = 'Insecticon Mind-Controller', cost = '8', type = 'Character', rarity = 'CT', number = '07', set = 'T40'  },\r\n--  {  cardname = 'Bumblebee', cardsubname = 'Courageous Scout', cost = '9', type = 'Character', rarity = 'CT', number = '08', set = 'T40'  },\r\n--  {  cardname = 'Bumblebee', cardsubname = 'Legendary Warrior', cost = '10', type = 'Character', rarity = 'SRT', number = '09', set = 'T40'  },\r\n--  {  cardname = 'Chop Shop', cardsubname = 'Sneaky Insecticon', cost = '6', type = 'Character', rarity = 'UT', number = '10', set = 'T40'  },\r\n--  {  cardname = 'Chromia', cardsubname = 'Special Ops', cost = '8', type = 'Character', rarity = 'RT', number = '11', set = 'T40'  },\r\n--  {  cardname = 'Darkmount', cardsubname = 'Cruel Overlord', cost = '9', type = 'Character', rarity = 'RT', number = '12', set = 'T40'  },\r\n--  {  cardname = 'Deadlock', cardsubname = 'Bounty Hunter', cost = '8', type = 'Character', rarity = 'UT', number = '13', set = 'T40'  },\r\n--  {  cardname = 'Decepticon Shockwave', cardsubname = 'Cybertron Commander', cost = '11', type = 'Character', rarity = 'RT', number = '14', set = 'T40'  },\r\n--  {  cardname = 'Demolisher', cardsubname = 'Devoted Decepticon', cost = '6', type = 'Character', rarity = 'UT', number = '15', set = 'T40'  },\r\n--  {  cardname = 'Dinobot Sludge', cardsubname = 'Mighty Stomper', cost = '8', type = 'Character', rarity = 'UT', number = '16', set = 'T40'  },\r\n--  {  cardname = 'Dinobot Slug', cardsubname = 'Hot-Header Warrior', cost = '9', type = 'Character', rarity = 'CT', number = '17', set = 'T40'  },\r\n--  {  cardname = 'Dinobot Snarl', cardsubname = 'Desert Warrior', cost = '7', type = 'Character', rarity = 'UT', number = '18', set = 'T40'  },\r\n--  {  cardname = 'Dinobot Swoop', cardsubname = 'Fearsome Flyer', cost = '6', type = 'Character', rarity = 'CT', number = '19', set = 'T40'  },\r\n--  {  cardname = 'Flamewar', cardsubname = 'Veteran Decepticon', cost = '5', type = 'Character', rarity = 'CT', number = '20', set = 'T40'  },\r\n--  {  cardname = 'Grimlock', cardsubname = 'Dinobot Leader', cost = '10', type = 'Character', rarity = 'RT', number = '21', set = 'T40'  },\r\n--  {  cardname = 'Inferno', cardsubname = 'Fearless Firefighter', cost = '12', type = 'Character', rarity = 'UT', number = '22', set = 'T40'  },\r\n--  {  cardname = 'Insecticon Skrapnet', cardsubname = 'Insecticon Leader', cost = '7', type = 'Character', rarity = 'RT', number = '23', set = 'T40'  },\r\n--  {  cardname = 'Jetfire', cardsubname = 'Air Guardian', cost = '10', type = 'Character', rarity = 'UT', number = '24', set = 'T40'  },\r\n--  {  cardname = 'Kickback', cardsubname = 'Cunning Insecticon', cost = '5', type = 'Character', rarity = 'UT', number = '25', set = 'T40'  },\r\n--  {  cardname = 'Megatron', cardsubname = 'Decepticon Leader', cost = '10', type = 'Character', rarity = 'CT', number = '26', set = 'T40'  },\r\n--  {  cardname = 'Megatron', cardsubname = 'Living Weapon', cost = '13', type = 'Character', rarity = 'RT', number = '27', set = 'T40'  },\r\n--  {  cardname = 'Nemesis Prime', cardsubname = 'Dark Clone', cost = '12', type = 'Character', rarity = 'SRT', number = '28', set = 'T40'  },\r\n--  {  cardname = 'Optimus Prime', cardsubname = 'Battlefield Legend', cost = '13', type = 'Character', rarity = 'RT', number = '29', set = 'T40'  },\r\n--  {  cardname = 'Optimus Prime', cardsubname = 'Freedom Fighter', cost = '12', type = 'Character', rarity = 'CT', number = '30', set = 'T40'  },\r\n--  {  cardname = 'Prowl', cardsubname = 'Military Strategist', cost = '6', type = 'Character', rarity = 'UT', number = '31', set = 'T40'  },\r\n--  {  cardname = 'Ramjet', cardsubname = 'Sky Smasher', cost = '10', type = 'Character', rarity = 'CT', number = '32', set = 'T40'  },\r\n--  {  cardname = 'Ransack', cardsubname = 'Insecticon Commando', cost = '6', type = 'Character', rarity = 'UT', number = '33', set = 'T40'  },\r\n--  {  cardname = 'Sergeant Kup', cardsubname = 'Veteran Sergeant', cost = '7', type = 'Character', rarity = 'CT', number = '34', set = 'T40'  },\r\n--  {  cardname = 'Skywarp', cardsubname = 'Sneaky Prankster', cost = '6', type = 'Character', rarity = 'UT', number = '35', set = 'T40'  },\r\n--  {  cardname = 'Starscream', cardsubname = 'Air Commander', cost = '11', type = 'Character', rarity = 'UT', number = '36', set = 'T40'  },\r\n--  {  cardname = 'Starscream', cardsubname = 'Scheming Second-In-Command', cost = '10', type = 'Character', rarity = 'CT', number = '37', set = 'T40'  },\r\n--  {  cardname = 'Sunstorm', cardsubname = 'Fusion Flyer', cost = '11', type = 'Character', rarity = 'RT', number = '38', set = 'T40'  },\r\n--  {  cardname = 'Thundercracker', cardsubname = 'Mach Warrior', cost = '8', type = 'Character', rarity = 'UT', number = '39', set = 'T40'  },\r\n--  {  cardname = 'Wheeljack', cardsubname = 'Weapons Inventor', cost = '9', type = 'Character', rarity = 'UT', number = '40', set = 'T40'  },\r\n--  {  cardname = 'Bumblebee', cardsubname = 'Brave Warrior', cost = '6', type = 'Character', rarity = 'RT', number = 'T01', set = 'T04'  },\r\n--  {  cardname = 'Ironhide', cardsubname = 'Veteran Autobot', cost = '6', type = 'Character', rarity = 'RT', number = 'T02', set = 'T04'  },\r\n--  {  cardname = 'Optimus Prime', cardsubname = 'Autobot Leader', cost = '7', type = 'Character', rarity = 'RT', number = 'T03', set = 'T04'  },\r\n--  {  cardname = 'Red Alert', cardsubname = 'Security Chief', cost = '6', type = 'Character', rarity = 'RT', number = 'T04', set = 'T04'  },\r\n--  {  cardname = 'CliffJumper', cardsubname = 'Renegade Warrior', cost = '8', type = 'Character', rarity = 'SRT', number = 'T01', set = 'T02'  },\r\n--  {  cardname = 'Slipstream', cardsubname = 'Strategic Seeker', cost = '8', type = 'Character', rarity = 'SRT', number = 'T02', set = 'T02'  }\r\n--}",
  "LuaScriptState": "",
  "Grid": {
    "Type": 0,
    "Lines": false,
    "Color": {
      "r": 0.0,
      "g": 0.0,
      "b": 0.0
    },
    "Opacity": 0.75,
    "ThickLines": false,
    "Snapping": false,
    "Offset": false,
    "BothSnapping": false,
    "xSize": 0.5,
    "ySize": 0.5,
    "PosOffset": {
      "x": 0.0,
      "y": 1.0,
      "z": 0.0
    }
  },
  "Lighting": {
    "LightIntensity": 0.684,
    "LightColor": {
      "r": 1.0,
      "g": 0.9764706,
      "b": 0.8627451
    },
    "AmbientIntensity": 1.076,
    "AmbientType": 0,
    "AmbientSkyColor": {
      "r": 0.5,
      "g": 0.5,
      "b": 0.5
    },
    "AmbientEquatorColor": {
      "r": 0.5,
      "g": 0.5,
      "b": 0.5
    },
    "AmbientGroundColor": {
      "r": 0.5,
      "g": 0.5,
      "b": 0.5
    },
    "ReflectionIntensity": 0.168000251,
    "LutIndex": 0,
    "LutContribution": 1.0,
    "LutURL": ""
  },
  "Hands": {
    "Enable": true,
    "DisableUnused": false,
    "Hiding": 0,
    "HandTransforms": [
      {
        "Color": "Red",
        "Transform": {
          "posX": -9.482677,
          "posY": 5.2765255,
          "posZ": -28.566576,
          "rotX": 0.0,
          "rotY": 0.0,
          "rotZ": 0.0,
          "scaleX": 9.482673,
          "scaleY": 6.6973877,
          "scaleZ": 3.55600476
        }
      },
      {
        "Color": "Yellow",
        "Transform": {
          "posX": -28.6376839,
          "posY": 5.2765255,
          "posZ": 9.48268,
          "rotX": 0.0,
          "rotY": 90.0,
          "rotZ": 0.0,
          "scaleX": 9.498631,
          "scaleY": 6.6973877,
          "scaleZ": 3.564181
        }
      },
      {
        "Color": "Purple",
        "Transform": {
          "posX": 28.5665646,
          "posY": 5.2765255,
          "posZ": 9.48268,
          "rotX": 0.0,
          "rotY": 270.0,
          "rotZ": 0.0,
          "scaleX": 9.498631,
          "scaleY": 6.6973877,
          "scaleZ": 3.564181
        }
      },
      {
        "Color": "Blue",
        "Transform": {
          "posX": 11.8414936,
          "posY": 5.2765255,
          "posZ": 28.6732559,
          "rotX": 0.0,
          "rotY": 179.8,
          "rotZ": 0.0,
          "scaleX": 9.504758,
          "scaleY": 6.6973877,
          "scaleZ": 3.56385946
        }
      },
      {
        "Color": "White",
        "Transform": {
          "posX": 9.482677,
          "posY": 5.2765255,
          "posZ": -28.60213,
          "rotX": 0.0,
          "rotY": 0.0,
          "rotZ": 0.0,
          "scaleX": 9.482673,
          "scaleY": 6.697391,
          "scaleZ": 3.55600476
        }
      },
      {
        "Color": "Green",
        "Transform": {
          "posX": -10.3242645,
          "posY": 5.2765255,
          "posZ": 28.6732559,
          "rotX": 0.0,
          "rotY": 180.0,
          "rotZ": 0.0,
          "scaleX": 9.482673,
          "scaleY": 6.6973877,
          "scaleZ": 3.55600476
        }
      },
      {
        "Color": "Pink",
        "Transform": {
          "posX": 28.5665646,
          "posY": 5.2765255,
          "posZ": -9.399705,
          "rotX": 0.0,
          "rotY": 270.0,
          "rotZ": 0.0,
          "scaleX": 9.498631,
          "scaleY": 6.6973877,
          "scaleZ": 3.564181
        }
      },
      {
        "Color": "Orange",
        "Transform": {
          "posX": -28.6021252,
          "posY": 5.2765255,
          "posZ": -9.672333,
          "rotX": 0.0,
          "rotY": 90.0,
          "rotZ": 0.0,
          "scaleX": 9.498631,
          "scaleY": 6.6973877,
          "scaleZ": 3.564181
        }
      }
    ]
  },
  "Turns": {
    "Enable": false,
    "Type": 0,
    "TurnOrder": [],
    "Reverse": false,
    "SkipEmpty": false,
    "DisableInteractions": false,
    "PassTurns": true,
    "TurnColor": ""
  },
  "ObjectStates": [
    {
      "Name": "Infinite_Bag",
      "Transform": {
        "posX": -29.2992535,
        "posY": 1.02375937,
        "posZ": -22.8372269,
        "rotX": -1.08845924E-07,
        "rotY": -1.07010692E-05,
        "rotZ": -8.487062E-08,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "Deckbag",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.444006383,
        "g": 0.009729978,
        "b": 0.303532928
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "MaterialIndex": -1,
      "MeshIndex": -1,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "ContainedObjects": [
        {
          "Name": "Bag",
          "Transform": {
            "posX": -28.7249336,
            "posY": 2.92652416,
            "posZ": -2.77763438,
            "rotX": 0.179550052,
            "rotY": 180.012955,
            "rotZ": 0.0957602039,
            "scaleX": 1.0,
            "scaleY": 1.0,
            "scaleZ": 1.0
          },
          "Nickname": "Deckbag",
          "Description": "",
          "ColorDiffuse": {
            "r": 0.128999934,
            "g": 0.694,
            "b": 0.606999934
          },
          "Locked": false,
          "Grid": true,
          "Snap": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "MaterialIndex": -1,
          "MeshIndex": -1,
          "Number": 0,
          "XmlUI": "",
          "LuaScript": "",
          "LuaScriptState": "",
          "GUID": "d503a6"
        }
      ],
      "GUID": "a47a8c"
    },
    {
      "Name": "Custom_Token",
      "Transform": {
        "posX": 0.0,
        "posY": 1.0,
        "posZ": 0.0,
        "rotX": 1.8656857E-07,
        "rotY": 0.000529817247,
        "rotZ": -1.71484672E-07,
        "scaleX": 2.17822933,
        "scaleY": 1.0,
        "scaleZ": 2.17822933
      },
      "Nickname": "Menu",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/194046562297265959/DDF30BEC93C7DB53EDBDB90A5575184476E57824/",
        "ImageSecondaryURL": "",
        "WidthScale": 0.0,
        "CustomToken": {
          "Thickness": 0.1,
          "MergeDistancePixels": 5.0,
          "Stackable": false
        }
      },
      "XmlUI": "",
      "LuaScript": "-- Modified by Rkik in 2018 for Transformers TCG.\r\n\r\nfunction onLoad()\r\n  math.randomseed(os.time())\r\n  -- Throw away a few numbers per the Lua documentation.  The first number may not be random.\r\n  math.random()\r\n  math.random()\r\n  math.random()\r\n\r\n  allExpansionLegendaries  = {}\r\n  allExpansionRares        = {}\r\n  allExpansionUncommons    = {}\r\n  allExpansionCommons      = {}\r\n\r\n  -- Awakenings, Spirit of Rebellion, Empire at War, Legacies\r\n  expansions               = { 'AW', 'SoR', 'EaW', 'LEG', 'WotF' }\r\n  numExpansions            = #expansions\r\n\r\n  draftOriginDeckZone      = nil\r\n  rivalsDummyCardGuid      = '72db11'\r\n  rivalsDummyCard          = getObjectFromGUID(rivalsDummyCardGuid)\r\n  rivalsDummyCard.setLock(true)\r\n  rivalsDummyCard.interactable = false\r\n  awakeningsCycleDeckGuid  = '60e044'\r\n  legaciesCycleDeckGuid    = '4e9040'\r\n  allCardsDeckGuid         = '9fdb61'\r\n  rivalsDeckZoneGuid       = '2410f1'\r\n  rivalsDeckGuid           = 'fd83c6'\r\n  cubeBoardGuid            = 'c51c41'\r\n  cubeDeckZoneGuid         = 'b9d302'\r\n  cubeBoard                = getObjectFromGUID(cubeBoardGuid)\r\n  cubeBoard.interactable   = false\r\n  cubeDeckZone             = getObjectFromGUID(cubeDeckZoneGuid)\r\n  cubeDeck                 = nil\r\n  cubeCompatibilityMode    = false\r\n  allCardsPulledDeck       = nil\r\n  packSelections           = { 'WotF', 'WotF', 'WotF', 'WotF', 'WotF', 'WotF', 'WotF', 'WotF' }\r\n  packSelectButtons        = nil\r\n  numPacksPerPlayer        = 6\r\n  rivalsExpansion          = nil\r\n  nextExpansionIndex       = {}\r\n  rivalsExpansionPacks     = {}\r\n\r\n  Global.setVar(\"rivalsDeckZoneGuid\", rivalsDeckZoneGuid)\r\n\r\n  setupBagGuid             = '771f25'\r\n\r\n  blueBoardsPrefab         = nil\r\n  redBoardsPrefab          = nil\r\n  blueResourceZone         = nil\r\n  blueBattlefieldZone      = nil\r\n  blueMatZone              = nil\r\n  redResourceZone          = nil\r\n  redBattlefieldZone       = nil\r\n  redMatZone               = nil\r\n\r\n  setupObject = getObjectFromGUID(setupBagGuid)\r\n\r\n  spawnditems              = {}\r\n  mainMenu()\r\n  affiliationselect        = 'Hero'\r\n  affiliationselect2       = 'villain'\r\n  affiliationselect3       = 'Neutral'\r\n  typeselect               = 'Character'\r\n  typeselect2              = 'Upgrade'\r\n  typeselect3              = 'Support'\r\n  typeselect4              = 'Event'\r\n  colorselect              = 'Red'\r\n  colorselect2             = 'Blue'\r\n  colorselect3             = 'Yellow'\r\n  colorselect4             = 'Gray'\r\n\r\n  -- Make the main menu GUI panel visible.\r\n  Global.UI.setAttribute(\"main_menu_panel\", \"active\", true)\r\n\r\n  red                      = nil\r\n  blue                     = nil\r\n  starterGame              = false\r\nend\r\n\r\n-- NOTE:  This function currently only supports Blue and Red players.\r\nfunction zoomCameraBackOut(playerColor)\r\n  if playerColor == \"Blue\" then\r\n    Player[playerColor].lookAt({ position={0,0,0}, pitch=62, yaw=180, distance=60})\r\n  elseif playerColor == \"Red\" then\r\n    Player[playerColor].lookAt({ position={0,0,0}, pitch=62, yaw=0, distance=60})\r\n  else\r\n    printToAll(\"Error, camera zoom out not supported for player color \" .. playerColor .. \".\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction twoPlayerModernFromGUI(player)\r\n  local seatedPlayers = getSeatedPlayers()\r\n  local numSeatedPlayers = 0\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    numSeatedPlayers = numSeatedPlayers + 1\r\n  end\r\n\r\n  if ((numSeatedPlayers == 1) or (numSeatedPlayers == 2)) then\r\n    twoPlayerModernGeneral(player)\r\n  else\r\n    printToAll(\"Error, two-player games must have 1 or 2 seated players.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction twoPlayerModernFromClassic(buttonObject, playerColor)\r\n  local seatedPlayers = getSeatedPlayers()\r\n  local numSeatedPlayers = 0\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    numSeatedPlayers = numSeatedPlayers + 1\r\n  end\r\n\r\n  if ((numSeatedPlayers == 1) or (numSeatedPlayers == 2)) then\r\n    -- Hide the classic menu board immediately.\r\n    self.setPosition({0,-4,0})\r\n\r\n    -- Zoom camera back out to the normal perspective for that player.\r\n    zoomCameraBackOut(playerColor)\r\n\r\n    -- Delay slightly so camera movement does not feel too sudden.\r\n    Wait.time(function() twoPlayerModernGeneral(Player[playerColor]) end, 0.2)\r\n  else\r\n    printToAll(\"Error, two-player games must have 1 or 2 seated players.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction twoPlayerModernGeneral(playerColor)\r\n  Global.setVar(\"mainMenuPanelOpen\", false)\r\n  Global.UI.setAttribute(\"main_menu_panel\", \"active\", false)\r\n\r\n  startLuaCoroutine(self, 'twoPlayerModernCoroutine')\r\nend\r\n\r\nfunction twoPlayerModernCoroutine()\r\n  -- Sleep briefly and start.\r\n  Wait.time(modernSetupAfterDelay, 0.1)\r\n\r\n  return 1\r\nend\r\n\r\nfunction modernSetupAfterDelay()\r\n  startLuaCoroutine(self, 'modernSetupCoroutine')\r\nend\r\n\r\nfunction modernSetupCoroutine()\r\n  local obj_parameters = {}\r\n  local seatData = Global.getTable(\"seatData\")\r\n\r\n  -- Destruct all draft mats.\r\n  local matObject\r\n  for i,someSeat in pairs(seatData) do\r\n    matObject = getObjectFromGUID(someSeat.matGuid)\r\n    if matObject != nil then\r\n      matObject.destruct()\r\n    end\r\n  end\r\n\r\n  -- Scale all hand zones down so they don't grab cards.\r\n  for i,someSeat in pairs(seatData) do\r\n    local handTransform = Player[i].getHandTransform()\r\n    handTransform.scale.x = 0.01\r\n    handTransform.scale.y = 0.01\r\n    handTransform.scale.z = 0.01\r\n    Player[i].setHandTransform(handTransform)\r\n  end\r\n\r\n  -- Adjust the red and blue hand zones to be usable.\r\n  local handTransform = Player[\"Red\"].getHandTransform()\r\n  handTransform.position.x = -1.70\r\n  handTransform.position.y = 4.60\r\n  handTransform.position.z = (-20.00)\r\n  handTransform.rotation.x = 0.00\r\n  handTransform.rotation.y = 0.00\r\n  handTransform.rotation.z = 0.00\r\n  handTransform.scale.x = 20.00\r\n  handTransform.scale.y = 5.65\r\n  handTransform.scale.z = 3.00\r\n  Player[\"Red\"].setHandTransform(handTransform)\r\n  handTransform = Player[\"Blue\"].getHandTransform()\r\n  handTransform.position.x = 1.70\r\n  handTransform.position.y = 4.60\r\n  handTransform.position.z = 20.00\r\n  handTransform.rotation.x = 0.00\r\n  handTransform.rotation.y = 180.00\r\n  handTransform.rotation.z = 0.00\r\n  handTransform.scale.x = 20.00\r\n  handTransform.scale.y = 5.65\r\n  handTransform.scale.z = 3.00\r\n  Player[\"Blue\"].setHandTransform(handTransform)\r\n\r\n  local seatedPlayers = getSeatedPlayers()\r\n  local numSeatedPlayers = 0\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    numSeatedPlayers = numSeatedPlayers + 1\r\n  end\r\n\r\n  if ((numSeatedPlayers == 1) or (numSeatedPlayers == 2)) then\r\n    local firstPlayerToAssign = nil\r\n    local secondPlayerToAssign = nil\r\n    local blueUsed = false\r\n    local redUsed = false\r\n    local colorChangeNeeded = false\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      if somePlayer == \"Blue\" then\r\n        blueUsed = true\r\n      elseif somePlayer == \"Red\" then\r\n        redUsed = true\r\n      else\r\n        if firstPlayerToAssign == nil then\r\n          firstPlayerToAssign = somePlayer\r\n          colorChangeNeeded = true\r\n        else\r\n          secondPlayerToAssign = somePlayer\r\n          colorChangeNeeded = true\r\n        end\r\n      end\r\n    end\r\n\r\n    -- If either or both players are not blue/red, change their color(s).\r\n\r\n    if firstPlayerToAssign != nil then\r\n      if blueUsed == false then\r\n        Player[firstPlayerToAssign].changeColor(\"Blue\")\r\n        blueUsed = true\r\n      else\r\n        -- If blue is used, then red must not be used, otherwise firstPlayerToAssign would be nil.\r\n        Player[firstPlayerToAssign].changeColor(\"Red\")\r\n        redUsed = true\r\n      end\r\n    end\r\n\r\n    if secondPlayerToAssign != nil then\r\n      -- If neither player was blue or red, the first player got assigned to blue, so this one should be red.\r\n      Player[secondPlayerToAssign].changeColor(\"Red\")\r\n      redUsed = true\r\n    end\r\n\r\n    if colorChangeNeeded == true then\r\n      printToAll(\"Two-player games only use the Blue and Red seats.\", {1,1,1})\r\n    end\r\n  else\r\n    printToAll(\"Error, two-player games must have 1 or 2 seated players.\", {1,0,0})\r\n\r\n    return 1\r\n  end\r\n\r\n  -- At this point, a normal game is considered to have started.\r\n  Global.call(\"handleNormalGameStarted\")\r\n\r\n  ---- Create a scripting zone for resources.\r\n  --obj_parameters.type = 'ScriptingTrigger'\r\n  --obj_parameters.position = {-23.00, -4.00, 0.32}\r\n  --obj_parameters.rotation = {0.00, 0.00, 0.00}\r\n  --obj_parameters.scale = {5.50, 5.10, 8.00}\r\n  --blueResourceZone = spawnObject(obj_parameters)\r\n  ---- Create a scripting zone for the battlefield.\r\n  --obj_parameters.type = 'ScriptingTrigger'\r\n  --obj_parameters.position = {-18.39, -4.00, 0.27}\r\n  --obj_parameters.rotation = {0.00, 0.00, 0.00}\r\n  --obj_parameters.scale = {4.60, 5.10, 3.40}\r\n  --blueBattlefieldZone = spawnObject(obj_parameters)\r\n  -- Create a scripting zone for the mat.\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.position = {4.82, -4.00, 10.20}\r\n  obj_parameters.rotation = {0.00, 0.00, 0.00}\r\n  obj_parameters.scale = {41.22, 1.00, 12.46}\r\n  blueMatZone = spawnObject(obj_parameters)\r\n\r\n  if Global.getVar(\"boardStyle\") == \"board_super_black\" then\r\n    blueBoardsPrefab = setupObject.takeObject({position={-20.85, -3.00, 10.05}, rotation={0,180,0}, guid=Global.getVar(\"blueBoardsBlackGuid\"), flip=false, smooth=false})\r\n  else\r\n    blueBoardsPrefab = setupObject.takeObject({position={-20.85, -3.00, 10.05}, rotation={0,180,0}, guid=Global.getVar(\"blueBoardsTransparentGuid\"), flip=false, smooth=false})\r\n  end\r\n  blueBoardsPrefab.use_gravity = false\r\n  blueBoardsPrefab.interactable = false\r\n  blueBoardsPrefab.setLock(true)\r\n  blueBoardsPrefab.setName(\"Blue\")\r\n  blueBoardsPrefab.tooltip = false\r\n  blueBoardsPrefab.setLuaScript(modernBoardsScript)\r\n  --blueBoardsPrefab.createButton({\r\n  --  click_function=\"blueClaimBattlefield\", function_owner=Global,\r\n  --  position={2.56, 0.14, 6.89}, width=1400, height=720, font_size=72, color={0,0,0,0}\r\n  --})\r\n\r\n  ---- Create a scripting zone for resources.\r\n  --obj_parameters.type = 'ScriptingTrigger'\r\n  --obj_parameters.position = {23.00, -4.00, -0.32}\r\n  --obj_parameters.rotation = {0.00, 0.00, 0.00}\r\n  --obj_parameters.scale = {5.50, 5.10, 8.00}\r\n  --redResourceZone = spawnObject(obj_parameters)\r\n  ---- Create a scripting zone for the battlefield.\r\n  --obj_parameters.type = 'ScriptingTrigger'\r\n  --obj_parameters.position = {18.39, -4.00, -0.27}\r\n  --obj_parameters.rotation = {0.00, 0.00, 0.00}\r\n  --obj_parameters.scale = {4.60, 5.10, 3.40}\r\n  --redBattlefieldZone = spawnObject(obj_parameters)\r\n  -- Create a scripting zone for the mat.\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.position = {-4.82, -4.00, -10.20}\r\n  obj_parameters.rotation = {0.00, 0.00, 0.00}\r\n  obj_parameters.scale = {41.22, 1.00, 12.46}\r\n  redMatZone = spawnObject(obj_parameters)\r\n\r\n  if Global.getVar(\"boardStyle\") == \"board_super_black\" then\r\n    redBoardsPrefab = setupObject.takeObject({position={20.85, -3.00, -10.05}, rotation={0,0,0}, guid=Global.getVar(\"redBoardsBlackGuid\"), flip=false, smooth=false})\r\n  else\r\n    redBoardsPrefab = setupObject.takeObject({position={20.85, -3.00, -10.05}, rotation={0,0,0}, guid=Global.getVar(\"redBoardsTransparentGuid\"), flip=false, smooth=false})\r\n  end\r\n  redBoardsPrefab.use_gravity = false\r\n  redBoardsPrefab.interactable = false\r\n  redBoardsPrefab.setLock(true)\r\n  redBoardsPrefab.setName(\"Red\")\r\n  redBoardsPrefab.tooltip = false\r\n  redBoardsPrefab.setLuaScript(modernBoardsScript)\r\n  --redBoardsPrefab.createButton({\r\n  --  click_function=\"redClaimBattlefield\", function_owner=Global,\r\n  --  position={2.56, 0.14, 6.89}, width=1400, height=720, font_size=72, color={0,0,0,0}\r\n  --})\r\n\r\n  coroutine.yield(0)\r\n  coroutine.yield(0)\r\n\r\n  Wait.time(movePlayerBoards, 0.5)\r\n\r\n  setupObject.destruct()\r\n  self.destruct()\r\n\r\n  --if starterGame == true then\r\n  --  startLuaCoroutine(self, 'spawnStarter')\r\n  --end\r\n\r\n  return 1\r\nend\r\n\r\n\r\nmodernBoardsScript = [=[\r\nfunction onload()\r\n  -- Load inside the script since global images do not work for players who join late.\r\n  local resourceAssets = {\r\n    {\r\n      name = \"ingame_gui_background\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/948454725666385380/A47369F346253BDE02F44153C4940D47AA0E6E67/\"\r\n    },\r\n    {\r\n      name = \"ingame_blue_panel_overlay\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/948454725666384731/E921F14A80CFA7C3BC20C7D7C61D7319443D0169/\"\r\n    },\r\n    {\r\n      name = \"ingame_red_panel_overlay\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/948454725666389779/69DCF9BD43E89F93351F7F2F8E87D5CFFD7E3EF7/\"\r\n    },\r\n    {\r\n      name = \"ingame_gui_maximize\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/948454725666387411/82FAD658AECC1F80A3413BEB32A2971FF168E4BF/\"\r\n    },\r\n    {\r\n      name = \"ingame_gui_shuffle\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/948454725666389375/842D3237A768D7171668FCD28264F81C30BFEE0D/\"\r\n    },\r\n    {\r\n      name = \"ingame_gui_discard\",\r\n      url = \"http://cloud-3.steamusercontent.com/ugc/948454725666386672/85210903AED7A7F638BA6784A45A042013DD28FC/\"\r\n    }\r\n  }\r\n  self.UI.setCustomAssets(resourceAssets)\r\n\r\n  tokenplayerone = Global.getTable('tokenplayerone')\r\n  tokenplayertwo = Global.getTable('tokenplayertwo')\r\n\r\n  if self.getName() == 'Blue' then\r\n    owner = 'Blue'\r\n  else\r\n    owner = 'Red'\r\n  end\r\n\r\n  if owner == 'Blue' then\r\n    self.UI.setXml([[\r\n<Panel\r\n   id=\"blue_panel\"\r\n   visibility=\"Blue\"\r\n   active=\"false\"\r\n   position=\"0 -300 -5\"\r\n   rotation=\"0 0 0\"\r\n   scale=\"5.46 5.46\"\r\n   rectAlignment=\"MiddleCenter\"\r\n   width=\"80\"\r\n   height=\"96\"\r\n   image=\"ingame_gui_background\"\r\n   raycastTarget=\"false\"\r\n>\r\n<Image\r\n   offsetXY=\"0 34\"\r\n   width=\"80\"\r\n   height=\"24\"\r\n   image=\"ingame_blue_panel_overlay\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n<Text\r\n   id=\"blue_panel_red_cards\"\r\n   scale=\"0.3 0.3\"\r\n   offsetXY=\"-6 39\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Text\r\n   id=\"blue_panel_blue_cards\"\r\n   scale=\"0.3 0.3\"\r\n   offsetXY=\"-6 29\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Button\r\n   offsetXY=\"30 56\"\r\n   width=\"10\"\r\n   height=\"10\"\r\n   onClick=\"Global/guiToggle\"\r\n   image=\"ingame_gui_maximize\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"-18 -28\"\r\n   width=\"28\"\r\n   height=\"28\"\r\n   onClick=\"Global/guiShuffle\"\r\n   image=\"ingame_gui_shuffle\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"18 -28\"\r\n   width=\"28\"\r\n   height=\"28\"\r\n   onClick=\"Global/guiDiscard\"\r\n   image=\"ingame_gui_discard\"\r\n   fontSize=\"32\"\r\n   textColor=\"#000000\"\r\n></Button>\r\n</Panel>\r\n]])\r\n  else\r\n    self.UI.setXml([[\r\n<Panel\r\n   id=\"red_panel\"\r\n   visibility=\"Red\"\r\n   active=\"false\"\r\n   position=\"0 -300 -5\"\r\n   rotation=\"0 0 0\"\r\n   scale=\"5.46 5.46\"\r\n   rectAlignment=\"MiddleCenter\"\r\n   width=\"80\"\r\n   height=\"96\"\r\n   image=\"ingame_gui_background\"\r\n   raycastTarget=\"false\"\r\n>\r\n<Image\r\n   offsetXY=\"0 34\"\r\n   width=\"80\"\r\n   height=\"24\"\r\n   image=\"ingame_red_panel_overlay\"\r\n   raycastTarget=\"false\"\r\n></Image>\r\n<Text\r\n   id=\"red_panel_blue_cards\"\r\n   scale=\"0.3 0.3\"\r\n   offsetXY=\"-6 39\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Text\r\n   id=\"red_panel_red_cards\"\r\n   scale=\"0.3 0.3\"\r\n   offsetXY=\"-6 29\"\r\n   fontStyle=\"Bold\"\r\n   fontSize=\"36\"\r\n   color=\"#FFFFFF\"\r\n>0</Text>\r\n<Button\r\n   offsetXY=\"30 56\"\r\n   width=\"10\"\r\n   height=\"10\"\r\n   onClick=\"Global/guiToggle\"\r\n   image=\"ingame_gui_maximize\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"-18 -28\"\r\n   width=\"28\"\r\n   height=\"28\"\r\n   onClick=\"Global/guiShuffle\"\r\n   image=\"ingame_gui_shuffle\"\r\n></Button>\r\n<Button\r\n   offsetXY=\"18 -28\"\r\n   width=\"28\"\r\n   height=\"28\"\r\n   onClick=\"Global/guiDiscard\"\r\n   image=\"ingame_gui_discard\"\r\n   fontSize=\"32\"\r\n   textColor=\"#000000\"\r\n></Button>\r\n</Panel>\r\n]])\r\n  end\r\n\r\n  resourceSpawnIndex = 0\r\n  discardCounter = 0\r\nend\r\n\r\n--function passButton()\r\n--  if owner == 'Blue' then\r\n--    broadcastToAll('Pass', {0.1,0.5,1.0})\r\n--  else\r\n--    broadcastToAll('Pass', {0.8,0.1,0.1})\r\n--  end\r\n--end\r\n\r\n--function resourceSpawned(newResource)\r\n--  newResource.setName(\"1 resource\")\r\n--  newResource.tooltip = false\r\n--end\r\n\r\n--function spawnResource()\r\n--  local zoneObject = nil\r\n--  local zonePosition = {}\r\n--  local spawnReference = {x=0, y=0, z=0}\r\n--  local obj_parameters = {}\r\n--  local custom = {}\r\n--  local token = nil\r\n--  local xFactor = 1\r\n--  local zFactor = 1\r\n--\r\n--  if owner == 'Blue' then\r\n--    zoneObject = Global.getVar(\"blueResourceZone\")\r\n--    if (zoneObject != nil) then\r\n--      zonePosition = zoneObject.getPosition()\r\n--      spawnReference = {x = (zonePosition.x + 1.54), y = (zonePosition.y - 1.00), z = (zonePosition.z + 1.29)}\r\n--    end\r\n--\r\n--    xFactor = (-1)\r\n--    zFactor = (-1)\r\n--  else\r\n--    zoneObject = Global.getVar(\"redResourceZone\")\r\n--    if (zoneObject != nil) then\r\n--      zonePosition = zoneObject.getPosition()\r\n--      spawnReference = {x = (zonePosition.x - 1.54), y = (zonePosition.y - 1.00), z = (zonePosition.z - 1.29)}\r\n--    end\r\n--\r\n--    xFactor = 1\r\n--    zFactor = 1\r\n--  end\r\n--\r\n--  obj_parameters.type = 'Custom_Token'\r\n--  obj_parameters.callback_function = resourceSpawned\r\n--  obj_parameters.position = {}\r\n--  obj_parameters.position.x = (spawnReference.x + (xFactor * (resourceSpawnIndex % 4)))\r\n--  obj_parameters.position.y = spawnReference.y\r\n--  obj_parameters.position.z = (spawnReference.z + (zFactor * math.floor(resourceSpawnIndex / 4)))\r\n--  obj_parameters.rotation = {0,0,0}\r\n--\r\n--  custom.image = tokenplayerone.resource\r\n--  custom.thickness = 0.1\r\n--  custom.merge_distance = 5.0\r\n--  custom.stackable = false\r\n--\r\n--  token = spawnObject(obj_parameters)\r\n--  token.setCustomObject(custom)\r\n--  token.scale {0.23, 1.00, 0.23}\r\n--\r\n--  resourceSpawnIndex = (resourceSpawnIndex + 1)\r\n--  if resourceSpawnIndex >= 20 then\r\n--    resourceSpawnIndex = 0\r\n--  end\r\n--end\r\n\r\nfunction randomDiscard()\r\n  local handObjects = Player[owner].getHandObjects()\r\n  local numHandObjects = #handObjects\r\n  local discardPosition = {}\r\n  local cardChoice = nil\r\n\r\n  if numHandObjects > 0 then\r\n    cardChoice = math.random(numHandObjects)\r\n\r\n    if owner == 'Blue' then\r\n      discardPosition.x = (-26.29)\r\n      discardPosition.y = 2.20\r\n      discardPosition.z = (6.59 + discardCounter)\r\n    else\r\n      discardPosition.x = 26.29\r\n      discardPosition.y = 2.20\r\n      discardPosition.z = ((-6.59) - discardCounter)\r\n    end\r\n\r\n    -- Teleport first to avoid the hand zone grabbing the card back.\r\n    handObjects[cardChoice].setPosition(discardPosition)\r\n    -- Now move fast with no collision using smooth motion so that the card will fall.\r\n    discardPosition.y = (discardPosition.y - 0.20)\r\n    handObjects[cardChoice].setPositionSmooth(discardPosition, false, true)\r\n\r\n    discardCounter = (discardCounter + 1)\r\n    if discardCounter >= 5 then\r\n      discardCounter = 0\r\n    end\r\n  end\r\nend\r\n\r\nfunction shuffleHand()\r\n  local handObjects = Player[owner].getHandObjects()\r\n  local numHandObjects = #handObjects\r\n  local cardPositions = {}\r\n\r\n  if numHandObjects > 0 then\r\n    for i, v in pairs(handObjects) do\r\n        cardPositions[i] = v.getPosition()\r\n    end\r\n    local handObjectsShuffled = shuffleTable(handObjects)\r\n    local cardPositionsShuffled = shuffleTable(cardPositions)\r\n    for i, v in pairs(handObjectsShuffled) do\r\n        v.setPosition(cardPositionsShuffled[i])\r\n    end\r\n  end\r\nend\r\n\r\nfunction shuffleTable(t)\r\n    for i = #t, 2, -1 do\r\n        local n = math.random(i)\r\n        t[i], t[n] = t[n], t[i]\r\n    end\r\n    return t\r\nend\r\n\r\nfunction onDrop(playerColor)\r\n  local objectPosition = self.getPosition()\r\n  local battlefieldZone = nil\r\n  local resourceZone = nil\r\n  local matZone = nil\r\n\r\n  -- Update zones to match the board position.\r\n\r\n  if (owner == 'Blue') then\r\n    battlefieldZone = Global.getVar(\"blueBattlefieldZone\")\r\n    resourceZone = Global.getVar(\"blueResourceZone\")\r\n    matZone = Global.getVar(\"blueMatZone\")\r\n\r\n    if battlefieldZone != nil then\r\n      battlefieldZone.setPosition({x = (objectPosition.x + 2.43), y = (objectPosition.y + 1.50), z = (objectPosition.z - 9.73)})\r\n    end\r\n\r\n    if resourceZone != nil then\r\n      resourceZone.setPosition({x = (objectPosition.x - 2.18), y = (objectPosition.y + 1.50), z = (objectPosition.z - 9.68)})\r\n    end\r\n\r\n    if matZone != nil then\r\n      matZone.setPosition({x = (objectPosition.x + 25.64), y = (objectPosition.y + 2.50), z = (objectPosition.z + 0.20)})\r\n    end\r\n  else\r\n    battlefieldZone = Global.getVar(\"redBattlefieldZone\")\r\n    resourceZone = Global.getVar(\"redResourceZone\")\r\n    matZone = Global.getVar(\"redMatZone\")\r\n\r\n    if battlefieldZone != nil then\r\n      battlefieldZone.setPosition({x = (objectPosition.x - 2.43), y = (objectPosition.y + 1.50), z = (objectPosition.z + 9.73)})\r\n    end\r\n\r\n    if resourceZone != nil then\r\n      resourceZone.setPosition({x = (objectPosition.x + 2.18), y = (objectPosition.y + 1.50), z = (objectPosition.z + 9.68)})\r\n    end\r\n\r\n    if matZone != nil then\r\n      matZone.setPosition({x = (objectPosition.x - 25.64), y = (objectPosition.y + 2.50), z = (objectPosition.z - 0.20)})\r\n    end\r\n  end\r\nend\r\n\r\nfunction handlePossibleDiceSpawn(params)\r\n  local position = self.getPosition()\r\n  local object = params.cardObject\r\n  local obj_parameters = {}\r\n  local custom = {}\r\n  obj_parameters.scale = {1.7,1.7,1.7}\r\n  obj_parameters.position = {object.getPosition()[1],object.getPosition()[2]+1,object.getPosition()[3]}\r\n  obj_parameters.rotation = {0,object.getRotation()[2]+180,0}\r\n\r\n  if ((object.getVar(\"spawned\") ~= true) and\r\n      (object.tag == 'Card') and\r\n      (Global.getVar(\"loadDelayFinished\") == true)) then\r\n    local isBotCard = false\r\n    local cardDescription = object.getDescription()\r\n    local cardDescriptionLength = 0\r\n    local testCardType = nil\r\n\r\n    print(cardDescription)\r\n\r\n    if cardDescription == 'Bot' then\r\n      isBotCard = true\r\n    end\r\n\r\n    -- For bot cards, create XML GUI\r\n    if (isBotCard == true) then\r\n      -- Since attaching the GUI directly to the card would cause the GUI to rotate when the card rotates, use a GUI holder object.\r\n      obj_parameters.type = 'BlockSquare'\r\n      obj_parameters.position = {object.getPosition()[1], 0.02, object.getPosition()[3]}\r\n      if (owner == 'Blue') then\r\n        obj_parameters.rotation = {0, 0, 0}\r\n      else\r\n        obj_parameters.rotation = {0, 180, 0}\r\n      end\r\n      obj_parameters.scale = {1, 1, 1}\r\n      obj_parameters.sound = false\r\n      -- Note that both the bot card and the GUI holder objects have scripts.\r\n      obj_parameters.callback_function = function(newObject) initGUIHolder(object, newObject) end\r\n\r\n      local cardGUIObject = spawnObject(obj_parameters)\r\n    end\r\n  else\r\n    local linkedGUIHolder = object.getVar(\"linkedGUIHolder\")\r\n\r\n    -- If a GUI holder was linked and hidden, show it.\r\n    if (linkedGUIHolder != nil) then\r\n      -- Update the position.\r\n      local cardPosition = object.getPosition()\r\n      linkedGUIHolder.setPosition({x = cardPosition.x, y = 0.02, z = cardPosition.z})\r\n\r\n      if (linkedGUIHolder.UI.getAttribute(\"card_gui\", \"active\") == \"False\") then\r\n        linkedGUIHolder.UI.setAttribute(\"card_gui\", \"active\", true)\r\n        linkedGUIHolder.UI.setAttribute(\"opponent_card_gui\", \"active\", true)\r\n\r\n        -- Update the visibility to match the prefab owner.\r\n        if (owner == 'Blue') then\r\n          linkedGUIHolder.setRotation({0, 0, 0})\r\n        else\r\n          linkedGUIHolder.setRotation({0, 180, 0})\r\n        end\r\n        linkedGUIHolder.UI.setAttribute(\"card_gui\", \"visibility\", owner)\r\n        if (owner == 'Blue') then\r\n          linkedGUIHolder.UI.setAttribute(\"opponent_card_gui\", \"visibility\", 'Red|Grey|Black')\r\n        else\r\n          linkedGUIHolder.UI.setAttribute(\"opponent_card_gui\", \"visibility\", 'Blue|Grey|Black')\r\n        end\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction initGUIHolder(cardObject, holderObject)\r\n  -- Set shield and damage values.\r\n  -- TODO is there a way to save/load variables on objects like this?\r\n  holderObject.setVar(\"shields\", 0)\r\n  holderObject.setVar(\"damage\", 0)\r\n  holderObject.setVar(\"owner\", owner)\r\n\r\n  holderObject.setLuaScript(Global.getVar(\"characterGUILuaScript\"))\r\n  Wait.time(function() finishInitGUIHolder(cardObject, holderObject) end, 0.2)\r\n\r\n  cardObject.setVar(\"linkedGUIHolder\", holderObject)\r\nend\r\n\r\nfunction finishInitGUIHolder(cardObject, holderObject)\r\n  holderObject.UI.setAttribute(\"card_gui\", \"visibility\", owner)\r\n  holderObject.UI.setAttribute(\"card_gui\", \"active\", true)\r\n  if (owner == 'Blue') then\r\n    holderObject.UI.setAttribute(\"opponent_card_gui\", \"visibility\", 'Red|Grey|Black')\r\n  else\r\n    holderObject.UI.setAttribute(\"opponent_card_gui\", \"visibility\", 'Blue|Grey|Black')\r\n  end\r\n  holderObject.UI.setAttribute(\"opponent_card_gui\", \"active\", true)\r\nend\r\n]=]\r\n\r\n\r\nfunction classicMenu(player)\r\n  Global.setVar(\"mainMenuPanelOpen\", false)\r\n  Global.UI.setAttribute(\"main_menu_panel\", \"active\", false)\r\n  player.lookAt({ position={0,0,0}, pitch=62, yaw=180, distance=20})\r\nend\r\n\r\nfunction clearSpawnedItems()\r\n  for i in ipairs(spawnditems) do\r\n    if getObjectFromGUID(spawnditems[i]) != nil then\r\n      getObjectFromGUID(spawnditems[i]).destruct()\r\n    end\r\n  end\r\n  spawnditems={}\r\nend\r\n\r\nfunction generatePacksAwakenings(buttonObject, playerColor)\r\n  generatePacks(playerColor, 'AW')\r\nend\r\n\r\nfunction generatePacksSpirit(buttonObject, playerColor)\r\n  generatePacks(playerColor, 'SoR')\r\nend\r\n\r\nfunction generatePacksEmpire(buttonObject, playerColor)\r\n  generatePacks(playerColor, 'EaW')\r\nend\r\n\r\nfunction generatePacksLegacies(buttonObject, playerColor)\r\n  generatePacks(playerColor, 'LEG')\r\nend\r\n\r\nfunction generatePacksWay(buttonObject, playerColor)\r\n  generatePacks(playerColor, 'WotF')\r\nend\r\n\r\nfunction generateMixedPacks(buttonObject, playerColor)\r\n  generatePacks(playerColor, 'Mixed')\r\nend\r\n\r\nfunction readyForRivals()\r\n  rivalsDummyCard.destruct()\r\n\r\n  startLuaCoroutine(self, 'spawnRivalsCards')\r\nend\r\n\r\nfunction draftReadyForDeal(oldAllCardsDeck)\r\n  local mixedPacksDeck = nil\r\n\r\n  -- If not cube drafting, destruct the old deck that had all Destiny cards in it.\r\n  if rivalsExpansion != 'Cube' then\r\n    oldAllCardsDeck.destruct()\r\n    oldAllCardsDeck = nil\r\n  end\r\n\r\n  -- Find the mixed packs deck and make it uninteractable.\r\n  local scriptZoneObjects = draftOriginDeckZone.getObjects()\r\n  for deckIndex,curDeck in ipairs(scriptZoneObjects) do\r\n    if curDeck.tag == \"Deck\" then\r\n      mixedPacksDeck = curDeck\r\n      mixedPacksDeck.interactable = false\r\n      mixedPacksDeck.setLock(true)\r\n      break\r\n    end\r\n  end\r\n\r\n  -- Make the table of pack selections available so the main game script can use it.\r\n  Global.setTable(\"packSelections\", packSelections)\r\n  -- Set up a table of expansion indices for dealing cards.\r\n  Global.setTable(\"nextExpansionIndex\", nextExpansionIndex)\r\n  -- Make the table of packs available so the main game script can use it.\r\n  Global.setTable(\"rivalsExpansionPacks\", rivalsExpansionPacks)\r\n  -- Set a reference to the deck so the main game script can use and destruct it.\r\n  Global.setVar(\"mixedPacksDeck\", mixedPacksDeck)\r\n  -- Set whether the cube compatibility mode is active.\r\n  Global.setVar(\"cubeCompatibilityMode\", cubeCompatibilityMode)\r\n\r\n  -- Deal cards.\r\n  printToAll(\"Dealing cards...\", {1,1,1})\r\n  Global.call(\"draftReadyForDeal\")\r\n\r\n  -- The menu is no longer needed.\r\n  self.destruct()\r\nend\r\n\r\nfunction draftZoneReady()\r\n  local databank = Global.getTable(\"cardstable\")\r\n  local rarity\r\n  local index\r\n  spawnd = 0\r\n  cardPulledCount = 0\r\n\r\n  -- Move the script zone for the draft origin deck.\r\n  draftOriginDeckZone.setPosition({6,2,-0.5})\r\n\r\n  if rivalsExpansion != 'Cube' then\r\n    -- Pull a deck that contains all draft/sealed cards.\r\n    setupObject.takeObject({position={6,2,6}, rotation={0,0,180}, guid=allCardsDeckGuid, flip=false, smooth=false, callback='allCardsDeckPulled', callback_owner=self})\r\n  else\r\n    -- For a cube, the deck is already available.\r\n    allCardsDeckPulled(cubeDeck)\r\n  end\r\nend\r\n\r\nfunction spawnRivalsCards()\r\n  coroutine.yield(0)\r\n\r\n  -- Pull the Rivals deck.\r\n  setupObject.takeObject({position={14,2.0,-0.9}, rotation={0,0,0}, guid=rivalsDeckGuid, flip=false, smooth=false})\r\n\r\n  -- Create a script zone for the dummy card plus the cube deck.  This is created under the table to avoid a white flash.\r\n  local obj_parameters = {}\r\n\r\n  obj_parameters.type = 'ScriptingTrigger'\r\n  obj_parameters.scale = { 5.0, 5.0, 6.0 }\r\n  obj_parameters.position = { 6.000,-4.000, 0.500 }\r\n  obj_parameters.rotation = { 0.000, 0.000, 0.000 }\r\n  draftOriginDeckZone = spawnObject(obj_parameters)\r\n\r\n  -- Sleep briefly to let the draft zone spawn.\r\n  Wait.time(draftZoneReady, 0.5)\r\n\r\n  return 1\r\nend\r\n\r\nfunction spawndb()\r\n  for i in ipairs(spawnditems) do\r\n    if getObjectFromGUID(spawnditems[i]) != nil then\r\n      getObjectFromGUID(spawnditems[i]).destruct()\r\n    end\r\n  end\r\n  spawnditems={}\r\n  startLuaCoroutine(self, 'spawnDeckbuilding')\r\nend\r\n\r\nfunction spawnDeckbuilding()\r\n  coroutine.yield(0)\r\n  local object = getObjectFromGUID('1cc719').clone({position={28,1,20}})\r\n  coroutine.yield(0)\r\n  --getObjectFromGUID('a47a8c').takeObject({position={28,1,-8}})\r\n  cards = {}\r\n  cards = object.getObjects()\r\n  spawnCards(cards,object)\r\n  return 1\r\nend\r\n\r\nfunction searchCardinDB(card)\r\n  local databank = Global.getTable(\"cardstable\")\r\n  for i in ipairs(databank) do\r\n    if databank[i][\"cardname\"] == card then\r\n      return i\r\n    end\r\n  end\r\n  return false\r\nend\r\n\r\nfunction spawnCards(cards,object)\r\n  local databank = Global.getTable(\"cardstable\")\r\n  spawnd = 1\r\n  height = 0\r\n  for i in ipairs(cards) do\r\n    index = searchCardinDB(cards[i].nickname)\r\n    if index != false then\r\n      if databank[index][\"affiliation\"] == affiliationselect or databank[index][\"affiliation\"] == affiliationselect2 or databank[index][\"affiliation\"] == affiliationselect3 then\r\n        if databank[index][\"type\"] == typeselect or databank[index][\"type\"] == typeselect2 or databank[index][\"type\"] == typeselect3 or databank[index][\"type\"] == typeselect4 then\r\n          if databank[index][\"color\"] == colorselect or databank[index][\"color\"] == colorselect2 or databank[index][\"color\"] == colorselect3 or databank[index][\"color\"] == colorselect4 then\r\n            if spawnd==164 then coroutine.yield(0) getObjectFromGUID(cards[i].guid).setPosition({27.5-((spawnd-150)*3.5),1,22.5}) table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({-27.5,1,24.5}) height=0 end\r\n            if spawnd<164 and spawnd>150 then object.takeObject({position={27.5-((spawnd-150)*3.5),1,22.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({-27.5,1,24.5}) height=0 end\r\n            if spawnd<151 and spawnd>135 then object.takeObject({position={27.5-((spawnd-135)*3.5),1,17.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,24.5}) height=1 end\r\n            if spawnd<136 and spawnd>120 then object.takeObject({position={27.5-((spawnd-120)*3.5),1,12.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,19.5}) height=2 end\r\n            if spawnd<121 and spawnd>105 then object.takeObject({position={27.5-((spawnd-105)*3.5),1,7.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,14.5}) height=3 end\r\n            if spawnd<106 and spawnd>90 then object.takeObject({position={27.5-((spawnd-90)*3.5),1,2.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,9.5}) height=4 end\r\n            if spawnd<91 and spawnd>75 then object.takeObject({position={27.5-((spawnd-75)*3.5),1,-2.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,4.5}) height=5  end\r\n            if spawnd<76 and spawnd>60 then object.takeObject({position={27.5-((spawnd-60)*3.5),1,-7.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,-0.5}) height=6 end\r\n            if spawnd<61 and spawnd>45 then object.takeObject({position={27.5-((spawnd-45)*3.5),1,-12.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,-5.5}) height=7 end\r\n            if spawnd<46 and spawnd>30 then object.takeObject({position={27.5-((spawnd-30)*3.5),1,-17.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,-10.5}) height=8 end\r\n            if spawnd<31 and spawnd>15 then object.takeObject({position={27.5-((spawnd-15)*3.5),1,-22.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,-15.5}) height=9 end\r\n            if spawnd<16 then object.takeObject({position={27.5-(spawnd*3.5),1,-27.5},guid=cards[i].guid}) spawnd=spawnd+1 table.insert(spawnditems, cards[i].guid) getObjectFromGUID('2a325b').setPosition({21.5,1,-20.5}) height=10  end\r\n          end\r\n        end\r\n      end\r\n    end\r\n\r\n\r\n  end\r\n\r\n  if battlefieldbutton == true then\r\n    local battlefield = getObjectFromGUID('cf8e15').clone({position={28,1,-1.5}})\r\n    battlefieldcards = battlefield.getObjects()\r\n    for i in ipairs (battlefieldcards) do\r\n      if i==10 then coroutine.yield(0) getObjectFromGUID(battlefieldcards[i].guid).setPosition({29-(i*5),1,27-(height*5)}) getObjectFromGUID(battlefieldcards[i].guid).setRotation({0,-90,0}) table.insert(spawnditems, battlefieldcards[i].guid) end\r\n      if i<10 then battlefield.takeObject({position={29-(i*5),1,27-(height*5)},rotation={0,-90,0},guid=battlefieldcards[i].guid}) table.insert(spawnditems, battlefieldcards[i].guid) if height != 0 then getObjectFromGUID('2a325b').setPosition({21.5,1,33.5-(height*5)}) end end\r\n    end\r\n    if battlefield != nil then battlefield.destruct() end\r\n  end\r\n  if object!= nil then object.destruct() end\r\nend\r\n\r\nfunction mainMenu()\r\n  self.clearButtons()\r\n  --self.createButton({\r\n  --  label='Starter Deck Game', click_function=\"setupStarter\", function_owner=self,\r\n  --  position={0,0.1,-0.3}, width=900, height=150, font_size=100\r\n  --})\r\n\r\n  self.createButton({\r\n    label='2 Player Modern', click_function=\"twoPlayerModernFromClassic\", function_owner=self,\r\n    position={0,0.1,0}, width=900, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='2 Player Classic', click_function=\"twoPlayerClassic\", function_owner=self,\r\n    position={0,0.1,0.3}, width=900, height=150, font_size=100\r\n  })\r\n\r\n  --self.createButton({\r\n  --  label='Normal Draft', click_function=\"setupDraftNormal\", function_owner=self,\r\n  --  position={0,0.1,0.6}, width=900, height=150, font_size=100\r\n  --})\r\n  --\r\n  --self.createButton({\r\n  --  label='Winchester Draft', click_function=\"setupDraftWinchester\", function_owner=self,\r\n  --  position={0,0.1,0.9}, width=900, height=150, font_size=100\r\n  --})\r\n  --\r\n  --self.createButton({\r\n  --  label='Cube Draft', click_function=\"setupDraftCube\", function_owner=self,\r\n  --  position={0,0.1,1.2}, width=900, height=150, font_size=100\r\n  --})\r\n  --\r\n  --self.createButton({\r\n  --  label='Sealed Game', click_function=\"setupSealed\", function_owner=self,\r\n  --  position={0,0.1,1.5}, width=900, height=150, font_size=100\r\n  --})\r\nend\r\n\r\nfunction setupStarter(buttonObject, playerColor)\r\n  -- Zoom camera back out to the normal perspective for that player.\r\n  zoomCameraBackOut(playerColor)\r\n\r\n  -- Delay slightly so camera movement does not feel too sudden.\r\n  Wait.time(function() setupStarterAfterDelay(playerColor) end, 0.2)\r\nend\r\n\r\nfunction setupStarterAfterDelay(playerColor)\r\n  red = 2\r\n  blue = 2\r\n  starterGame = true\r\n  startLuaCoroutine(self, 'spawnSetupCoroutine')\r\nend\r\n\r\nfunction spawnStarter()\r\n  setupObject.takeObject({position={11.9,2,-7.9},rotation={5,180,180},guid='086cb2'})\r\n  setupObject.takeObject({position={-11.9,2,7.9},rotation={5,360,180},guid='11ea1a'})\r\n  setupObject.takeObject({position={-2,2,8.4},guid='0a61f2'})\r\n  setupObject.takeObject({position={8.5,2,8.4},guid='5d54d1'})\r\n  setupObject.takeObject({position={2,2,-8.4},rotation={360,180,360},guid='ccf866'})\r\n  setupObject.takeObject({position={-8.5,2,-8.4},rotation={360,180,360},guid='48f820'})\r\n  setupObject.takeObject({position={-14,1,1.5}, rotation={360,270,360}, guid='05bfd4'})\r\n  setupObject.takeObject({position={14,1,-1.5}, rotation={360,90,360}, guid='499c42'})\r\n  setupObject.takeObject({position={-20,1,7.9}, rotation={360,0,360}, guid='5d3305'})\r\n  setupObject.takeObject({position={20,1,-7.9}, rotation={360,180,360}, guid='eafe7f'})\r\n  coroutine.yield(0)\r\n  coroutine.yield(0)\r\n  getObjectFromGUID('086cb2').shuffle()\r\n  getObjectFromGUID('11ea1a').shuffle()\r\n\r\n  return 1\r\nend\r\n\r\nfunction twoPlayerClassic(buttonObject, playerColor)\r\n  red = 0\r\n  blue = 0\r\n\r\n  self.clearButtons()\r\n\r\n  self.createButton({\r\n    label='Red: 1 Character',click_function=\"red1\",function_owner=self,\r\n    position={-0.9,0.1,-1.2},width = 800, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Red: 2 Characters',click_function=\"red2\",function_owner=self,\r\n    position={-0.9,0.1,-0.9},width = 800, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Red: 3 Characters',click_function=\"red3\",function_owner=self,\r\n    position={-0.9,0.1,-0.6},width = 800, height = 150, font_size = 90,\r\n  })\r\n\r\n  self.createButton({\r\n    label='Red: 4 Characters',click_function=\"red4\",function_owner=self,\r\n    position={-0.9,0.1,-0.3},width = 800, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Blue: 1 Character',click_function=\"blue1\",function_owner=self,\r\n    position={0.9,0.1,-1.2},width = 800, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Blue: 2 Characters',click_function=\"blue2\",function_owner=self,\r\n    position={0.9,0.1,-0.9},width = 800, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Blue: 3 Characters',click_function=\"blue3\",function_owner=self,\r\n    position={0.9,0.1,-0.6},width = 800, height = 150, font_size = 90,\r\n  })\r\n\r\n  self.createButton({\r\n    label='Blue: 4 Characters',click_function=\"blue4\",function_owner=self,\r\n    position={0.9,0.1,-0.3},width = 800, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Back',click_function=\"mainMenu\",function_owner=self,\r\n    position={1.3,0.1,1.5},width = 400, height = 150, font_size = 100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Spawn',click_function=\"spawnSetupButton\",function_owner=self,\r\n    position={-1.3,0.1,1.5},width = 400, height = 150, font_size = 100\r\n  })\r\nend\r\n\r\nfunction setupDraftNormal()\r\n  Global.setVar(\"rivalsMode\", \"Normal Draft\")\r\n  setupPacksMenu()\r\nend\r\n\r\nfunction setupDraftWinchester()\r\n  Global.setVar(\"rivalsMode\", \"Winchester Draft\")\r\n  setupPacksMenu()\r\nend\r\n\r\nfunction setupDraftCube()\r\n  Global.setVar(\"rivalsMode\", \"Cube Draft\")\r\n  setupCubeMenu()\r\nend\r\n\r\nfunction setupSealed()\r\n  Global.setVar(\"rivalsMode\", \"Normal Sealed\")\r\n  setupPacksMenu()\r\nend\r\n\r\nfunction setupCubeMenu()\r\n  -- Move the cube board and cube deck zone up.\r\n  cubeBoard.setPosition({-9.5,1,0})\r\n  cubeDeckZone.setPosition({-9.5,1,0})\r\n\r\n  self.clearButtons()\r\n\r\n  self.createButton({\r\n    label='Back',click_function=\"closeCubeMenu\",function_owner=self,\r\n    position={1.3,0.1,1.6},width = 400, height = 150, font_size = 100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Process Cube', click_function=\"processCube\", function_owner=self,\r\n    position={0,0.1,0}, width=1400, height=500, font_size=200\r\n  })\r\nend\r\n\r\nfunction closeCubeMenu()\r\n  -- Hide the cube board and cube deck zone.\r\n  cubeBoard.setPosition({-9.5,-4,0})\r\n  cubeDeckZone.setPosition({-9.5,-4,0})\r\n\r\n  mainMenu()\r\nend\r\n\r\nfunction processCube(buttonObject, playerColor)\r\n  -- Zoom camera back out to the normal perspective for that player.\r\n  zoomCameraBackOut(playerColor)\r\n\r\n  -- Delay slightly so camera movement does not feel too sudden.\r\n  Wait.time(function() processCubeAfterDelay(playerColor) end, 0.2)\r\nend\r\n\r\nfunction processCubeAfterDelay(playerColor)\r\n  -- Move player mats up before things start dropping on them.\r\n  Global.call(\"moveAllMatsUp\")\r\n\r\n  cubeDeck = nil\r\n  local scriptZoneObjects = cubeDeckZone.getObjects()\r\n  for i,curDeck in ipairs(scriptZoneObjects) do\r\n    if curDeck.tag == \"Deck\" then\r\n      cubeDeck = curDeck\r\n      break\r\n    end\r\n  end\r\n\r\n  -- Make sure the cube has enough cards.\r\n  if cubeDeck != nil then\r\n    local seatedPlayers = getSeatedPlayers()\r\n    local numSeatedPlayers = 0\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      numSeatedPlayers = numSeatedPlayers + 1\r\n    end\r\n\r\n    -- Each player will need 6 packs of 5 cards each.\r\n    local cubeCards = #(cubeDeck.getObjects())\r\n    local minCubeCards = (numSeatedPlayers * 6 * 5)\r\n    if cubeCards < minCubeCards then\r\n      printToAll(\"Error, for \" .. numSeatedPlayers .. \" player(s), the cube must contain at least \" .. minCubeCards .. \" cards.\", {1,0,0})\r\n      return\r\n    end\r\n  end\r\n\r\n  if cubeDeck != nil then\r\n    -- Spawn the \"please wait\" message board.\r\n    Global.call(\"showPleaseWait\")\r\n\r\n    -- Get the rotation of the cube deck.\r\n    cubeDeckRotation = cubeDeck.getRotation()\r\n\r\n    -- Flip the deck upside down if needed.\r\n    if ((cubeDeckRotation.z < 160) or (cubeDeckRotation.z > 200)) then\r\n      cubeDeck.setRotation({0, 0, 180})\r\n    end\r\n\r\n    -- Process the cube cards and create packs.\r\n    createCubePacks()\r\n\r\n    self.setPosition({0, -4, 0})\r\n\r\n    clearSpawnedItems()\r\n    rivalsExpansion = 'Cube'\r\n\r\n    -- Delete the cube board and cube deck zone.\r\n    cubeBoard.destruct()\r\n    cubeDeckZone.destruct()\r\n\r\n    -- Go ahead and move the dummy card so that other cards will fall on top of it.\r\n    -- The move is done with no collision, and it is done fast.  Also, clone the\r\n    -- dummy card, so that if the cube is dealt out entirely, what is left will\r\n    -- still be a deck.\r\n    rivalsDummyCard.setLock(false)\r\n    rivalsDummyCard.clone({position={6,6,-0.9}})\r\n    rivalsDummyCard.clone({position={6,7,-0.9}})\r\n    rivalsDummyCard.setLock(true)\r\n\r\n    Global.call(\"initBoards\")\r\n\r\n    -- The cube is moved after a small delay since otherwise it ends up crooked, probably because of the dummy cards.\r\n    Wait.time(handleCubeMove, 0.5)\r\n\r\n    printToAll(\"Processing cube...\", {1,1,1})\r\n  else\r\n    printToAll(\"Error, please put a deck in the cube zone.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction handleCubeMove()\r\n  -- To fix a strange bug where other people hosting the mod fail to move the cube deck, teleport it first.\r\n  local cubeDeckPosition = cubeDeck.getPosition()\r\n  cubeDeck.setPosition({x = cubeDeckPosition.x, y = (cubeDeckPosition.y + 4), z = cubeDeckPosition.z})\r\n\r\n  -- Move the cube without collision and move it fast.\r\n  cubeDeck.drag = 0.001\r\n  cubeDeck.angular_drag = 0.001\r\n  cubeDeck.dynamic_friction = 0.8\r\n  cubeDeck.bounciness = 0\r\n  cubeDeck.interactable = false\r\n  cubeDeck.setPositionSmooth({6,3,-0.9}, false, true)\r\n\r\n  Wait.time(readyForRivals, 1.0)\r\nend\r\n\r\nfunction createCubePacks()\r\n  local databank = Global.getTable(\"cardstable\")\r\n  local cubeObjects = cubeDeck.getObjects()\r\n\r\n  allExpansionLegendaries['Cube']   = {}\r\n  allExpansionRares['Cube']         = {}\r\n  allExpansionUncommons['Cube']     = {}\r\n  allExpansionCommons['Cube']       = {}\r\n\r\n  -- Process the cube to create lists of cards by rarity.\r\n  for cubeIndex,cubeCard in ipairs(cubeObjects) do\r\n    local cubeCardDescription = cubeCard.description\r\n\r\n    for index,curCard in ipairs(databank) do\r\n      local setAndNumber = (curCard[\"set\"] .. ' ' .. curCard[\"number\"])\r\n\r\n      if ((cubeCardDescription != nil) and (cubeCardDescription != '')) then\r\n        -- The new description format is used.\r\n        if (cubeCardDescription == setAndNumber) then\r\n          local rarity = curCard[\"rarity\"]\r\n\r\n          if \"Legendary\" == rarity then\r\n            table.insert(allExpansionLegendaries['Cube'], setAndNumber)\r\n          elseif \"Rare\" == rarity then\r\n            table.insert(allExpansionRares['Cube'], setAndNumber)\r\n          elseif \"Uncommon\" == rarity then\r\n            table.insert(allExpansionUncommons['Cube'], setAndNumber)\r\n          elseif \"Common\" == rarity then\r\n            table.insert(allExpansionCommons['Cube'], setAndNumber)\r\n          else\r\n            -- Nothing needs done.\r\n          end\r\n\r\n          break\r\n        end\r\n      else\r\n        -- The old name system is used.\r\n        cubeCompatibilityMode = true\r\n        if cubeCard.nickname == curCard[\"cardname\"] then\r\n          local rarity = curCard[\"rarity\"]\r\n\r\n          if \"Legendary\" == rarity then\r\n            table.insert(allExpansionLegendaries['Cube'], cubeCard.nickname)\r\n          elseif \"Rare\" == rarity then\r\n            table.insert(allExpansionRares['Cube'], cubeCard.nickname)\r\n          elseif \"Uncommon\" == rarity then\r\n              table.insert(allExpansionUncommons['Cube'], cubeCard.nickname)\r\n          elseif \"Common\" == rarity then\r\n            table.insert(allExpansionCommons['Cube'], cubeCard.nickname)\r\n          else\r\n            -- Nothing needs done.\r\n          end\r\n\r\n          break\r\n        end\r\n      end\r\n\r\n    end\r\n  end\r\n\r\n  local expansionDiceCards  = {}\r\n  local expansionUncommons  = {}\r\n  local expansionCommons    = {}\r\n\r\n  local diceCards          = {}\r\n  local uncommonCards      = {}\r\n  local commonCards        = {}\r\n\r\n  -- Combine the legendaries and rares.\r\n  local numLegendaries = #(allExpansionLegendaries['Cube'])\r\n  local numRares = #(allExpansionRares['Cube'])\r\n  for legendaryIndex=1,numLegendaries do\r\n    table.insert(diceCards, allExpansionLegendaries['Cube'][legendaryIndex])\r\n  end\r\n  for rareIndex=1,numRares do\r\n    table.insert(diceCards, allExpansionRares['Cube'][rareIndex])\r\n  end\r\n\r\n  -- Make a copy of the uncommon and common tables.\r\n  local numUncommons = #(allExpansionUncommons['Cube'])\r\n  local numCommons = #(allExpansionCommons['Cube'])\r\n  for uncommonIndex=1,numUncommons do\r\n    table.insert(uncommonCards, allExpansionUncommons['Cube'][uncommonIndex])\r\n  end\r\n  for commonIndex=1,numCommons do\r\n    table.insert(commonCards, allExpansionCommons['Cube'][commonIndex])\r\n  end\r\n\r\n  -- Randomize the dice cards.\r\n  local totalDiceCards = (numLegendaries + numRares)\r\n  local diceCardsLeftToRandomize = totalDiceCards\r\n  for i=1,totalDiceCards do\r\n    local randomIndex = math.random(1,diceCardsLeftToRandomize)\r\n    table.insert(expansionDiceCards, table.remove(diceCards, randomIndex))\r\n    diceCardsLeftToRandomize = diceCardsLeftToRandomize - 1\r\n  end\r\n\r\n  -- Randomize the uncommon cards.\r\n  local totalUncommonCards = #(allExpansionUncommons['Cube'])\r\n  local uncommonCardsLeftToRandomize = totalUncommonCards\r\n  for i=1,totalUncommonCards do\r\n    local randomIndex = math.random(1,uncommonCardsLeftToRandomize)\r\n    table.insert(expansionUncommons, table.remove(uncommonCards, randomIndex))\r\n    uncommonCardsLeftToRandomize = uncommonCardsLeftToRandomize - 1\r\n  end\r\n\r\n  -- Randomize the common cards.\r\n  local totalCommonCards = #(allExpansionCommons['Cube'])\r\n  local commonCardsLeftToRandomize = totalCommonCards\r\n  for i=1,totalCommonCards do\r\n    local randomIndex = math.random(1,commonCardsLeftToRandomize)\r\n    table.insert(expansionCommons, table.remove(commonCards, randomIndex))\r\n    commonCardsLeftToRandomize = commonCardsLeftToRandomize - 1\r\n  end\r\n\r\n  -- Determine how many packs can be created.  Note that this may require substituting commons for uncommons or similar.\r\n  local numCubePacks = math.floor((totalDiceCards + totalUncommonCards + totalCommonCards) / 5)\r\n\r\n  local numDiceCardsLeft   = totalDiceCards\r\n  local numUncommonsLeft   = totalUncommonCards\r\n  local numCommonsLeft     = totalCommonCards\r\n  local nextDiceCardIndex  = 1\r\n  local nextUncommonIndex  = 1\r\n  local nextCommonIndex    = 1\r\n\r\n  -- At this point, all cards have been processed and randomized, so packs can be created.\r\n  rivalsExpansionPacks['Cube'] = {}\r\n  nextExpansionIndex['Cube'] = 1\r\n  for packIndex = 1,numCubePacks do\r\n    -- The packs are created in reverse order so that dice cards end up on top of decks.\r\n    for cardIndex=1,3 do\r\n      if numCommonsLeft > 0 then\r\n        table.insert(rivalsExpansionPacks['Cube'], expansionCommons[nextCommonIndex])\r\n        nextCommonIndex = nextCommonIndex + 1\r\n        numCommonsLeft = numCommonsLeft - 1\r\n      elseif numUncommonsLeft > 0 then\r\n        -- Substitute uncommons for commons.\r\n        table.insert(rivalsExpansionPacks['Cube'], expansionUncommons[nextUncommonIndex])\r\n        nextUncommonIndex = nextUncommonIndex + 1\r\n        numUncommonsLeft = numUncommonsLeft - 1\r\n      elseif numDiceCardsLeft > 0 then\r\n        -- Substitute rares/legendaries for uncommons.\r\n        table.insert(rivalsExpansionPacks['Cube'], expansionDiceCards[nextDiceCardIndex])\r\n        nextDiceCardIndex = nextDiceCardIndex + 1\r\n        numDiceCardsLeft = numDiceCardsLeft - 1\r\n      else\r\n        printToAll(\"Error, not enough cards in cube.\", {1,0,0})\r\n        Global.call(\"cleanupTable\")\r\n        return\r\n      end\r\n    end\r\n\r\n    if numUncommonsLeft > 0 then\r\n      table.insert(rivalsExpansionPacks['Cube'], expansionUncommons[nextUncommonIndex])\r\n      nextUncommonIndex = nextUncommonIndex + 1\r\n      numUncommonsLeft = numUncommonsLeft - 1\r\n    elseif numCommonsLeft > 0 then\r\n      -- Substitute commons for uncommons.\r\n      table.insert(rivalsExpansionPacks['Cube'], expansionCommons[nextCommonIndex])\r\n      nextCommonIndex = nextCommonIndex + 1\r\n      numCommonsLeft = numCommonsLeft - 1\r\n    elseif numDiceCardsLeft > 0 then\r\n      -- Substitute rares/legendaries for commons.\r\n      table.insert(rivalsExpansionPacks['Cube'], expansionDiceCards[nextDiceCardIndex])\r\n      nextDiceCardIndex = nextDiceCardIndex + 1\r\n      numDiceCardsLeft = numDiceCardsLeft - 1\r\n    else\r\n      printToAll(\"Error, not enough cards in cube.\", {1,0,0})\r\n      Global.call(\"cleanupTable\")\r\n      return\r\n    end\r\n\r\n    if numDiceCardsLeft > 0 then\r\n      table.insert(rivalsExpansionPacks['Cube'], expansionDiceCards[nextDiceCardIndex])\r\n      nextDiceCardIndex = nextDiceCardIndex + 1\r\n      numDiceCardsLeft = numDiceCardsLeft - 1\r\n    elseif numUncommonsLeft > 0 then\r\n      -- Substitute uncommons for rares/legendaries.\r\n      table.insert(rivalsExpansionPacks['Cube'], expansionUncommons[nextUncommonIndex])\r\n      nextUncommonIndex = nextUncommonIndex + 1\r\n      numUncommonsLeft = numUncommonsLeft - 1\r\n    elseif numCommonsLeft > 0 then\r\n      -- Substitute commons for uncommons.\r\n      table.insert(rivalsExpansionPacks['Cube'], expansionCommons[nextCommonIndex])\r\n      nextCommonIndex = nextCommonIndex + 1\r\n      numCommonsLeft = numCommonsLeft - 1\r\n    else\r\n      printToAll(\"Error, not enough cards in cube.\", {1,0,0})\r\n      Global.call(\"cleanupTable\")\r\n      return\r\n    end\r\n  end\r\nend\r\n\r\nfunction setupPacksMenu()\r\n  local rivalsMode = Global.getVar(\"rivalsMode\")\r\n\r\n  if rivalsMode == \"Winchester Draft\" then\r\n    numPacksPerPlayer = 8\r\n  elseif rivalsMode == \"Normal Sealed\" then\r\n    numPacksPerPlayer = 8\r\n  else\r\n    numPacksPerPlayer = 6\r\n  end\r\n\r\n  packSelectButtons = nil\r\n\r\n  self.clearButtons()\r\n\r\n  self.createButton({\r\n    label='Back',click_function=\"mainMenu\",function_owner=self,\r\n    position={1.3,0.1,1.6},width = 400, height = 150, font_size = 100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Awakenings', click_function=\"generatePacksAwakenings\", function_owner=self,\r\n    position={0,0.1,-0.9}, width=1100, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Spirit of Rebellion',click_function=\"generatePacksSpirit\",function_owner=self,\r\n    position={0,0.1,-0.6}, width=1100, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Empire at War',click_function=\"generatePacksEmpire\",function_owner=self,\r\n    position={0,0.1,-0.3}, width=1100, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Legacies',click_function=\"generatePacksLegacies\",function_owner=self,\r\n    position={0,0.1,0}, width=1100, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Way of the Force',click_function=\"generatePacksWay\",function_owner=self,\r\n    position={0,0.1,0.3}, width=1100, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Mix Expansions',click_function=\"mixExpansionsMenu\",function_owner=self,\r\n    position={0,0.1,0.9}, width=1100, height=150, font_size=100\r\n  })\r\nend\r\n\r\nfunction mixExpansionsMenu()\r\n  local offsetX = (-1.4)\r\n  local offsetY = (0.1)\r\n  local offsetZ = (-1.2)\r\n\r\n  self.clearButtons()\r\n\r\n  -- Create buttons for each expansion.\r\n  for i=1,numPacksPerPlayer do\r\n    self.createButton({\r\n      label='AW', click_function=\"packAW\"..i, function_owner=self,\r\n      position={ offsetX + 0.0, offsetY, (offsetZ + (i*0.3)) }, width=320, height=150, font_size=100, color={0,0,0}, font_color={1,1,1}\r\n    })\r\n\r\n    self.createButton({\r\n      label='SoR',click_function=\"packSoR\"..i,function_owner=self,\r\n      position={ offsetX + 0.7, offsetY, (offsetZ + (i*0.3)) }, width=320, height=150, font_size=100, color={0,0,0}, font_color={1,1,1}\r\n    })\r\n\r\n    self.createButton({\r\n      label='EaW',click_function=\"packEaW\"..i,function_owner=self,\r\n      position={ offsetX + 1.4, offsetY, (offsetZ + (i*0.3)) }, width=320, height=150, font_size=100, color={0,0,0}, font_color={1,1,1}\r\n    })\r\n\r\n    self.createButton({\r\n      label='LEG',click_function=\"packLEG\"..i,function_owner=self,\r\n      position={ offsetX + 2.1, offsetY, (offsetZ + (i*0.3)) }, width=320, height=150, font_size=100, color={0,0,0}, font_color={1,1,1}\r\n    })\r\n\r\n    self.createButton({\r\n      label='WotF',click_function=\"packWotF\"..i,function_owner=self,\r\n      position={ offsetX + 2.8, offsetY, (offsetZ + (i*0.3)) }, width=320, height=150, font_size=100, color={1,1,1}, font_color={0,0,0}\r\n    })\r\n  end\r\n\r\n  -- Create buttons that just act as labels.\r\n  for i=1,numPacksPerPlayer do\r\n    self.createButton({\r\n      label=i, click_function=\"doNothing\", function_owner=self,\r\n      position={-2.0, 0.1, ((-1.2)+(i*0.3))}, width=0, height=0, font_size=100, color={0,0,0}, font_color={1,1,1}\r\n    })\r\n  end\r\n\r\n  self.createButton({\r\n    label='Play',click_function=\"generateMixedPacks\",function_owner=self,\r\n    position={-1.3,0.1,1.7}, width=400, height=150, font_size=100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Back',click_function=\"setupPacksMenu\",function_owner=self,\r\n    position={1.3,0.1,1.7}, width=400, height=150, font_size=100\r\n  })\r\n\r\n  -- Get all the buttons for quick access later.\r\n  packSelectButtons = self.getButtons()\r\nend\r\n\r\nfunction doNothing()\r\nend\r\n\r\nfunction generatePacks(playerColor, expansion)\r\n  -- Zoom camera back out to the normal perspective for that player.\r\n  zoomCameraBackOut(playerColor)\r\n\r\n  -- Move player mats up before things start dropping on them.\r\n  Global.call(\"moveAllMatsUp\")\r\n\r\n  local rivalsMode = Global.getVar(\"rivalsMode\")\r\n\r\n  -- Lock and make the decks uninteractable so players cannot cheat.  Also move them into the sky so no one can see them.\r\n  -- Move them to the side so they do not cause a reflection on the table.\r\n  -- It is important to keep them loaded, because otherwise when cards start getting pulled for dealing, huge loading\r\n  -- delays can result that may break draft timing.\r\n  local deckToLock = nil\r\n  local oldPosition = nil\r\n\r\n  deckToLock = getObjectFromGUID(awakeningsCycleDeckGuid)\r\n  if deckToLock != nil then\r\n    deckToLock.locked = true\r\n    deckToLock.interactable = false\r\n    oldPosition = deckToLock.getPosition()\r\n    deckToLock.setPosition({(oldPosition.x - 10), (oldPosition.y + 160), oldPosition.z})\r\n  end\r\n\r\n  deckToLock = getObjectFromGUID(legaciesCycleDeckGuid)\r\n  if deckToLock != nil then\r\n    deckToLock.locked = true\r\n    deckToLock.interactable = false\r\n    oldPosition = deckToLock.getPosition()\r\n    deckToLock.setPosition({(oldPosition.x - 10), (oldPosition.y + 160), oldPosition.z})\r\n  end\r\n\r\n  -- Sanity check player count before starting Winchester mode.\r\n  if rivalsMode == \"Winchester Draft\" then\r\n    local seatedPlayers = getSeatedPlayers()\r\n    local numSeatedPlayers = 0\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      numSeatedPlayers = numSeatedPlayers + 1\r\n    end\r\n\r\n    if ((numSeatedPlayers == 1) or (numSeatedPlayers == 2)) then\r\n      local firstPlayerToAssign = nil\r\n      local secondPlayerToAssign = nil\r\n      local blueUsed = false\r\n      local greenUsed = false\r\n      local colorChangeNeeded = false\r\n      for i,somePlayer in pairs(seatedPlayers) do\r\n        if somePlayer == \"Blue\" then\r\n          blueUsed = true\r\n        elseif somePlayer == \"Green\" then\r\n          greenUsed = true\r\n        else\r\n          if firstPlayerToAssign == nil then\r\n            firstPlayerToAssign = somePlayer\r\n            colorChangeNeeded = true\r\n          else\r\n            secondPlayerToAssign = somePlayer\r\n            colorChangeNeeded = true\r\n          end\r\n        end\r\n      end\r\n\r\n      -- If either or both players are not blue/green, change their color(s).\r\n\r\n      if firstPlayerToAssign != nil then\r\n        if blueUsed == false then\r\n          Player[firstPlayerToAssign].changeColor(\"Blue\")\r\n          blueUsed = true\r\n        else\r\n          -- If blue is used, then green must not be used, otherwise firstPlayerToAssign would be nil.\r\n          Player[firstPlayerToAssign].changeColor(\"Green\")\r\n          greenUsed = true\r\n        end\r\n      end\r\n\r\n      if secondPlayerToAssign != nil then\r\n        -- If neither player was blue or green, the first player got assigned to blue, so this one should be green.\r\n        Player[secondPlayerToAssign].changeColor(\"Green\")\r\n        greenUsed = true\r\n      end\r\n\r\n      if colorChangeNeeded == true then\r\n        printToAll(\"Winchester draft only uses the Blue and Green seats.\", {1,1,1})\r\n      end\r\n    else\r\n      printToAll(\"Error, Winchester draft only supports 2 seated players.\", {1,0,0})\r\n\r\n      return\r\n    end\r\n  end\r\n\r\n  self.setPosition({0, -4, 0})\r\n  clearSpawnedItems()\r\n  rivalsExpansion = expansion\r\n\r\n  -- Spawn the \"please wait\" message board.\r\n  Global.call(\"showPleaseWait\")\r\n\r\n  -- Report progress.\r\n  printToAll(\"Preparing to generate expansion cards...\", {1,1,1})\r\n\r\n  -- Spawn boards and get ready to continue setup.\r\n  Global.call(\"initBoards\")\r\n  Wait.time(readyForRivals, 1.0)\r\nend\r\n\r\nfunction generateBoxes()\r\n  printToAll(\"Generating boxes...\", {1,1,1})\r\n\r\n  -- Generate 6 legendaries and 30 rares for each box.\r\n  for i,curExpansion in pairs(expansions) do\r\n    local expansionDiceCards  = {}\r\n    local expansionUncommons  = {}\r\n    local expansionCommons    = {}\r\n\r\n    for boxIndex=1,2 do\r\n      local boxDiceCards = {}\r\n      local randomIndex = 1\r\n      local numBoxLegendaries = 0\r\n\r\n      -- Prevent duplicate legendaries inside a box.\r\n      for legendaryIndex=1,6 do\r\n        local isDuplicate = true\r\n        while isDuplicate == true do\r\n          randomIndex = math.random(1, #(allExpansionLegendaries[curExpansion]))\r\n          isDuplicate = false\r\n          for previousLegendaryIndex=1,numBoxLegendaries do\r\n            if allExpansionLegendaries[curExpansion][randomIndex] == boxDiceCards[previousLegendaryIndex] then\r\n              isDuplicate = true\r\n            end\r\n          end\r\n        end\r\n        table.insert(boxDiceCards, allExpansionLegendaries[curExpansion][randomIndex])\r\n        numBoxLegendaries = numBoxLegendaries + 1\r\n      end\r\n\r\n      -- Rares can have duplicates inside a box.\r\n      for rareIndex=1,30 do\r\n        randomIndex = math.random(1, #(allExpansionRares[curExpansion]))\r\n        table.insert(boxDiceCards, allExpansionRares[curExpansion][randomIndex])\r\n      end\r\n\r\n      -- At this point, there are 36 dice cards that need randomized.\r\n      local diceCardsLeftToRandomize = 36\r\n      for i=1,36 do\r\n        randomIndex = math.random(1,diceCardsLeftToRandomize)\r\n        table.insert(expansionDiceCards, table.remove(boxDiceCards, randomIndex))\r\n        diceCardsLeftToRandomize = diceCardsLeftToRandomize - 1\r\n      end\r\n\r\n      -- Uncommons can have duplicates inside a box.\r\n      for uncommonIndex=1,36 do\r\n        randomIndex = math.random(1, #(allExpansionUncommons[curExpansion]))\r\n        table.insert(expansionUncommons, allExpansionUncommons[curExpansion][randomIndex])\r\n      end\r\n\r\n      -- Commons can have duplicates inside a box.\r\n      for commonIndex=1,108 do\r\n        randomIndex = math.random(1, #(allExpansionCommons[curExpansion]))\r\n        table.insert(expansionCommons, allExpansionCommons[curExpansion][randomIndex])\r\n      end\r\n    end\r\n\r\n    -- At this point, 2 boxes have been generated for the current expansion.  All 72 packs can now be saved.\r\n    local nextDiceCardIndex = 1\r\n    local nextUncommonIndex = 1\r\n    local nextCommonIndex = 1\r\n    nextExpansionIndex[curExpansion] = 1\r\n    rivalsExpansionPacks[curExpansion] = {}\r\n    for packIndex = 1,72 do\r\n      -- The packs are created in reverse order so that dice cards end up on top of decks.\r\n      table.insert(rivalsExpansionPacks[curExpansion], expansionCommons[nextCommonIndex])\r\n      nextCommonIndex = nextCommonIndex + 1\r\n      table.insert(rivalsExpansionPacks[curExpansion], expansionCommons[nextCommonIndex])\r\n      nextCommonIndex = nextCommonIndex + 1\r\n      table.insert(rivalsExpansionPacks[curExpansion], expansionCommons[nextCommonIndex])\r\n      nextCommonIndex = nextCommonIndex + 1\r\n\r\n      table.insert(rivalsExpansionPacks[curExpansion], expansionUncommons[nextUncommonIndex])\r\n      nextUncommonIndex = nextUncommonIndex + 1\r\n\r\n      table.insert(rivalsExpansionPacks[curExpansion], expansionDiceCards[nextDiceCardIndex])\r\n      nextDiceCardIndex = nextDiceCardIndex + 1\r\n    end\r\n  end\r\nend\r\n\r\nfunction allCardsDeckPulled(deck)\r\n  allCardsPulledDeck = deck\r\n  startLuaCoroutine(self, 'allCardsDeckPulledCoroutine')\r\nend\r\n\r\nfunction allCardsDeckPulledCoroutine()\r\n  local deck = allCardsPulledDeck\r\n  local rivalsMode = Global.getVar(\"rivalsMode\")\r\n\r\n  local expansionPacksNeeded     = {}\r\n  local sortedPullCards          = {}\r\n  local numCardsPulled           = 0\r\n\r\n  for i,curExpansion in pairs(expansions) do\r\n    expansionPacksNeeded[curExpansion]    = 0\r\n    allExpansionLegendaries[curExpansion] = {}\r\n    allExpansionRares[curExpansion]       = {}\r\n    allExpansionUncommons[curExpansion]   = {}\r\n    allExpansionCommons[curExpansion]     = {}\r\n    sortedPullCards[curExpansion]         = {}\r\n  end\r\n\r\n  -- Set up local cube variables as well.\r\n  expansionPacksNeeded['Cube']          = 0\r\n  sortedPullCards['Cube']               = {}\r\n\r\n  if (rivalsExpansion != 'Mixed') then\r\n    -- Set all pack selections to the same expansion.\r\n    for i=1,numPacksPerPlayer do\r\n      packSelections[i] = rivalsExpansion\r\n    end\r\n  end\r\n\r\n  -- Determine how many cards from each expansion are needed.\r\n  for i=1,numPacksPerPlayer do\r\n    expansionPacksNeeded[packSelections[i]] = expansionPacksNeeded[packSelections[i]]+1\r\n  end\r\n\r\n  -- Generate tables for cards in each expansion.\r\n  local databank = Global.getTable(\"cardstable\")\r\n  for index,curCard in ipairs(databank) do\r\n    local cardSet = curCard[\"set\"]\r\n    local rarity = curCard[\"rarity\"]\r\n\r\n    if \"Legendary\" == rarity then\r\n      table.insert(allExpansionLegendaries[cardSet], curCard[\"set\"] .. ' ' .. curCard[\"number\"])\r\n    elseif \"Rare\" == rarity then\r\n      table.insert(allExpansionRares[cardSet], curCard[\"set\"] .. ' ' .. curCard[\"number\"])\r\n    elseif \"Uncommon\" == rarity then\r\n      table.insert(allExpansionUncommons[cardSet], curCard[\"set\"] .. ' ' .. curCard[\"number\"])\r\n    elseif \"Common\" == rarity then\r\n      table.insert(allExpansionCommons[cardSet], curCard[\"set\"] .. ' ' .. curCard[\"number\"])\r\n    else\r\n      -- Nothing needs done.\r\n    end\r\n  end\r\n\r\n  local seatedPlayers = getSeatedPlayers()\r\n  local numSeatedPlayers = 0\r\n  for playerIndex,somePlayer in pairs(seatedPlayers) do\r\n    numSeatedPlayers = numSeatedPlayers + 1\r\n  end\r\n\r\n  -- Generate 2 boxes for each expansion.\r\n  generateBoxes()\r\n\r\n  printToAll(\"Preparing to pull cards...\", {1,1,1})\r\n\r\n  coroutine.yield(0)\r\n\r\n  for expansionIndex,curExpansion in pairs(expansions) do\r\n    local numPacksToPull = (numSeatedPlayers*expansionPacksNeeded[curExpansion])\r\n\r\n    local cardIndex = 1\r\n    for packIndex=1,numPacksToPull do\r\n      -- Insert a pack at a time.\r\n      for i=1,5 do\r\n        table.insert(sortedPullCards[curExpansion], rivalsExpansionPacks[curExpansion][cardIndex])\r\n        cardIndex = cardIndex + 1\r\n      end\r\n    end\r\n\r\n    -- Sort the pull list.\r\n    table.sort(sortedPullCards[curExpansion])\r\n\r\n    -- Pull cards in the sorted pull list.\r\n    local numPullCards = #(sortedPullCards[curExpansion])\r\n    local cloneCard = nil\r\n    local lastNameOrDescription = nil\r\n    if numPullCards >= 1 then\r\n      for cardIndex=1,numPullCards do\r\n        if sortedPullCards[curExpansion][cardIndex] == lastNameOrDescription then\r\n          -- This is the same as the last card.  Clone it.\r\n          local cloneCardY = cloneCard.getPosition().y\r\n          local newCard = cloneCard.clone({position={6, (2 + (numCardsPulled * 0.05)) - cloneCardY, (-0.9)}})\r\n          newCard.locked = false\r\n          newCard.interactable = true\r\n          newCard.drag = 0.001\r\n          newCard.angular_drag = 0.001\r\n          newCard.dynamic_friction = 0.8\r\n          newCard.bounciness = 0\r\n\r\n          numCardsPulled = numCardsPulled + 1\r\n        else\r\n          -- This is a new card.  Delete the last card, pull the new one, and then clone it.\r\n          if cloneCard != nil then\r\n            cloneCard.destruct()\r\n          end\r\n\r\n          -- Find the GUID of the card.\r\n          local deckObjects = deck.getObjects()\r\n          local cardFound = false\r\n          for checkIndex,curCard in ipairs(deckObjects) do\r\n            if curCard.description == sortedPullCards[curExpansion][cardIndex] then\r\n              cardFound = true\r\n              local pullGuid = curCard.guid\r\n              if cubeCompatibilityMode == true then\r\n                lastNameOrDescription = curCard.nickname\r\n              else\r\n                lastNameOrDescription = curCard.description\r\n              end\r\n              cloneCard = deck.takeObject({position={200,1,200}, rotation={0,0,180}, guid=pullGuid, flip=false, smooth=false})\r\n              cloneCard.locked = true\r\n              cloneCard.interactable = false\r\n              cloneCard.drag = 0.001\r\n              cloneCard.angular_drag = 0.001\r\n              cloneCard.dynamic_friction = 0.8\r\n              cloneCard.bounciness = 0\r\n\r\n              local cloneCardY = cloneCard.getPosition().y\r\n              local newCard = cloneCard.clone({position={6, (2 + (numCardsPulled * 0.05)) - cloneCardY, (-0.9)}})\r\n              newCard.locked = false\r\n              newCard.interactable = true\r\n              newCard.drag = 0.001\r\n              newCard.angular_drag = 0.001\r\n              newCard.dynamic_friction = 0.8\r\n              newCard.bounciness = 0\r\n\r\n              numCardsPulled = numCardsPulled + 1\r\n              break\r\n            end\r\n          end\r\n\r\n          if cardFound == false then\r\n            -- This should never happen.\r\n            printToAll(\"Error, card \\\"\" .. sortedPullCards[curExpansion][cardIndex] .. \"\\\" not found.\", {1,0,0})\r\n          end\r\n        end\r\n\r\n        -- Occasionally yield so the game does not freeze too much.\r\n        if ((numCardsPulled % 20) == 0) then\r\n          coroutine.yield(0)\r\n        end\r\n      end\r\n\r\n      if cloneCard != nil then\r\n        cloneCard.destruct()\r\n        cloneCard = nil\r\n      end\r\n    end\r\n  end\r\n\r\n  -- Add dummy cards so that once the deck is empty of useful cards, it will still be a \"deck\", and can be deleted.\r\n  -- Only do this for non-cube decks, since cube decks might not have enough spare cards.\r\n  if rivalsExpansion != 'Cube' then\r\n    deck.takeObject({position={6, 3 + (numCardsPulled * 0.1), (-0.9)}, rotation={0,0,180}, flip=false, smooth=false})\r\n    deck.takeObject({position={6, 3.1 + (numCardsPulled * 0.1), (-0.9)}, rotation={0,0,180}, flip=false, smooth=false})\r\n  end\r\n\r\n  -- Clone the Rivals deck for all players.\r\n  local scriptZoneObjects = getObjectFromGUID(rivalsDeckZoneGuid).getObjects()\r\n  local rivalsDeck = nil\r\n  for i,curDeck in ipairs(scriptZoneObjects) do\r\n    if curDeck.tag == \"Deck\" then\r\n      rivalsDeck = curDeck\r\n      break\r\n    end\r\n  end\r\n\r\n  if rivalsDeck != nil then\r\n    local seatData = Global.getTable(\"seatData\")\r\n\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      local clonePosition = nil\r\n\r\n      if ((rivalsMode == \"Normal Draft\") or (rivalsMode == \"Cube Draft\")) then\r\n        -- For normal draft or cube draft, clone on the Rivals deck holder.\r\n        clonePosition = getObjectFromGUID(seatData[somePlayer].rivalsDeckHolderGuid).getPosition()\r\n      else\r\n        -- For Winchester or sealed, clone on top of the deck area.\r\n        clonePosition = getObjectFromGUID(seatData[somePlayer].scriptZoneGuid).getPosition()\r\n      end\r\n      clonePosition.y = 1.5\r\n\r\n      local newRivalsDeck = rivalsDeck.clone({position=clonePosition})\r\n\r\n      -- Update the Rival deck rotation to be correct for each seat.\r\n      local rivalsDeckRotation = getObjectFromGUID(seatData[somePlayer].scriptZoneGuid).getRotation()\r\n\r\n      if ((rivalsMode == \"Normal Draft\") or (rivalsMode == \"Cube Draft\")) then\r\n        -- For normal draft or cube draft, rotate the Rivals deck to be face up.\r\n        rivalsDeckRotation.y = rivalsDeckRotation.y+180\r\n      else\r\n        -- For sealed and Winchester, flip the Rivals deck over.\r\n        rivalsDeckRotation.x = rivalsDeckRotation.x+180\r\n      end\r\n\r\n      newRivalsDeck.setRotation(rivalsDeckRotation)\r\n    end\r\n\r\n    -- After a delay, destruct the Rivals deck.\r\n    Wait.time(function() destructRivalsDeck(rivalsDeck) end, 1.5)\r\n  else\r\n    -- This should never happen.\r\n    printToAll(\"Error, Rivals deck not found.\", {1,0,0})\r\n  end\r\n\r\n  -- Wait before dealing.  Note that this is a long time because cards for 8 players take a while.\r\n  Wait.time(function() draftReadyForDeal(deck) end, 3.5)\r\n\r\n  return 1\r\nend\r\n\r\nfunction destructRivalsDeck(rivalsDeck)\r\n  rivalsDeck.destruct()\r\nend\r\n\r\nfunction updatePackChoices(clickedPackIndex, clickedExpansionOffset)\r\n  packSelections[clickedPackIndex] = expansions[clickedExpansionOffset+1]\r\n\r\n  local clickedPackOffset = (clickedPackIndex-1)\r\n\r\n  for expansionOffset=0,(numExpansions-1) do\r\n    local editButtonParameters = {}\r\n\r\n    -- Change button colors to reflect the new selection.  Unlike Lua arrays, button indices start at 0.\r\n\r\n    editButtonParameters.index = ((clickedPackOffset * numExpansions) + expansionOffset)\r\n    if clickedExpansionOffset == expansionOffset then\r\n      editButtonParameters.color = {1,1,1}\r\n      editButtonParameters.font_color = {0,0,0}\r\n    else\r\n      editButtonParameters.color = {0,0,0}\r\n      editButtonParameters.font_color = {1,1,1}\r\n    end\r\n    self.editButton(editButtonParameters)\r\n  end\r\nend\r\n\r\n-- Unfortunately, there seems to be no way to identify which button was clicked without using a million functions here or doing dynamic function generation.\r\n\r\nfunction packAW1()\r\n  updatePackChoices(1, 0)\r\nend\r\n\r\nfunction packAW2()\r\n  updatePackChoices(2, 0)\r\nend\r\n\r\nfunction packAW3()\r\n  updatePackChoices(3, 0)\r\nend\r\n\r\nfunction packAW4()\r\n  updatePackChoices(4, 0)\r\nend\r\n\r\nfunction packAW5()\r\n  updatePackChoices(5, 0)\r\nend\r\n\r\nfunction packAW6()\r\n  updatePackChoices(6, 0)\r\nend\r\n\r\nfunction packAW7()\r\n  updatePackChoices(7, 0)\r\nend\r\n\r\nfunction packAW8()\r\n  updatePackChoices(8, 0)\r\nend\r\n\r\nfunction packSoR1()\r\n  updatePackChoices(1, 1)\r\nend\r\n\r\nfunction packSoR2()\r\n  updatePackChoices(2, 1)\r\nend\r\n\r\nfunction packSoR3()\r\n  updatePackChoices(3, 1)\r\nend\r\n\r\nfunction packSoR4()\r\n  updatePackChoices(4, 1)\r\nend\r\n\r\nfunction packSoR5()\r\n  updatePackChoices(5, 1)\r\nend\r\n\r\nfunction packSoR6()\r\n  updatePackChoices(6, 1)\r\nend\r\n\r\nfunction packSoR7()\r\n  updatePackChoices(7, 1)\r\nend\r\n\r\nfunction packSoR8()\r\n  updatePackChoices(8, 1)\r\nend\r\n\r\nfunction packEaW1()\r\n  updatePackChoices(1, 2)\r\nend\r\n\r\nfunction packEaW2()\r\n  updatePackChoices(2, 2)\r\nend\r\n\r\nfunction packEaW3()\r\n  updatePackChoices(3, 2)\r\nend\r\n\r\nfunction packEaW4()\r\n  updatePackChoices(4, 2)\r\nend\r\n\r\nfunction packEaW5()\r\n  updatePackChoices(5, 2)\r\nend\r\n\r\nfunction packEaW6()\r\n  updatePackChoices(6, 2)\r\nend\r\n\r\nfunction packEaW7()\r\n  updatePackChoices(7, 2)\r\nend\r\n\r\nfunction packEaW8()\r\n  updatePackChoices(8, 2)\r\nend\r\n\r\nfunction packLEG1()\r\n  updatePackChoices(1, 3)\r\nend\r\n\r\nfunction packLEG2()\r\n  updatePackChoices(2, 3)\r\nend\r\n\r\nfunction packLEG3()\r\n  updatePackChoices(3, 3)\r\nend\r\n\r\nfunction packLEG4()\r\n  updatePackChoices(4, 3)\r\nend\r\n\r\nfunction packLEG5()\r\n  updatePackChoices(5, 3)\r\nend\r\n\r\nfunction packLEG6()\r\n  updatePackChoices(6, 3)\r\nend\r\n\r\nfunction packLEG7()\r\n  updatePackChoices(7, 3)\r\nend\r\n\r\nfunction packLEG8()\r\n  updatePackChoices(8, 3)\r\nend\r\n\r\nfunction packWotF1()\r\n  updatePackChoices(1, 4)\r\nend\r\n\r\nfunction packWotF2()\r\n  updatePackChoices(2, 4)\r\nend\r\n\r\nfunction packWotF3()\r\n  updatePackChoices(3, 4)\r\nend\r\n\r\nfunction packWotF4()\r\n  updatePackChoices(4, 4)\r\nend\r\n\r\nfunction packWotF5()\r\n  updatePackChoices(5, 4)\r\nend\r\n\r\nfunction packWotF6()\r\n  updatePackChoices(6, 4)\r\nend\r\n\r\nfunction packWotF7()\r\n  updatePackChoices(7, 4)\r\nend\r\n\r\nfunction packWotF8()\r\n  updatePackChoices(8, 4)\r\nend\r\n\r\nfunction heroButton()\r\n  if herobutton==true then\r\n    self.editButton({index=0,label='Hero'})\r\n    affiliationselect='nil'\r\n    if villainbutton!=true and neutralbutton != true then\r\n      affiliationselect='Hero'\r\n      affiliationselect2='Villain'\r\n      affiliationselect3='Neutral'\r\n    end\r\n    herobutton=false\r\n    return\r\n  end\r\n\r\n  if herobutton!=true then\r\n    self.editButton({index=0,label='!Hero!'})\r\n    herobutton=true\r\n    affiliationselect='Hero'\r\n    if villainbutton!=true and neutralbutton != true then\r\n      affiliationselect2='nil'\r\n      affiliationselect3='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction villainButton()\r\n  if villainbutton==true then\r\n    self.editButton({index=1,label='villain'})\r\n    affiliationselect2='nil'\r\n    if herobutton!=true and neutralbutton != true then\r\n      affiliationselect='Hero'\r\n      affiliationselect2='Villain'\r\n      affiliationselect3='Neutral'\r\n    end\r\n    villainbutton=false\r\n    return\r\n  end\r\n\r\n  if villainbutton!=true then\r\n    self.editButton({index=1,label='!villain!'})\r\n    villainbutton=true\r\n    affiliationselect2='Villain'\r\n    if herobutton!=true and neutralbutton != true then\r\n      affiliationselect='nil'\r\n      affiliationselect3='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction neutralButton()\r\n  if neutralbutton==true then\r\n    self.editButton({index=2,label='Neutral'})\r\n    affiliationselect3='nil'\r\n    if villainbutton!=true and herobutton != true then\r\n      affiliationselect='Hero'\r\n      affiliationselect2='villain'\r\n      affiliationselect3='Neutral'\r\n    end\r\n    neutralbutton=false\r\n    return\r\n  end\r\n\r\n  if neutralbutton!=true then\r\n    self.editButton({index=2,label='!Neutral!'})\r\n    neutralbutton=true\r\n    affiliationselect3='Neutral'\r\n    if villainbutton!=true and herobutton != true then\r\n      affiliationselect2='nil'\r\n      affiliationselect='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction charactersButton()\r\n  if charactersbutton==true then\r\n    self.editButton({index=3,label='Characters'})\r\n    typeselect='nil'\r\n    if upgradesbutton!=true and supportsbutton != true and eventsbutton != true then\r\n      typeselect='Character'\r\n      typeselect2='Upgrade'\r\n      typeselect3='Support'\r\n      typeselect4='Event'\r\n    end\r\n    charactersbutton=false\r\n    return\r\n  end\r\n\r\n  if charactersbutton!=true then\r\n    self.editButton({index=3,label='!Character!'})\r\n    charactersbutton=true\r\n    typeselect='Character'\r\n    if upgradesbutton!=true and supportsbutton != true and eventsbutton != true then\r\n      typeselect2='nil'\r\n      typeselect3='nil'\r\n      typeselect4='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction upgradesButton()\r\n  if upgradesbutton==true then\r\n    self.editButton({index=4,label='Upgrades'})\r\n    typeselect2='nil'\r\n    if charactersbutton!=true and supportsbutton != true and eventsbutton != true then\r\n      typeselect='Character'\r\n      typeselect2='Upgrade'\r\n      typeselect3='Support'\r\n      typeselect4='Event'\r\n    end\r\n    upgradesbutton=false\r\n    return\r\n  end\r\n\r\n  if upgradesbutton!=true then\r\n    self.editButton({index=4,label='!Upgrades!'})\r\n    upgradesbutton=true\r\n    typeselect2='Upgrade'\r\n    if charactersbutton!=true and supportsbutton != true and eventsbutton != true then\r\n      typeselect='nil'\r\n      typeselect3='nil'\r\n      typeselect4='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction supportsButton()\r\n  if supportsbutton==true then\r\n    self.editButton({index=5,label='Supports'})\r\n    typeselect3='nil'\r\n    if charactersbutton!=true and upgradesbutton != true and eventsbutton != true then\r\n      typeselect='Character'\r\n      typeselect2='Upgrade'\r\n      typeselect3='Support'\r\n      typeselect4='Event'\r\n    end\r\n    supportsbutton=false\r\n    return\r\n  end\r\n\r\n  if supportsbutton!=true then\r\n    self.editButton({index=5,label='!Supports!'})\r\n    supportsbutton=true\r\n    typeselect3='Support'\r\n    if charactersbutton!=true and upgradesbutton != true and eventsbutton != true then\r\n      typeselect='nil'\r\n      typeselect2='nil'\r\n      typeselect4='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction eventsButton()\r\n  if eventsbutton==true then\r\n    self.editButton({index=6,label='Events'})\r\n    typeselect4='nil'\r\n    if charactersbutton!=true and upgradesbutton != true and supportsbutton != true then\r\n      typeselect='Character'\r\n      typeselect2='Upgrade'\r\n      typeselect3='Support'\r\n      typeselect4='Event'\r\n    end\r\n    eventsbutton=false\r\n    return\r\n  end\r\n\r\n  if eventsbutton!=true then\r\n    self.editButton({index=6,label='!Events!'})\r\n    eventsbutton=true\r\n    typeselect4='Event'\r\n    if charactersbutton!=true and upgradesbutton != true and supportsbutton != true then\r\n      typeselect='nil'\r\n      typeselect2='nil'\r\n      typeselect3='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction redButton()\r\n  if redbutton==true then\r\n    self.editButton({index=7,label='Red'})\r\n    colorselect='nil'\r\n    if bluebutton!=true and yellowbutton != true and greybutton != true then\r\n      colorselect='Red'\r\n      colorselect2='Blue'\r\n      colorselect3='Yellow'\r\n      colorselect4='Gray'\r\n    end\r\n    redbutton=false\r\n    return\r\n  end\r\n\r\n  if redbutton!=true then\r\n    self.editButton({index=7,label='!Red!'})\r\n    redbutton=true\r\n    colorselect='Red'\r\n    if bluebutton!=true and yellowbutton != true and greybutton != true then\r\n      colorselect2='nil'\r\n      colorselect3='nil'\r\n      colorselect4='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction blueButton()\r\n  if bluebutton==true then\r\n    self.editButton({index=8,label='Blue'})\r\n    colorselect2='nil'\r\n    if redbutton!=true and yellowbutton != true and greybutton != true then\r\n      colorselect='Red'\r\n      colorselect2='Blue'\r\n      colorselect3='Yellow'\r\n      colorselect4='Gray'\r\n    end\r\n    bluebutton=false\r\n    return\r\n  end\r\n\r\n  if bluebutton!=true then\r\n    self.editButton({index=8,label='!Blue!'})\r\n    bluebutton=true\r\n    colorselect2='Blue'\r\n    if redbutton!=true and yellowbutton != true and greybutton != true then\r\n      colorselect='nil'\r\n      colorselect3='nil'\r\n      colorselect4='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction yellowButton()\r\n  if yellowbutton==true then\r\n    self.editButton({index=9,label='Yellow'})\r\n    colorselect3='nil'\r\n    if redbutton!=true and bluebutton != true and greybutton != true then\r\n      colorselect='Red'\r\n      colorselect2='Blue'\r\n      colorselect3='Yellow'\r\n      colorselect4='Gray'\r\n    end\r\n    yellowbutton=false\r\n    return\r\n  end\r\n\r\n  if yellowbutton!=true then\r\n    self.editButton({index=9,label='!Yellow!'})\r\n    yellowbutton=true\r\n    colorselect3='Yellow'\r\n    if redbutton!=true and bluebutton != true and greybutton != true then\r\n      colorselect='nil'\r\n      colorselect2='nil'\r\n      colorselect4='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction greyButton()\r\n  if greybutton==true then\r\n    self.editButton({index=10,label='Gray'})\r\n    colorselect4='nil'\r\n    if redbutton!=true and bluebutton != true and yellowbutton != true then\r\n      colorselect='Red'\r\n      colorselect2='Blue'\r\n      colorselect3='Yellow'\r\n      colorselect4='Gray'\r\n    end\r\n    greybutton=false\r\n    return\r\n  end\r\n\r\n  if greybutton!=true then\r\n    self.editButton({index=10,label='!Grey!'})\r\n    greybutton=true\r\n    colorselect4='Gray'\r\n    if redbutton!=true and bluebutton != true and yellowbutton != true then\r\n      colorselect='nil'\r\n      colorselect2='nil'\r\n      colorselect3='nil'\r\n    end\r\n    return\r\n  end\r\nend\r\n\r\nfunction battlefieldsButton()\r\n  if battlefieldbutton !=true then\r\n    self.editButton({index=11,label='!Battlefields!'})\r\n    battlefieldbutton=true\r\n    return\r\n  end\r\n\r\n  if battlefieldbutton ==true then\r\n    self.editButton({index=11,label='Battlefields'})\r\n    battlefieldbutton=false\r\n    return\r\n  end\r\n\r\nend\r\n\r\nfunction setupDeckbuilding()\r\n  --broadcastToAll('Check Steam workshop page for instructions!', {255,255,255})\r\n  local object = setupObject.takeObject({position={28,1,6.5},guid='1cc719'})\r\n  object.interactable = false\r\n  object = setupObject.takeObject({position={28,1,12},guid='cf8e15'})\r\n  object.interactable = false\r\n\r\n  self.clearButtons()\r\n  self.createButton({\r\n    label='Hero', click_function=\"heroButton\", function_owner=self,\r\n      position={-1,0.1,-1}, width=500, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='villain', click_function=\"villainButton\", function_owner=self,\r\n      position={-0,0.1,-1}, width=500, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Neutral', click_function=\"neutralButton\", function_owner=self,\r\n      position={1,0.1,-1}, width=500, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Characters', click_function=\"charactersButton\", function_owner=self,\r\n      position={-0.6,0.1,-0.4}, width=600, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Upgrades', click_function=\"upgradesButton\", function_owner=self,\r\n      position={0.6,0.1,-0.4}, width=600, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Supports', click_function=\"supportsButton\", function_owner=self,\r\n      position={-0.6,0.1,-0.1}, width=600, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Events', click_function=\"eventsButton\", function_owner=self,\r\n      position={0.6,0.1,-0.1}, width=600, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Red',click_function=\"redButton\",function_owner=self,\r\n    position={-1.2,0.1,0.5},width = 400, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Blue',click_function=\"blueButton\",function_owner=self,\r\n    position={-0.4,0.1,0.5},width = 400, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Yellow',click_function=\"yellowButton\",function_owner=self,\r\n    position={0.4,0.1,0.5},width = 400, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Gray',click_function=\"greyButton\",function_owner=self,\r\n    position={1.2,0.1,0.5},width = 400, height = 150, font_size = 90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Battlefields', click_function=\"battlefieldsButton\", function_owner=self,\r\n    position={0,0.1,1.1}, width=800, height=150,font_size=90\r\n  })\r\n\r\n  self.createButton({\r\n    label='Spawn',click_function=\"spawndb\",function_owner=self,\r\n    position={-1.3,0.1,1.7},width = 400, height = 150, font_size = 100\r\n  })\r\n\r\n  self.createButton({\r\n    label='Back',click_function=\"dbBack\",function_owner=self,\r\n    position={1.3,0.1,1.7},width = 400, height = 150, font_size = 100\r\n  })\r\nend\r\n\r\nfunction spawnSetupButton(buttonObject, playerColor)\r\n  local errorDetected = false\r\n\r\n  if ((blue == nil) or (blue == 0)) then\r\n    broadcastToAll('No number of characters chosen for blue!', {1,1,1})\r\n    errorDetected = true\r\n  end\r\n\r\n  if ((red == nil) or (red == 0)) then\r\n    broadcastToAll('No number of characters chosen for red!', {1,1,1})\r\n    errorDetected = true\r\n  end\r\n\r\n  local seatedPlayers = getSeatedPlayers()\r\n  local numSeatedPlayers = 0\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    numSeatedPlayers = numSeatedPlayers + 1\r\n  end\r\n\r\n  if ((numSeatedPlayers == 1) or (numSeatedPlayers == 2)) then\r\n    if (errorDetected == false) then\r\n      -- Zoom camera back out to the normal perspective for that player.\r\n      zoomCameraBackOut(playerColor)\r\n\r\n      -- Delay slightly so camera movement does not feel too sudden.\r\n      Wait.time(function() spawnSetupButtonAfterDelay(playerColor) end, 0.2)\r\n    end\r\n  else\r\n    printToAll(\"Error, two-player games must have 1 or 2 seated players.\", {1,0,0})\r\n  end\r\nend\r\n\r\nfunction spawnSetupButtonAfterDelay(playerColor)\r\n  startLuaCoroutine(self, 'spawnSetupCoroutine')\r\nend\r\n\r\n\r\ncharacterPlaymatScript = [[\r\nfunction onload()\r\n  tokenplayerone = Global.getTable('tokenplayerone')\r\n  tokenplayertwo = Global.getTable('tokenplayertwo')\r\n  spawndamage = {}\r\n  damagetoken = {}\r\n  spawnshield = {}\r\n  shieldtoken = {}\r\n\r\n  for i = 1, 5 do\r\n      local buttonNum = tostring(i)\r\n      local funcName = \"spawnDamage\" .. tostring(i)\r\n      local params = { click_function = funcName\r\n                      , function_owner = self\r\n                      , label = ' '\r\n                      , position = {-1.65,0,-1.70+0.30*i}\r\n                      , width = 100\r\n                      , height = 100\r\n                      , font_size = 50 }\r\n      local func = function()\r\n        local position = self.getPosition()\r\n        local moving = setSpawnPositions({4.50, -4.65, 0.8, 0})\r\n        position = {(position[1]+moving[1]+moving[4]*i),(position[2]+0.2),(position[3]+moving[2]+moving[3]*i)}\r\n        if spawndamage[i] == nil then\r\n          if damagetoken[i] ~= nil then damagetoken[i].destruct() end\r\n          damagetoken[i] = spawnToken(position, '1')\r\n          spawndamage[i] = 'one'\r\n          damagetoken[i].interactable = false\r\n          return\r\n        elseif spawndamage[i] == 'one' then\r\n          if damagetoken[i] ~= nil then damagetoken[i].destruct() end\r\n          damagetoken[i] = spawnToken(position, '2')\r\n          spawndamage[i] = 'three'\r\n          damagetoken[i].interactable = false\r\n          return\r\n        elseif spawndamage[i] == 'three' then\r\n          if damagetoken[i] ~= nil then damagetoken[i].destruct() end\r\n          spawndamage[i] = nil\r\n          return\r\n        end\r\n      end\r\n      self.setVar(funcName, func)\r\n      self.createButton(params)\r\n  end\r\n\r\n  for i = 1, 3 do\r\n      local buttonNum = tostring(i)\r\n      local funcName = \"spawnShield\" .. tostring(i)\r\n      local params = { click_function = funcName\r\n                      , function_owner = self\r\n                      , label = ' '\r\n                      , position = {-1.30+0.35*i,0,-1.72}\r\n                      , width = 100\r\n                      , height = 100\r\n                      , font_size = 50 }\r\n      local func = function()\r\n        if spawnshield[i] ~= true then\r\n          if shieldtoken[i] ~= nil then shieldtoken[i].destruct() end\r\n          local position = self.getPosition()\r\n          local moving = setSpawnPositions({3.60, -4.75, -1, 0})\r\n          position = {(position[1]+moving[1]+moving[3]*i),(position[2]+0.1),(position[3]+moving[2]-moving[4]*i)}\r\n          shieldtoken[i] = spawnToken(position, '3')\r\n          spawnshield[i] = true\r\n          shieldtoken[i].interactable = false\r\n          return\r\n        elseif spawnshield[i] == true then\r\n          if shieldtoken[i] ~= nil then shieldtoken[i].destruct() end\r\n          spawnshield[i] = false\r\n          return\r\n        end\r\n      end\r\n      self.setVar(funcName, func)\r\n      self.createButton(params)\r\n  end\r\n\r\n  if self.getName() == 'Blue' then\r\n    owner = 'Blue'\r\n  else\r\n    owner = 'Red'\r\n  end\r\nend\r\n\r\nfunction spawnToken(position, number)\r\n  local obj_parameters = {}\r\n  obj_parameters.type = 'Custom_Token'\r\n  obj_parameters.position = position\r\n  obj_parameters.rotation = {3.87674022, self.getRotation()[2], 0.239081308}\r\n  local token = spawnObject(obj_parameters)\r\n  local custom = {}\r\n  custom.thickness = 0.1\r\n  custom.merge_distance = 5.0\r\n  custom.stackable = false\r\n  if number == '1' then\r\n    custom.image = tokenplayerone.damageone\r\n  elseif number == '2' then\r\n    custom.image = tokenplayerone.damagethree\r\n  elseif number == '3' then\r\n    custom.image = tokenplayerone.shield\r\n  else\r\n    return nil\r\n  end\r\n  token.setCustomObject(custom)\r\n  token.scale {0.227068469, 1, 0.227068469}\r\n  return token\r\nend\r\n\r\nfunction onCollisionEnter(collision_info)\r\n  local position = self.getPosition()\r\n  local object = collision_info.collision_object\r\n  local obj_parameters = {}\r\n  local custom = {}\r\n  obj_parameters.type = 'Custom_Dice'\r\n  obj_parameters.scale = {1.7,1.7,1.7}\r\n  obj_parameters.position = {object.getPosition()[1],object.getPosition()[2]+1,object.getPosition()[3]}\r\n  obj_parameters.rotation = {0,object.getRotation()[2]+180,0}\r\n  local datatable = Global.getTable(\"cardstable\")\r\n\r\n  if object.getVar(\"spawned\") ~= true and object.tag == 'Card' then\r\n    local cardFound = false\r\n    local cardDescription = object.getDescription()\r\n    local cardDescriptionLength = 0\r\n    local dataTableIndex = 1\r\n    local fixedCardName = ''\r\n    local isElite = false\r\n\r\n    if cardDescription != nil then\r\n      cardDescriptionLength = string.len(cardDescription)\r\n      if string.sub(cardDescription, 1, 5) == 'elite' then\r\n        isElite = true\r\n      end\r\n    end\r\n\r\n    -- If there is text past \"elite\", or the card is not elite and there is text at all, the card uses the new format.\r\n    if (((isElite == true) and (cardDescriptionLength > 5)) or\r\n        ((isElite == false) and (cardDescriptionLength > 0))) then\r\n      -- This is a new card export.  Extract the set and number.\r\n      local cardSet = ''\r\n      local cardNumber = ''\r\n      local setCharIndex = 1\r\n      local numberCharIndex = 1\r\n      if (isElite == true) then\r\n        setCharIndex = 7\r\n      else\r\n        setCharIndex = 1\r\n      end\r\n\r\n      -- Do a plain search.\r\n      numberCharIndex = (string.find(cardDescription, ' ', setCharIndex, true) + 1)\r\n      cardSet = string.sub(cardDescription, setCharIndex, (numberCharIndex - 2))\r\n      -- Leaving out the third argument takes a substring to the end of the string.\r\n      cardNumber = string.sub(cardDescription, numberCharIndex)\r\n\r\n      -- Find the card by its set and number.\r\n      for i in ipairs(datatable) do\r\n        if ((datatable[i][\"set\"] == cardSet) and\r\n            (datatable[i][\"number\"] == cardNumber) and\r\n            (datatable[i][\"diceimage\"] != nil) and\r\n            ((datatable[i][\"type\"] == 'Upgrade') or (datatable[i][\"type\"] == 'Character') or (datatable[i][\"type\"] == 'Battlefield'))) then\r\n          cardFound = true\r\n          dataTableIndex = i\r\n          fixedCardName = datatable[dataTableIndex][\"cardname\"]\r\n          object.setName(fixedCardName)\r\n          break\r\n        end\r\n      end\r\n\r\n      local diceSpawnDebug = Global.getVar(\"diceSpawnDebug\")\r\n\r\n      if (cardFound == false) then\r\n        if diceSpawnDebug == true then\r\n          printToAll(\"Error, card \" .. cardSet .. \" \" .. cardNumber .. \" not found (make sure it is not a support).\", {1,0,0})\r\n        end\r\n      end\r\n    else\r\n      -- This is an old card export.  Use the old system.\r\n      fixedCardName = Global.call(\"fixCardName\", { object.getName() })\r\n      object.setName(fixedCardName)\r\n      for i in ipairs(datatable) do\r\n        if ((datatable[i][\"cardname\"] == fixedCardName) and\r\n            (datatable[i][\"diceimage\"] != nil) and\r\n            ((datatable[i][\"type\"] == 'Upgrade') or (datatable[i][\"type\"] == 'Character') or (datatable[i][\"type\"] == 'Battlefield'))) then\r\n          cardFound = true\r\n          dataTableIndex = i\r\n          break\r\n        end\r\n      end\r\n\r\n      if (cardFound == false) then\r\n        if diceSpawnDebug == true then\r\n          printToAll(\"Error, card \" .. fixedCardName .. \" not found (make sure it is not a support).\", {1,0,0})\r\n        end\r\n      end\r\n    end\r\n\r\n    if (cardFound == true) then\r\n      -- For character cards, spawn the dice on the table for ease of rollout.\r\n      zOffset = 0\r\n      if (datatable[dataTableIndex][\"type\"] == 'Character') then\r\n        if owner == 'Blue' then\r\n          zOffset = (-6)\r\n        else\r\n          zOffset = 5\r\n        end\r\n      end\r\n\r\n      collision_info.collision_object.setVar(\"spawned\", true)\r\n      obj_parameters.position[3] = (obj_parameters.position[3] + zOffset)\r\n      local dice = spawnObject(obj_parameters)\r\n      custom.image = datatable[dataTableIndex][\"diceimage\"]\r\n      dice.setCustomObject(custom)\r\n      if (fixedCardName == 'Seventh Sister, Agile Inquisitor') then\r\n        obj_parameters.position = {object.getPosition()[1]+1, object.getPosition()[2]+1, (object.getPosition()[3] + zOffset)}\r\n        local extradice = spawnObject(obj_parameters)\r\n        custom.image = \"http://cloud-3.steamusercontent.com/ugc/869614883116891249/E95F6BDCAD82D95AEEFF7798BA2EB89013F1C530/\"\r\n        extradice.setCustomObject(custom)\r\n        custom.image = datatable[dataTableIndex][\"diceimage\"]\r\n      end\r\n\r\n      if (isElite == true) then\r\n        obj_parameters.position = {object.getPosition()[1], object.getPosition()[2]+1, (object.getPosition()[3] + 1 + zOffset)}\r\n        local dice = spawnObject(obj_parameters)\r\n        dice.setCustomObject(custom)\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction setSpawnPositions(position)\r\n  if self.getRotation()[2] < 5 and self.getRotation()[2] > -5 then\r\n    return {position[1], position[2], position[3], position[4]}\r\n  elseif self.getRotation()[2] < 95 and self.getRotation()[2] > 85 then\r\n    return {position[2], position[1]*-1, position[4], position[3]}\r\n  elseif self.getRotation()[2] < 185 and self.getRotation()[2] > 175 then\r\n    return {position[1]*-1, position[2]*-1, position[3]*-1, position[4]}\r\n  elseif self.getRotation()[2] < 275 and self.getRotation()[2] > 265 then\r\n    return {position[2]*-1, position[1], position[4], position[3]*-1}\r\n  end\r\nend\r\n]]\r\n\r\n\r\nsupportPlaymatScript = [[\r\nfunction onLoad()\r\n  tokenplayerone = Global.getTable('tokenplayerone')\r\n  tokenplayertwo = Global.getTable('tokenplayertwo')\r\nend\r\n\r\nfunction onCollisionEnter(collision_info)\r\n  local position = self.getPosition()\r\n  local object = collision_info.collision_object\r\n  local obj_parameters = {}\r\n  local custom = {}\r\n  obj_parameters.type = 'Custom_Dice'\r\n  obj_parameters.scale = {1.7,1.7,1.7}\r\n  obj_parameters.position = {object.getPosition()[1],object.getPosition()[2]+1,object.getPosition()[3]}\r\n  obj_parameters.rotation = {0,object.getRotation()[2]+180,0}\r\n  local datatable = Global.getTable(\"cardstable\")\r\n\r\n  if object.getVar(\"spawned\") ~= true and object.tag == 'Card' then\r\n    local cardFound = false\r\n    local cardDescription = object.getDescription()\r\n    local cardDescriptionLength = 0\r\n    local dataTableIndex = 1\r\n    local fixedCardName = ''\r\n    local isElite = false\r\n\r\n    if cardDescription != nil then\r\n      cardDescriptionLength = string.len(cardDescription)\r\n      if string.sub(cardDescription, 1, 5) == 'elite' then\r\n        isElite = true\r\n      end\r\n    end\r\n\r\n    -- If there is text past \"elite\", or the card is not elite and there is text at all, the card uses the new format.\r\n    if (((isElite == true) and (cardDescriptionLength > 5)) or\r\n        ((isElite == false) and (cardDescriptionLength > 0))) then\r\n      -- This is a new card export.  Extract the set and number.\r\n      local cardSet = ''\r\n      local cardNumber = ''\r\n      local setCharIndex = 1\r\n      local numberCharIndex = 1\r\n      if (isElite == true) then\r\n        setCharIndex = 7\r\n      else\r\n        setCharIndex = 1\r\n      end\r\n\r\n      -- Do a plain search.\r\n      numberCharIndex = (string.find(cardDescription, ' ', setCharIndex, true) + 1)\r\n      cardSet = string.sub(cardDescription, setCharIndex, (numberCharIndex - 2))\r\n      -- Leaving out the third argument takes a substring to the end of the string.\r\n      cardNumber = string.sub(cardDescription, numberCharIndex)\r\n\r\n      -- Find the card by its set and number.\r\n      for i in ipairs(datatable) do\r\n        if ((datatable[i][\"set\"] == cardSet) and\r\n            (datatable[i][\"number\"] == cardNumber) and\r\n            ((datatable[i][\"type\"] == 'Support') or (datatable[i][\"type\"] == 'Battlefield'))) then\r\n          cardFound = true\r\n          dataTableIndex = i\r\n          fixedCardName = datatable[dataTableIndex][\"cardname\"]\r\n          object.setName(fixedCardName)\r\n          break\r\n        end\r\n      end\r\n\r\n      local diceSpawnDebug = Global.getVar(\"diceSpawnDebug\")\r\n\r\n      if (cardFound == false) then\r\n        if diceSpawnDebug == true then\r\n          printToAll(\"Error, card \" .. cardSet .. \" \" .. cardNumber .. \" not found (make sure it is actually a support).\", {1,0,0})\r\n        end\r\n      end\r\n    else\r\n      -- This is an old card export.  Use the old system.\r\n      fixedCardName = Global.call(\"fixCardName\", { object.getName() })\r\n      object.setName(fixedCardName)\r\n      for i in ipairs(datatable) do\r\n        if ((datatable[i][\"cardname\"] == fixedCardName) and\r\n            ((datatable[i][\"type\"] == 'Support') or (datatable[i][\"type\"] == 'Battlefield'))) then\r\n          cardFound = true\r\n          dataTableIndex = i\r\n          break\r\n        end\r\n      end\r\n\r\n      if (cardFound == false) then\r\n        if diceSpawnDebug == true then\r\n          printToAll(\"Error, card \" .. fixedCardName .. \" not found (make sure it is actually a support).\", {1,0,0})\r\n        end\r\n      end\r\n    end\r\n\r\n    if (cardFound == true) then\r\n      collision_info.collision_object.setVar(\"spawned\", true)\r\n\r\n      if (datatable[dataTableIndex][\"diceimage\"] != nil) then\r\n        local dice = spawnObject(obj_parameters)\r\n        custom.image = datatable[dataTableIndex][\"diceimage\"]\r\n        dice.setCustomObject(custom)\r\n      end\r\n\r\n      if (fixedCardName == \"Backup Muscle\") then\r\n        collision_info.collision_object.setVar(\"spawned\", true)\r\n        obj_parameters.type = 'Custom_Token'\r\n        obj_parameters.rotation = {3.87674022, 0, 0.239081308}\r\n        obj_parameters.scale = {0.227068469, 1, 0.227068469}\r\n        for i=1,3 do\r\n          obj_parameters.position = {collision_info.collision_object.getPosition()[1]-1.5+(i*0.7),collision_info.collision_object.getPosition()[2]+0.2,collision_info.collision_object.getPosition()[3]-1.5+(i*0.7)}\r\n          local token = spawnObject(obj_parameters)\r\n          local custom = {}\r\n          custom.image = tokenplayerone.damageone\r\n          custom.thickness = 0.1\r\n          custom.merge_distance = 5.0\r\n          custom.stackable = false\r\n          token.setCustomObject(custom)\r\n        end\r\n      elseif (fixedCardName == \"Modified HWK-290\") then\r\n        collision_info.collision_object.setVar(\"spawned\", true)\r\n        obj_parameters.type = 'Custom_Token'\r\n        obj_parameters.rotation = {3.87674022, 0, 0.239081308}\r\n        obj_parameters.scale = {0.227068469, 1, 0.227068469}\r\n        for i=1,2 do\r\n          obj_parameters.position = {collision_info.collision_object.getPosition()[1]-1.5+(i*0.7),collision_info.collision_object.getPosition()[2]+0.2,collision_info.collision_object.getPosition()[3]-1.5+(i*0.7)}\r\n          local token = spawnObject(obj_parameters)\r\n          local custom = {}\r\n          custom.image = tokenplayerone.damageone\r\n          custom.thickness = 0.1\r\n          custom.merge_distance = 5.0\r\n          custom.stackable = false\r\n          token.setCustomObject(custom)\r\n        end\r\n      elseif (fixedCardName == \"Air Superiority\") then\r\n        collision_info.collision_object.setVar(\"spawned\", true)\r\n        obj_parameters.type = 'Custom_Token'\r\n        obj_parameters.rotation = {3.87674022, 0, 0.239081308}\r\n        obj_parameters.scale = {0.227068469, 1, 0.227068469}\r\n        for i=1,3 do\r\n          obj_parameters.position = {collision_info.collision_object.getPosition()[1]-1.5+(i*0.7),collision_info.collision_object.getPosition()[2]+0.2,collision_info.collision_object.getPosition()[3]-1.5+(i*0.7)}\r\n          local token = spawnObject(obj_parameters)\r\n          local custom = {}\r\n          custom.image = tokenplayerone.shield\r\n          custom.thickness = 0.1\r\n          custom.merge_distance = 5.0\r\n          custom.stackable = false\r\n          token.setCustomObject(custom)\r\n        end\r\n      end\r\n\r\n      if (isElite == true) then\r\n        printToAll(\"Error, supports cannot be elite.  Ignoring tag.\", {1,0,0})\r\n      end\r\n    end\r\n  end\r\nend\r\n\r\nfunction setSpawnPositions(position)\r\n  if self.getRotation()[2] < 5 and self.getRotation()[2] > -5 then\r\n    return {position[1], position[2], position[3], position[4]}\r\n  elseif self.getRotation()[2] < 95 and self.getRotation()[2] > 85 then\r\n    return {position[2], position[1]*-1, position[4], position[3]}\r\n  elseif self.getRotation()[2] < 185 and self.getRotation()[2] > 175 then\r\n    return {position[1]*-1, position[2]*-1, position[3]*-1, position[4]}\r\n  elseif self.getRotation()[2] < 275 and self.getRotation()[2] > 265 then\r\n    return {position[2]*-1, position[1], position[4], position[3]*-1}\r\n  end\r\nend\r\n]]\r\n\r\n\r\ndatapadScript = [[\r\nfunction onLoad()\r\n  tokenplayerone = Global.getTable('tokenplayerone')\r\n  tokenplayertwo = Global.getTable('tokenplayertwo')\r\n\r\n  self.createButton({\r\n    label=\" \", click_function=\"spawnResource\", function_owner=self, tooltip=\"Get a resource\",\r\n    position={-0.1,-0.2,0.26}, width=1200, height=150, font_size=200, color={1,1,1,0.6}\r\n  })\r\n\r\n  self.createButton({\r\n    label=\" \", click_function=\"randomDiscard\", function_owner=self, tooltip=\"Discard a random card\",\r\n    position={-0.1,-0.2,0.56}, width=1200, height=150, font_size=200, color={1,1,1,0.6}\r\n  })\r\n\r\n  self.createButton({\r\n    label=\" \", click_function=\"shuffleHand\", function_owner=self, tooltip=\"Shuffle your hand\",\r\n    position={-0.1,-0.2,0.87}, width=1200, height=150, font_size=200, color={1,1,1,0.6}\r\n  })\r\n\r\n  self.createButton({\r\n    label=\" \", click_function=\"passButton\", function_owner=self, tooltip=\"Pass\",\r\n    position={-0.1,-0.2,1.07}, width=1200, height=150, font_size=200, color={1,1,1,0.6}\r\n  })\r\n\r\n  spawnd = 0\r\n\r\n  if self.getName() == 'Blue Datapad' then\r\n    owner = 'Blue'\r\n  else\r\n    owner = 'Red'\r\n  end\r\nend\r\n\r\nfunction passButton()\r\n  if owner == 'Blue' then\r\n    broadcastToAll('Pass', {0.1,0.5,1.0})\r\n  else\r\n    broadcastToAll('Pass', {0.8,0.1,0.1})\r\n  end\r\nend\r\n\r\nfunction resourceSpawned(newResource)\r\n  newResource.setName(\"1 resource\")\r\n  newResource.tooltip = false\r\nend\r\n\r\nfunction spawnResource()\r\n  local position = self.getPosition()\r\n  local obj_parameters = {}\r\n  obj_parameters.type = 'Custom_Token'\r\n  if owner == 'Blue' then\r\n    obj_parameters.position = {(position[1]+2.60-spawnd),(position[2]+0.2),(position[3]-6.55)}\r\n    obj_parameters.rotation = {3.87674022, 0, 0.239081308}\r\n  else\r\n    obj_parameters.position = {(position[1]-2.60+spawnd),(position[2]+0.2),(position[3]+6.55)}\r\n    obj_parameters.rotation = {3.87674022, 180, 0.239081308}\r\n  end\r\n  obj_parameters.callback_function = resourceSpawned\r\n  local token = spawnObject(obj_parameters)\r\n  local custom = {}\r\n  custom.image = tokenplayerone.resource\r\n  custom.thickness = 0.1\r\n  custom.merge_distance = 5.0\r\n  custom.stackable = false\r\n  token.setCustomObject(custom)\r\n  token.scale {0.227068469, 1, 0.227068469}\r\n  spawnd = spawnd + 0.8\r\n  if spawnd > 4.8 then\r\n    spawnd = 0\r\n  end\r\nend\r\n\r\nfunction randomDiscard()\r\n  local handObjects = Player[owner].getHandObjects()\r\n  local numHandObjects = #handObjects\r\n  local position=self.getPosition()\r\n\r\n  if numHandObjects > 0 then\r\n    if owner == 'Blue' then\r\n      handObjects[math.random(numHandObjects)].setPosition({position[1]-math.random(10)+5,1.2,position[3]-10})\r\n    else\r\n      handObjects[math.random(numHandObjects)].setPosition({position[1]+math.random(10)-5,1.2,position[3]+10})\r\n    end\r\n  end\r\nend\r\n\r\nfunction shuffleHand()\r\n  local handObjects = Player[owner].getHandObjects()\r\n  local numHandObjects = #handObjects\r\n  local cardPositions = {}\r\n\r\n  if numHandObjects > 0 then\r\n    for i, v in pairs(handObjects) do\r\n        cardPositions[i] = v.getPosition()\r\n    end\r\n    local handObjectsShuffled = shuffleTable(handObjects)\r\n    local cardPositionsShuffled = shuffleTable(cardPositions)\r\n    for i, v in pairs(handObjectsShuffled) do\r\n        v.setPosition(cardPositionsShuffled[i])\r\n    end\r\n  end\r\nend\r\n\r\nfunction shuffleTable(t)\r\n    for i = #t, 2, -1 do\r\n        local n = math.random(i)\r\n        t[i], t[n] = t[n], t[i]\r\n    end\r\n    return t\r\nend\r\n]]\r\n\r\n\r\nfunction spawnSetupCoroutine()\r\n  -- Start classic setup.\r\n  Global.setVar(\"modernInterfaceActive\", false)\r\n\r\n  -- Sleep briefly and start.\r\n  Wait.time(spawnSetupAfterDelay, 0.1)\r\n\r\n  return 1\r\nend\r\n\r\nfunction spawnSetupAfterDelay()\r\n  startLuaCoroutine(self, 'spawnSetupAfterDelayCoroutine')\r\nend\r\n\r\nfunction spawnSetupAfterDelayCoroutine()\r\n  local seatData = Global.getTable(\"seatData\")\r\n\r\n  -- Destruct all draft mats.\r\n  local matObject\r\n  for i,someSeat in pairs(seatData) do\r\n    matObject = getObjectFromGUID(someSeat.matGuid)\r\n    if matObject != nil then\r\n      matObject.destruct()\r\n    end\r\n  end\r\n\r\n  -- Scale all hand zones down so they don't grab cards.\r\n  for i,someSeat in pairs(seatData) do\r\n    local handTransform = Player[i].getHandTransform()\r\n    handTransform.scale.x = 0.01\r\n    handTransform.scale.y = 0.01\r\n    handTransform.scale.z = 0.01\r\n    Player[i].setHandTransform(handTransform)\r\n  end\r\n\r\n  -- Adjust the red and blue hand zones to be usable.\r\n  local handTransform = Player[\"Red\"].getHandTransform()\r\n  handTransform.position.x = -1.70\r\n  handTransform.position.y = 4.60\r\n  handTransform.position.z = (-20.00)\r\n  handTransform.rotation.x = 0.00\r\n  handTransform.rotation.y = 0.00\r\n  handTransform.rotation.z = 0.00\r\n  handTransform.scale.x = 20.00\r\n  handTransform.scale.y = 5.65\r\n  handTransform.scale.z = 3.00\r\n  Player[\"Red\"].setHandTransform(handTransform)\r\n  handTransform = Player[\"Blue\"].getHandTransform()\r\n  handTransform.position.x = 1.70\r\n  handTransform.position.y = 4.60\r\n  handTransform.position.z = 20.00\r\n  handTransform.rotation.x = 0.00\r\n  handTransform.rotation.y = 180.00\r\n  handTransform.rotation.z = 0.00\r\n  handTransform.scale.x = 20.00\r\n  handTransform.scale.y = 5.65\r\n  handTransform.scale.z = 3.00\r\n  Player[\"Blue\"].setHandTransform(handTransform)\r\n\r\n  local seatedPlayers = getSeatedPlayers()\r\n  local numSeatedPlayers = 0\r\n  for i,somePlayer in pairs(seatedPlayers) do\r\n    numSeatedPlayers = numSeatedPlayers + 1\r\n  end\r\n\r\n  if ((numSeatedPlayers == 1) or (numSeatedPlayers == 2)) then\r\n    local firstPlayerToAssign = nil\r\n    local secondPlayerToAssign = nil\r\n    local blueUsed = false\r\n    local redUsed = false\r\n    local colorChangeNeeded = false\r\n    for i,somePlayer in pairs(seatedPlayers) do\r\n      if somePlayer == \"Blue\" then\r\n        blueUsed = true\r\n      elseif somePlayer == \"Red\" then\r\n        redUsed = true\r\n      else\r\n        if firstPlayerToAssign == nil then\r\n          firstPlayerToAssign = somePlayer\r\n          colorChangeNeeded = true\r\n        else\r\n          secondPlayerToAssign = somePlayer\r\n          colorChangeNeeded = true\r\n        end\r\n      end\r\n    end\r\n\r\n    -- If either or both players are not blue/red, change their color(s).\r\n\r\n    if firstPlayerToAssign != nil then\r\n      if blueUsed == false then\r\n        Player[firstPlayerToAssign].changeColor(\"Blue\")\r\n        blueUsed = true\r\n      else\r\n        -- If blue is used, then red must not be used, otherwise firstPlayerToAssign would be nil.\r\n        Player[firstPlayerToAssign].changeColor(\"Red\")\r\n        redUsed = true\r\n      end\r\n    end\r\n\r\n    if secondPlayerToAssign != nil then\r\n      -- If neither player was blue or red, the first player got assigned to blue, so this one should be red.\r\n      Player[secondPlayerToAssign].changeColor(\"Red\")\r\n      redUsed = true\r\n    end\r\n\r\n    if colorChangeNeeded == true then\r\n      printToAll(\"Two-player games only use the Blue and Red seats.\", {1,1,1})\r\n    end\r\n  else\r\n    printToAll(\"Error, two-player games must have 1 or 2 seated players.\", {1,0,0})\r\n\r\n    return 1\r\n  end\r\n\r\n  -- At this point, a normal game is considered to have started.\r\n  Global.call(\"handleNormalGameStarted\")\r\n\r\n  local object = {}\r\n  local params = {}\r\n  params.type = 'Custom_Token'\r\n  if blue == 1 then\r\n    startposition = {0,1.1,10.38}\r\n  end\r\n\r\n  if blue == 2 then\r\n    startposition = {6.7,1.1,10.38}\r\n  end\r\n\r\n  if blue == 3  then\r\n    startposition = {9.7,1.1,10.38}\r\n  end\r\n\r\n  if blue == 4 then\r\n    startposition = {16.7,1.1,10.38}\r\n  end\r\n\r\n  params.rotation = {0,0,0}\r\n  params.scale = {2.74,0,2.74}\r\n  object.image = 'http://cloud-3.steamusercontent.com/ugc/194046562276974641/B5CB1D9F2683C4F1FA6A053A67475E057CC989F7/'\r\n  object.thickness = 0.2\r\n  object.merge_distance = 5.0\r\n  for i=1,blue do\r\n    params.position = {startposition[1]-(10.3*(i-1)),startposition[2],startposition[3]}\r\n    local spawner = spawnObject(params)\r\n    spawner.setCustomObject(object)\r\n    spawner.setName('Blue')\r\n    spawner.setLuaScript(characterPlaymatScript)\r\n    spawner.lock()\r\n  end\r\n\r\n  params.position = {startposition[1]+8,1.1,10.38}\r\n  params.scale = {1.88,0,1.88}\r\n  local spawner = spawnObject(params)\r\n  object.image = 'http://cloud-3.steamusercontent.com/ugc/194046562276975653/436A9517517DADEA3F5C9427E7E5EFB4F8844ACB/'\r\n  spawner.setCustomObject(object)\r\n  spawner.setName('Support Playmat')\r\n  spawner.setLuaScript(supportPlaymatScript)\r\n  spawner.lock()\r\n\r\n  params.position = {startposition[1]-(10.2*blue),1.1,10.21}\r\n  params.scale = {2.73, 1, 2.73}\r\n  token = spawnObject(params)\r\n  object.image = 'http://cloud-3.steamusercontent.com/ugc/858355343478176189/9F708B25DB0EE25A89A93BE7D3F3C3FB9F6DF6EA/'\r\n  object.thickness = 0.30\r\n  token.setCustomObject(object)\r\n  token.setName('Blue Datapad')\r\n  token.setLuaScript(datapadScript)\r\n  token.lock()\r\n\r\n  if red == 1 then\r\n    startposition = {0,1.1,-10.38}\r\n  end\r\n\r\n  if red == 2 then\r\n    startposition = {-6.7,1.1,-10.38}\r\n  end\r\n\r\n  if red == 3 then\r\n    startposition = {-9.7,1.1,-10.38}\r\n  end\r\n\r\n  if red == 4 then\r\n    startposition = {-16.7,1.1,-10.38}\r\n  end\r\n\r\n  params.rotation = {0,180,0}\r\n  params.scale = {2.74,0,2.74}\r\n  object.image = 'http://cloud-3.steamusercontent.com/ugc/194046562276974641/B5CB1D9F2683C4F1FA6A053A67475E057CC989F7/'\r\n  object.thickness = 0.2\r\n  object.merge_distance = 5.0\r\n  for i=1,red do\r\n    params.position = {startposition[1]+(10.3*(i-1)),startposition[2],startposition[3]}\r\n    local spawner = spawnObject(params)\r\n    spawner.setCustomObject(object)\r\n    spawner.setName('Red')\r\n    spawner.setLuaScript(characterPlaymatScript)\r\n    spawner.lock()\r\n  end\r\n\r\n  params.position = {startposition[1]-8,1.1,-10.38}\r\n  params.scale = {1.88,0,1.88}\r\n  local spawner = spawnObject(params)\r\n  object.image = 'http://cloud-3.steamusercontent.com/ugc/194046562276975653/436A9517517DADEA3F5C9427E7E5EFB4F8844ACB/'\r\n  spawner.setCustomObject(object)\r\n  spawner.setName('Support Playmat')\r\n  spawner.setLuaScript(supportPlaymatScript)\r\n  spawner.lock()\r\n\r\n  params.position = {startposition[1]+(10.2*red),1.1,-10.21}\r\n  params.scale = {2.73, 1, 2.73}\r\n  token = spawnObject(params)\r\n  object.image = 'http://cloud-3.steamusercontent.com/ugc/858355343478176189/9F708B25DB0EE25A89A93BE7D3F3C3FB9F6DF6EA/'\r\n  object.thickness = 0.30\r\n  token.setCustomObject(object)\r\n  token.setName('Red Datapad')\r\n  token.setLuaScript(datapadScript)\r\n  token.lock()\r\n\r\n  coroutine.yield(0)\r\n  coroutine.yield(0)\r\n\r\n  setupObject.destruct()\r\n  self.destruct()\r\n\r\n  if starterGame == true then\r\n    startLuaCoroutine(self, 'spawnStarter')\r\n  end\r\n\r\n  return 1\r\nend\r\n\r\nfunction movePlayerBoards()\r\n  blueResourceZone.setPosition({-23.00, 2.51, 0.32})\r\n  blueBattlefieldZone.setPosition({-18.39, 2.51, 0.27})\r\n  blueMatZone.setPosition({4.82, 0.90, 10.20})\r\n  blueBoardsPrefab.setPosition({-20.85, 0.97, 10.05})\r\n\r\n  redResourceZone.setPosition({23.00, 2.51, -0.32})\r\n  redResourceZone.setRotation({0, 180, 0})\r\n  redBattlefieldZone.setPosition({18.39, 2.51, -0.27})\r\n  redBattlefieldZone.setRotation({0, 180, 0})\r\n  redMatZone.setPosition({-4.82, 0.90, -10.20})\r\n  redMatZone.setRotation({0, 180, 0})\r\n  redBoardsPrefab.setPosition({20.85, 0.97, -10.05})\r\n  redBoardsPrefab.setRotation({0, 0, 0})\r\n\r\n  Global.setVar(\"blueBoardsPrefab\", blueBoardsPrefab)\r\n  Global.setVar(\"blueResourceZone\", blueResourceZone)\r\n  Global.setVar(\"blueBattlefieldZone\", blueBattlefieldZone)\r\n  Global.setVar(\"blueMatZone\", blueMatZone)\r\n\r\n  Global.setVar(\"redBoardsPrefab\", redBoardsPrefab)\r\n  Global.setVar(\"redResourceZone\", redResourceZone)\r\n  Global.setVar(\"redBattlefieldZone\", redBattlefieldZone)\r\n  Global.setVar(\"redMatZone\", redMatZone)\r\nend\r\n\r\nfunction red1()\r\n  self.editButton({index=1,label='Red: 2 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=2,label='Red: 3 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=3,label='Red: 4 Characters',color={1,1,1},font_color={0,0,0}})\r\n  red = 1\r\n  self.editButton({index=0,label='!Red: 1 Character!',color={0.8,0.1,0.1},font_color={1,1,1}})\r\nend\r\n\r\nfunction red2()\r\n  self.editButton({index=0,label='Red: 1 Character',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=2,label='Red: 3 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=3,label='Red: 4 Characters',color={1,1,1},font_color={0,0,0}})\r\n  red = 2\r\n  self.editButton({index=1,label='!Red: 2 Characters!',color={0.8,0.1,0.1},font_color={1,1,1}})\r\nend\r\n\r\nfunction red3()\r\n  self.editButton({index=0,label='Red: 1 Character',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=1,label='Red: 2 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=3,label='Red: 4 Characters',color={1,1,1},font_color={0,0,0}})\r\n  red = 3\r\n  self.editButton({index=2,label='!Red: 3 Characters!',color={0.8,0.1,0.1},font_color={1,1,1}})\r\nend\r\n\r\nfunction red4()\r\n  self.editButton({index=0,label='Red: 1 Character',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=1,label='Red: 2 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=2,label='Red: 3 Characters',color={1,1,1},font_color={0,0,0}})\r\n  red = 4\r\n  self.editButton({index=3,label='!Red: 4 Characters!',color={0.8,0.1,0.1},font_color={1,1,1}})\r\nend\r\n\r\nfunction blue1()\r\n  self.editButton({index=5,label='Blue: 2 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=6,label='Blue: 3 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=7,label='Blue: 4 Characters',color={1,1,1},font_color={0,0,0}})\r\n  blue = 1\r\n  self.editButton({index=4,label='!Blue: 1 Character!',color={0.1,0.5,1.0},font_color={1,1,1}})\r\nend\r\n\r\nfunction blue2()\r\n  self.editButton({index=4,label='Blue: 1 Character',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=6,label='Blue: 3 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=7,label='Blue: 4 Characters',color={1,1,1},font_color={0,0,0}})\r\n  blue = 2\r\n  self.editButton({index=5,label='!Blue: 2 Characters!',color={0.1,0.5,1.0},font_color={1,1,1}})\r\nend\r\n\r\nfunction blue3()\r\n  self.editButton({index=4,label='Blue: 1 Character',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=5,label='Blue: 2 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=7,label='Blue: 4 Characters',color={1,1,1},font_color={0,0,0}})\r\n  blue = 3\r\n  self.editButton({index=6,label='!Blue: 3 Characters!',color={0.1,0.5,1.0},font_color={1,1,1}})\r\nend\r\n\r\nfunction blue4()\r\n  self.editButton({index=4,label='Blue: 1 Character',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=5,label='Blue: 2 Characters',color={1,1,1},font_color={0,0,0}})\r\n  self.editButton({index=6,label='Blue: 3 Characters',color={1,1,1},font_color={0,0,0}})\r\n  blue = 4\r\n  self.editButton({index=7,label='!Blue: 4 Characters!',color={0.1,0.5,1.0},font_color={1,1,1}})\r\nend\r\n\r\nfunction dbBack()\r\n  if spawnditems ~= nil then\r\n    for i in pairs(spawnditems) do\r\n      if getObjectFromGUID(spawnditems[i])!= nil then\r\n        getObjectFromGUID(spawnditems[i]).destruct()\r\n      end\r\n    end\r\n  end\r\n  local object = getObjectFromGUID('1cc719')\r\n  object.setPosition({28,2,2})\r\n  object.interactable=true\r\n  local object = getObjectFromGUID('cf8e15')\r\n  object.setPosition({28,4,2})\r\n  object.interactable=true\r\n\r\n  self.setPosition{0,1,0}\r\n  spawnditems={}\r\n  mainMenu()\r\n  affiliationselect='Hero'\r\n  affiliationselect2='Villain'\r\n  affiliationselect3='Neutral'\r\n  typeselect='Character'\r\n  typeselect2='Upgrade'\r\n  typeselect3='Support'\r\n  typeselect4='Event'\r\n  colorselect='Red'\r\n  colorselect2='Blue'\r\n  colorselect3='Yellow'\r\n  colorselect4='Gray'\r\n  battlefieldbutton=false\r\n  redbutton = false\r\n  bluebutton = false\r\n  yellowbutton = false\r\n  greybutton = false\r\n  charactersbutton = false\r\n  upgradesbutton = false\r\n  eventsbutton = false\r\n  supportsbutton = false\r\n  herobutton = false\r\n  villainbutton = false\r\n  neutralbutton = false\r\n\r\nend\r\n\r\nfunction redtokenclassic()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/194046562280483535/A29691412CEC7FDE752A603736EBB99405CC347B/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/194046562280484252/758430B535676DA603F0041356827EE9BD7B830A/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/194046562280485442/DA82F2C7D32BF37A2CB403635876FF96D7D1B0E8/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/194046562280484903/A696882BD4631043881D60F55CC823EE1FC7BE1D/\"\r\n  }\r\n  Global.setTable('tokenplayerone', token)\r\n  self.editButton({index=12,label='!Red: Classic!'})\r\n  self.editButton({index=9,label='Red: BrokenEgg LS'})\r\n  self.editButton({index=8,label='Red: BrokenEgg DS'})\r\nend\r\n\r\nfunction bluetokenclassic()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/194046562280483535/A29691412CEC7FDE752A603736EBB99405CC347B/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/194046562280484252/758430B535676DA603F0041356827EE9BD7B830A/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/194046562280485442/DA82F2C7D32BF37A2CB403635876FF96D7D1B0E8/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/194046562280484903/A696882BD4631043881D60F55CC823EE1FC7BE1D/\"\r\n  }\r\n  Global.setTable('tokenplayertwo', token)\r\n  self.editButton({index=13,label='!Blue: Classic!'})\r\n  self.editButton({index=10,label='Blue: BrokenEgg LS'})\r\n  self.editButton({index=11,label='Blue: BrokenEgg DS'})\r\nend\r\n\r\nfunction redtokenls()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/138878581189337871/63224277C5E0CCD81E5623C78329C2B053801F5B/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/138878581189338583/F235212117B6FD1BB4FC4B043F0EC9DAF569F524/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/138878581189344376/524AA619CACA1109F1B0A469C9C9859A364F86BD/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/138878581189343694/82BE715910B90A4A5569BAD0DB945B283CAEB1E1/\"\r\n  }\r\n  Global.setTable('tokenplayerone', token)\r\n  self.editButton({index=12,label='Red: Classic'})\r\n  self.editButton({index=9,label='!Red: BrokenEgg LS!'})\r\n  self.editButton({index=8,label='Red: BrokenEgg DS'})\r\nend\r\n\r\nfunction redtokends()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/138878581189341027/478EF1F25A98207586F29710DEDA956B5CC5C798/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/138878581189342765/9149CFBF36AF9E1B58B348527545B95653B90BF5/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/138878581189340289/234BB8378F5AF4E842976CBA8AD0C14F7246E13B/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/138878581189339560/A134B915FD6DD175F8056A5C808B11AD5F73230A/\"\r\n  }\r\n  Global.setTable('tokenplayerone', token)\r\n  self.editButton({index=12,label='Red: Classic'})\r\n  self.editButton({index=9,label='Red: BrokenEgg LS'})\r\n  self.editButton({index=8,label='!Red: BrokenEgg DS!'})\r\nend\r\n\r\nfunction bluetokenls()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/138878581189337871/63224277C5E0CCD81E5623C78329C2B053801F5B/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/138878581189338583/F235212117B6FD1BB4FC4B043F0EC9DAF569F524/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/138878581189344376/524AA619CACA1109F1B0A469C9C9859A364F86BD/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/138878581189343694/82BE715910B90A4A5569BAD0DB945B283CAEB1E1/\"\r\n  }\r\n  Global.setTable('tokenplayertwo', token)\r\n  self.editButton({index=13,label='Blue: Classic'})\r\n  self.editButton({index=10,label='!Blue: BrokenEgg LS!'})\r\n  self.editButton({index=11,label='Blue: BrokenEgg DS'})\r\nend\r\n\r\nfunction bluetokends()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/138878581189341027/478EF1F25A98207586F29710DEDA956B5CC5C798/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/138878581189342765/9149CFBF36AF9E1B58B348527545B95653B90BF5/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/138878581189340289/234BB8378F5AF4E842976CBA8AD0C14F7246E13B/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/138878581189339560/A134B915FD6DD175F8056A5C808B11AD5F73230A/\"\r\n  }\r\n  Global.setTable('tokenplayertwo', token)\r\n  self.editButton({index=13,label='Blue: Classic'})\r\n  self.editButton({index=10,label='Blue: BrokenEgg LS'})\r\n  self.editButton({index=11,label='!Blue: BrokenEgg DS!'})\r\nend\r\n\r\nfunction redtokentcsaga()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/102851052181836065/6DD94520F5D424BBF0F9E0FABCF8FD22305BCA36/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/102851052181834275/A6699914EDB3C0F45CEBBC6C0C3E90DA28E96E26/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/102851052181842011/05D809854B7D3788095964674BED5C1BFC0407E7/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/102851052181837876/FBB02E7AB22AD194A4E1023E3D2F3E3615F72B26/\"\r\n  }\r\n  Global.setTable('tokenplayerone', token)\r\n  self.editButton({index=12,label='Red: Classic'})\r\n  self.editButton({index=9,label='Red: BrokenEgg LS'})\r\n  self.editButton({index=8,label='Red: BrokenEgg DS'})\r\n  self.editButton({index=14, label = '!Red: TC Saga!'})\r\nend\r\n\r\nfunction bluetokentcsaga()\r\n  token = {\r\n    damageone = \"http://cloud-3.steamusercontent.com/ugc/102851052181836065/6DD94520F5D424BBF0F9E0FABCF8FD22305BCA36/\",\r\n    damagethree = \"http://cloud-3.steamusercontent.com/ugc/102851052181834275/A6699914EDB3C0F45CEBBC6C0C3E90DA28E96E26/\",\r\n    shield = \"http://cloud-3.steamusercontent.com/ugc/102851052181842011/05D809854B7D3788095964674BED5C1BFC0407E7/\",\r\n    resource = \"http://cloud-3.steamusercontent.com/ugc/102851052181837876/FBB02E7AB22AD194A4E1023E3D2F3E3615F72B26/\"\r\n  }\r\n  Global.setTable('tokenplayertwo', token)\r\n  self.editButton({index=13,label='Blue: Classic'})\r\n  self.editButton({index=10,label='Blue: BrokenEgg LS'})\r\n  self.editButton({index=11,label='Blue: BrokenEgg DS'})\r\n  self.editButton({index=15, label ='!Blue: TC Saga!'})\r\nend",
      "LuaScriptState": "",
      "GUID": "2a325b"
    },
    {
      "Name": "Bag",
      "Transform": {
        "posX": 28.2207336,
        "posY": 0.85572505,
        "posZ": -23.4491425,
        "rotX": 9.675108E-06,
        "rotY": -0.001646209,
        "rotZ": 8.25912048E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "Setup",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.08694846,
        "b": 0.7019608
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "MaterialIndex": -1,
      "MeshIndex": -1,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "ContainedObjects": [
        {
          "Name": "Custom_Assetbundle",
          "Transform": {
            "posX": 28.2813568,
            "posY": 3.160583,
            "posZ": -19.1390324,
            "rotX": 359.94635,
            "rotY": 179.982758,
            "rotZ": 0.00184718391,
            "scaleX": 1.0,
            "scaleY": 1.0,
            "scaleZ": 1.0
          },
          "Nickname": "",
          "Description": "",
          "ColorDiffuse": {
            "r": 1.0,
            "g": 1.0,
            "b": 1.0
          },
          "Locked": false,
          "Grid": true,
          "Snap": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "Hands": false,
          "CustomAssetbundle": {
            "AssetbundleURL": "http://cloud-3.steamusercontent.com/ugc/981107696137337890/52ED7D129EDE018FA5FF46D57D2FA7A73F1D8B13/",
            "AssetbundleSecondaryURL": "",
            "MaterialIndex": 3,
            "TypeIndex": 4,
            "LoopingEffectIndex": 0
          },
          "XmlUI": "",
          "LuaScript": "",
          "LuaScriptState": "",
          "GUID": "4e185d"
        },
        {
          "Name": "Custom_Assetbundle",
          "Transform": {
            "posX": 27.8796749,
            "posY": 3.03731585,
            "posZ": -22.7883434,
            "rotX": 358.509979,
            "rotY": 180.0254,
            "rotZ": 358.209717,
            "scaleX": 1.0,
            "scaleY": 1.0,
            "scaleZ": 1.0
          },
          "Nickname": "",
          "Description": "",
          "ColorDiffuse": {
            "r": 1.0,
            "g": 1.0,
            "b": 1.0
          },
          "Locked": false,
          "Grid": true,
          "Snap": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "Hands": false,
          "CustomAssetbundle": {
            "AssetbundleURL": "http://cloud-3.steamusercontent.com/ugc/981107696137337890/52ED7D129EDE018FA5FF46D57D2FA7A73F1D8B13/",
            "AssetbundleSecondaryURL": "",
            "MaterialIndex": 3,
            "TypeIndex": 4,
            "LoopingEffectIndex": 0
          },
          "XmlUI": "",
          "LuaScript": "",
          "LuaScriptState": "",
          "GUID": "59f7a8"
        },
        {
          "Name": "Custom_Assetbundle",
          "Transform": {
            "posX": 27.8037167,
            "posY": 3.1614542,
            "posZ": -19.93378,
            "rotX": 359.9485,
            "rotY": 179.982819,
            "rotZ": 359.985382,
            "scaleX": 1.0,
            "scaleY": 1.0,
            "scaleZ": 1.0
          },
          "Nickname": "",
          "Description": "",
          "ColorDiffuse": {
            "r": 1.0,
            "g": 1.0,
            "b": 1.0
          },
          "Locked": false,
          "Grid": true,
          "Snap": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "Hands": false,
          "CustomAssetbundle": {
            "AssetbundleURL": "http://cloud-3.steamusercontent.com/ugc/981107696137349742/C2EB29A919F5DEB3B64CD12FD91A3A27B5E3452C/",
            "AssetbundleSecondaryURL": "",
            "MaterialIndex": 3,
            "TypeIndex": 4,
            "LoopingEffectIndex": 0
          },
          "XmlUI": "",
          "LuaScript": "",
          "LuaScriptState": "",
          "GUID": "d70420"
        },
        {
          "Name": "Custom_Assetbundle",
          "Transform": {
            "posX": 28.0924568,
            "posY": 3.16125774,
            "posZ": -20.0223923,
            "rotX": 359.9439,
            "rotY": 180.000015,
            "rotZ": -0.00504263351,
            "scaleX": 1.0,
            "scaleY": 1.0,
            "scaleZ": 1.0
          },
          "Nickname": "",
          "Description": "",
          "ColorDiffuse": {
            "r": 1.0,
            "g": 1.0,
            "b": 1.0
          },
          "Locked": false,
          "Grid": true,
          "Snap": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "Hands": false,
          "CustomAssetbundle": {
            "AssetbundleURL": "http://cloud-3.steamusercontent.com/ugc/981107696137349742/C2EB29A919F5DEB3B64CD12FD91A3A27B5E3452C/",
            "AssetbundleSecondaryURL": "",
            "MaterialIndex": 3,
            "TypeIndex": 4,
            "LoopingEffectIndex": 0
          },
          "XmlUI": "",
          "LuaScript": "",
          "LuaScriptState": "",
          "GUID": "7c57f9"
        }
      ],
      "GUID": "771f25"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": 0.461879253,
        "posY": -4.0,
        "posZ": 21.35,
        "rotX": 0.0,
        "rotY": 180.1666,
        "rotZ": 0.0,
        "scaleX": 3.54285669,
        "scaleY": 5.1,
        "scaleZ": 4.88571167
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "645473"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": -18.9717,
        "posY": -4.0,
        "posZ": 21.35,
        "rotX": 0.0,
        "rotY": 180.1666,
        "rotZ": 0.0,
        "scaleX": 3.59048,
        "scaleY": 5.1,
        "scaleZ": 4.895238
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "f05de1"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": -21.36,
        "posY": -4.0,
        "posZ": 0.57,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 3.36,
        "scaleY": 5.1,
        "scaleZ": 4.82
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "b99e98"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": -21.3792725,
        "posY": -4.0,
        "posZ": -18.72,
        "rotX": 0.0,
        "rotY": 89.86952,
        "rotZ": 0.0,
        "scaleX": 3.361902,
        "scaleY": 5.1,
        "scaleZ": 4.819045
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "a2c916"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": -0.3206861,
        "posY": -4.0,
        "posZ": -21.33,
        "rotX": 0.0,
        "rotY": 359.9056,
        "rotZ": 0.0,
        "scaleX": 3.52380967,
        "scaleY": 5.1,
        "scaleZ": 5.038093
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "e88ebb"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": 18.8083763,
        "posY": -4.0,
        "posZ": -21.35,
        "rotX": 0.0,
        "rotY": 359.9056,
        "rotZ": 0.0,
        "scaleX": 3.50476217,
        "scaleY": 5.1,
        "scaleZ": 4.990475
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "6c8d53"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": 21.3631382,
        "posY": -4.0,
        "posZ": -0.39,
        "rotX": 0.0,
        "rotY": 270.0,
        "rotZ": 0.0,
        "scaleX": 3.59047651,
        "scaleY": 5.1,
        "scaleZ": 5.019044
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "54b60a"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": 21.3508644,
        "posY": -4.0,
        "posZ": 18.84,
        "rotX": 0.0,
        "rotY": 269.9416,
        "rotZ": 0.0,
        "scaleX": 3.48571348,
        "scaleY": 5.1,
        "scaleZ": 4.971431
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "f43f15"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -24.89,
        "posY": 0.0,
        "posZ": 0.57,
        "rotX": 5.230607E-07,
        "rotY": 0.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "2a267a"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -24.7847538,
        "posY": 0.0,
        "posZ": -18.73,
        "rotX": -7.0777574E-08,
        "rotY": 0.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "7b408b"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -0.5507741,
        "posY": 0.0,
        "posZ": -24.8,
        "rotX": 1.68098939E-08,
        "rotY": 269.999969,
        "rotZ": -6.262512E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "0b4f1d"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 18.8316383,
        "posY": 0.0,
        "posZ": -24.81,
        "rotX": 7.700349E-07,
        "rotY": 270.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "bbd437"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 24.7203217,
        "posY": 0.0,
        "posZ": -0.56,
        "rotX": -9.543762E-07,
        "rotY": 180.0,
        "rotZ": -2.42415524E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "623f55"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 24.7197952,
        "posY": 0.0,
        "posZ": 18.71,
        "rotX": -6.90110156E-08,
        "rotY": 180.0,
        "rotZ": 1.65652557E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "61ba3d"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 0.6096389,
        "posY": 0.0,
        "posZ": 24.69,
        "rotX": -6.82031668E-07,
        "rotY": 90.0143661,
        "rotZ": 2.79309E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "6214b1"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -18.7677021,
        "posY": 0.0,
        "posZ": 24.67,
        "rotX": 1.3553755E-06,
        "rotY": 90.0,
        "rotZ": 1.879818E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.75
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 3,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "71f70f"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 12.48,
        "posY": 0.05,
        "posZ": 15.91,
        "rotX": 7.23594056E-08,
        "rotY": 0.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "38f77f"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -6.49,
        "posY": 0.05,
        "posZ": 15.76,
        "rotX": -1.89974583E-06,
        "rotY": 0.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "e603b5"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -15.84,
        "posY": 0.05,
        "posZ": 12.53,
        "rotX": -6.36157658E-15,
        "rotY": 270.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "7a43ac"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -15.9068975,
        "posY": 0.05000309,
        "posZ": -6.43,
        "rotX": 1.0672953E-07,
        "rotY": 270.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "25c131"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -12.5,
        "posY": 0.05,
        "posZ": -15.75,
        "rotX": -3.18055514E-15,
        "rotY": 180.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "301d4c"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 5.883453,
        "posY": 0.05,
        "posZ": -15.79,
        "rotX": 5.97726455E-08,
        "rotY": 180.0,
        "rotZ": -1.82937833E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "41c691"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 15.868433,
        "posY": 0.05,
        "posZ": -12.64,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "79e39b"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 15.859931,
        "posY": 0.05,
        "posZ": 6.52,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "dfd6c9"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": 14.0095177,
        "posY": -4.0,
        "posZ": -0.4,
        "rotX": 0.0,
        "rotY": 178.800415,
        "rotZ": 0.0,
        "scaleX": 5.78690052,
        "scaleY": 5.1,
        "scaleZ": 6.930016
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "2410f1"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 15.3600616,
        "posY": 0.0,
        "posZ": 19.43,
        "rotX": 3.26831433E-08,
        "rotY": 180.006882,
        "rotZ": 1.76297829E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "6d097a"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -3.86651635,
        "posY": 0.0,
        "posZ": 19.36,
        "rotX": -8.446605E-08,
        "rotY": 180.006912,
        "rotZ": -4.973686E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "4297fe"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -19.514349,
        "posY": 0.0,
        "posZ": 15.21,
        "rotX": 7.33988031E-07,
        "rotY": 180.006866,
        "rotZ": -2.3123124E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "41b6c1"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -19.3618183,
        "posY": 0.0,
        "posZ": -3.88,
        "rotX": -4.75480419E-07,
        "rotY": 180.006882,
        "rotZ": 1.5822967E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "795944"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -15.3166609,
        "posY": 0.0,
        "posZ": -19.43,
        "rotX": -2.847319E-07,
        "rotY": 180.0069,
        "rotZ": -1.25988356E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "cb63fc"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 3.90992475,
        "posY": 0.0,
        "posZ": -19.37,
        "rotX": 6.79858658E-07,
        "rotY": 180.006851,
        "rotZ": 1.31521892E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "78a6a5"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 19.4269314,
        "posY": 0.0,
        "posZ": -15.35,
        "rotX": -1.26768975E-06,
        "rotY": 180.006882,
        "rotZ": 3.60857371E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "f5eeef"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 19.3819122,
        "posY": 0.0,
        "posZ": 3.9,
        "rotX": -9.869159E-07,
        "rotY": 180.006882,
        "rotZ": -7.16987358E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "f61d1d"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 9.869081,
        "posY": 0.0,
        "posZ": 20.87,
        "rotX": -4.697698E-08,
        "rotY": 180.006882,
        "rotZ": -2.07636231E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "0bd257"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -9.690492,
        "posY": 0.0,
        "posZ": 20.79,
        "rotX": -7.913751E-09,
        "rotY": 180.006882,
        "rotZ": -3.23060959E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "7a0028"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -21.2908115,
        "posY": 0.0,
        "posZ": 9.8,
        "rotX": -1.03875006E-08,
        "rotY": 180.006882,
        "rotZ": -8.72458429E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "1cf0d6"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -21.1795483,
        "posY": 0.0,
        "posZ": -9.67,
        "rotX": -1.03875006E-08,
        "rotY": 180.006882,
        "rotZ": -8.72458429E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "90cb62"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -9.870503,
        "posY": 0.0,
        "posZ": -21.14,
        "rotX": 2.528862E-09,
        "rotY": 180.006882,
        "rotZ": -2.43028171E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "750faf"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 9.562408,
        "posY": 0.0,
        "posZ": -21.37,
        "rotX": 2.528862E-09,
        "rotY": 180.006882,
        "rotZ": -2.43028171E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "cf5444"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 21.0011158,
        "posY": 0.0,
        "posZ": -9.66,
        "rotX": 2.528862E-09,
        "rotY": 180.006882,
        "rotZ": -2.43028171E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "bab556"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 20.8961887,
        "posY": 0.0,
        "posZ": 9.7,
        "rotX": 2.528862E-09,
        "rotY": 180.006882,
        "rotZ": -2.43028171E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "3da4dc"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -9.500001,
        "posY": -4.0,
        "posZ": 0.0,
        "rotX": 4.14959572E-07,
        "rotY": 359.9705,
        "rotZ": 2.05408767E-07,
        "scaleX": 5.1,
        "scaleY": 1.0,
        "scaleZ": 5.1
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929299235976128120/FE91A02EB870D4194B9C638EBCE8ABB68D7EC21A/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929299235976128120/FE91A02EB870D4194B9C638EBCE8ABB68D7EC21A/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "c51c41"
    },
    {
      "Name": "Card",
      "Transform": {
        "posX": 0.0,
        "posY": -4.5,
        "posZ": 0.0,
        "rotX": 0.0,
        "rotY": -2.0627333E-06,
        "rotZ": 180.0,
        "scaleX": 1.42055011,
        "scaleY": 1.0,
        "scaleZ": 1.42055011
      },
      "Nickname": "Boba Fett, Deadly Mercenary",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.713235259,
        "g": 0.713235259,
        "b": 0.713235259
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": true,
      "Hands": true,
      "CardID": 47118,
      "SidewaysCard": false,
      "CustomDeck": {
        "471": {
          "FaceURL": "http://cloud-3.steamusercontent.com/ugc/910157197471550653/076BC0D620476AEDF1A7EE10CEE97A03F3E06C72/",
          "BackURL": "http://cloud-3.steamusercontent.com/ugc/102850418890247821/C495C2DA41D081A5CD513AC62BE8F69775DC5ADB/",
          "NumWidth": 10,
          "NumHeight": 7,
          "BackIsHidden": true,
          "UniqueBack": false
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "72db11"
    },
    {
      "Name": "ScriptingTrigger",
      "Transform": {
        "posX": -9.5,
        "posY": -4.0,
        "posZ": 0.0,
        "rotX": 0.0,
        "rotY": 179.8,
        "rotZ": 0.0,
        "scaleX": 5.0,
        "scaleY": 5.0,
        "scaleZ": 6.0
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "b9d302"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 0.0,
        "posY": -2.43,
        "posZ": 0.0,
        "rotX": 0.0,
        "rotY": 3.616717E-05,
        "rotZ": 2.42151827E-07,
        "scaleX": 4.4,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040478/9924A580FBDB436B0A1C194560E852CA6ADE5F9A/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040478/9924A580FBDB436B0A1C194560E852CA6ADE5F9A/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "Rigidbody": {
        "Mass": 1.0,
        "Drag": 0.1,
        "AngularDrag": 0.1,
        "UseGravity": false
      },
      "GUID": "251e70"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": -11.57,
        "posY": 200.0,
        "posZ": 23.71,
        "rotX": 0.0,
        "rotY": 180.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.191999972,
        "g": 0.701,
        "b": 0.167999953
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Green",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "64ea2a"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": 23.71,
        "posY": 200.0,
        "posZ": 11.57,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.627,
        "g": 0.124999978,
        "b": 0.941
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Purple",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "db8bab"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": -23.71,
        "posY": 200.0,
        "posZ": 7.51,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.905,
        "g": 0.898,
        "b": 0.171999961
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Yellow",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "0c446e"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": 23.71,
        "posY": 200.0,
        "posZ": -7.51,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.96,
        "g": 0.438999981,
        "b": 0.807
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Pink",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "bb0332"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": -23.71,
        "posY": 200.0,
        "posZ": -11.57,
        "rotX": 0.0,
        "rotY": 90.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.9559999,
        "g": 0.39199996,
        "b": 0.112999953
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Orange",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "19c306"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": -7.51,
        "posY": 200.0,
        "posZ": -23.71,
        "rotX": 0.0,
        "rotY": 0.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.856,
        "g": 0.09999997,
        "b": 0.09399996
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Red",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "aeedb8"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": 11.57,
        "posY": 200.0,
        "posZ": -23.71,
        "rotX": 0.0,
        "rotY": 0.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "White",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "5aa86f"
    },
    {
      "Name": "FogOfWarTrigger",
      "Transform": {
        "posX": 7.51,
        "posY": 200.0,
        "posZ": 23.71,
        "rotX": 0.0,
        "rotY": 180.0,
        "rotZ": 0.0,
        "scaleX": 18.75,
        "scaleY": 60.0,
        "scaleZ": 13.12
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.117999978,
        "g": 0.53,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "FogColor": "Blue",
      "FogHidePointers": true,
      "FogReverseHiding": false,
      "FogSeethrough": false,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "0b4a6e"
    },
    {
      "Name": "Bag",
      "Transform": {
        "posX": 28.09,
        "posY": 0.8597871,
        "posZ": 0.7900001,
        "rotX": -4.158811E-06,
        "rotY": 4.1327974E-05,
        "rotZ": 3.93534748E-07,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "Trash",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "MaterialIndex": -1,
      "MeshIndex": -1,
      "Number": 0,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "dbae5f"
    },
    {
      "Name": "Bag",
      "Transform": {
        "posX": -28.09,
        "posY": 0.859797835,
        "posZ": 0.79,
        "rotX": -2.034384E-07,
        "rotY": 6.71679663E-06,
        "rotZ": 2.9948776E-06,
        "scaleX": 1.0,
        "scaleY": 1.0,
        "scaleZ": 1.0
      },
      "Nickname": "Trash",
      "Description": "",
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "MaterialIndex": -1,
      "MeshIndex": -1,
      "Number": 0,
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "a5d1bd"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -9.734747,
        "posY": -4.0,
        "posZ": 21.42,
        "rotX": -1.62482451E-07,
        "rotY": -2.60463321E-06,
        "rotZ": 4.030845E-08,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/920304477969141605/5D7397B74461A96CD86F438129FCDC0B1AA0A9D4/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "ab8055"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 9.687189,
        "posY": -4.0,
        "posZ": 21.46,
        "rotX": 3.16515923E-07,
        "rotY": 0.000479842944,
        "rotZ": 1.27796469E-07,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/948454511079982384/AC0ADA96B12CD5E88E75EEB109E8E6B548857ACD/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "2cdefc"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 21.5262585,
        "posY": -4.0,
        "posZ": 9.61,
        "rotX": 2.87574551E-07,
        "rotY": 89.99999,
        "rotZ": 2.30263382E-07,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/919177062067046601/96ECA6342810F724B1ED851D101C754917D04FBD/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "e51074"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 21.5263577,
        "posY": -4.0,
        "posZ": -9.66,
        "rotX": -5.56834934E-08,
        "rotY": 89.99999,
        "rotZ": -1.659173E-07,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/919177062067046601/96ECA6342810F724B1ED851D101C754917D04FBD/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "5dc222"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": 9.59724,
        "posY": -4.0,
        "posZ": -21.46,
        "rotX": -3.97601241E-08,
        "rotY": 180.0,
        "rotZ": -4.687832E-08,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/920304477969141605/5D7397B74461A96CD86F438129FCDC0B1AA0A9D4/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "96f199"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -9.573119,
        "posY": -4.0,
        "posZ": -21.51,
        "rotX": -1.16106875E-08,
        "rotY": 180.0,
        "rotZ": -1.68988787E-08,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/920304477969141605/5D7397B74461A96CD86F438129FCDC0B1AA0A9D4/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "772bad"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -21.4658031,
        "posY": -4.0,
        "posZ": -9.57,
        "rotX": 4.293299E-07,
        "rotY": 269.999969,
        "rotZ": 2.523028E-07,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/920304477969169845/95318949E96B74FA31C108524A6C0DB4380C05B2/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "737a7e"
    },
    {
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -21.4643822,
        "posY": -4.0,
        "posZ": 9.69,
        "rotX": 8.55304236E-08,
        "rotY": 270.000122,
        "rotZ": -3.03143651E-07,
        "scaleX": 4.3,
        "scaleY": 1.0,
        "scaleZ": 4.4
      },
      "Nickname": "",
      "Description": "",
      "ColorDiffuse": {
        "r": 0.0,
        "g": 0.0,
        "b": 0.0
      },
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "http://cloud-3.steamusercontent.com/ugc/952959191178358429/AE3BB1947C78495EA4EC63FA58B116A55E116310/",
        "ImageSecondaryURL": "http://cloud-3.steamusercontent.com/ugc/929298615327040766/66B65CA4C09B2F0C563562C506EA1B81805F2803/",
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.1,
          "Stackable": false,
          "Stretch": true
        }
      },
      "XmlUI": "",
      "LuaScript": "",
      "LuaScriptState": "",
      "GUID": "827083"
    }
  ],
  "DecalPallet": [],
  "TabStates": {
    "0": {
      "title": "Notes",
      "body": "(formerly Star Wars Destiny Super Draft - Scripted)\r\n\r\n===========\r\nSUMMARY\r\n===========\r\n\r\nThis is a Destiny mod that supports several scripted draft/sealed modes, branching from IceKobra's great mod ([url=www.steamcommunity.com/sharedfiles/filedetails/?id=764462825][/url]).  I like drafting in real life for Star Wars Destiny, and I used this as a learning project for Tabletop Simulator scripting and Lua.\r\n\r\nThis mod:\r\n* Includes all Destiny cards for normal 2-player games.\r\n* In draft mode, generates 2 boxes of cards from each expansion with normal legendary distribution (6 legendaries, no duplicate legendaries in a box).\r\n* Supports packs from multiple expansions in a single draft.\r\n* Supports the Rivals draft format for up to 8 players.\r\n* Supports the Rivals sealed format for up to 8 players.\r\n* Supports a custom Winchester draft format for 2 players only.\r\n* Supports cube drafting with the Rivals draft format for up to 8 players.\r\n* Provides basic hidden areas in case players want to deckbuild without leaving the room.\r\n\r\nBut, this mod:\r\n* Does NOT save your deck for you.  You must right click and save your deck.\r\n* Does NOT support seamlessly playing Destiny after your decks are ready.  You probably want to split into multiple rooms for that.\r\n* Does NOT support cubes that contain starter set cards.\r\n* Does NOT provide any pre-built cube decks.\r\n\r\n\r\n=========\r\nRULES\r\n=========\r\n\r\nIf you already know Rivals draft rules well, skip ahead to \"INSTRUCTIONS\".\r\n\r\nDraft/sealed gives you 20 Rivals cards and some extra cards (30 for normal/cube, 40 for sealed, variable for Winchester).  You then take the cards and build decks using these rules:\r\n\r\n* You MUST follow the color rule, as usual (no red cards without a red character, no blue cards without a blue character, etc.).\r\n* You MUST follow the 30-point rule, as usual (no more than 30 points for plot/characters per team).\r\n* You MUST use no more than 1 plot, as usual.\r\n* You MUST follow the unique character rules, as usual (no more than 1 of the same unique character per player).\r\n* You MUST follow the unique card rules, as usual (no more than 1 of of the same unique card in play per player).\r\n\r\n* You MAY make your deck 20-30 cards instead of the normal 30 (this is inclusive, so 20, 24, and 30 are all valid possibilities).\r\n* You MAY mix hero, villain, and neutral characters in the same team.\r\n* You MAY mix hero, villain, and neutral cards in the same deck.\r\n* You MAY include include 3 or more copies of cards in the same deck instead of just 2, if you have that many available.\r\n* You MAY change your character, plot, battlefield, and/or deck between games, using your available cards.\r\n\r\n* You CANNOT use anything you were not given in draft/sealed (no elite characters without having two copies, no ID9 dice for free, etc.)\r\n\r\n\r\n================\r\nINSTRUCTIONS\r\n================\r\n\r\nIMPORTANT:  If anyone stands up or sits down after setup, things may get out of sync.  Please sit down before starting.\r\n\r\n\r\nNormal Draft:\r\n* Players can sit anywhere they want.\r\n* For this mode, each player is given the Rivals set (20 cards).  These go on the playmat.\r\n* For this mode, each player is given 3 packs (15 cards) in round 1.  These go in the \"Cards\" stack.\r\n* Dice spawn for the 3 dice cards each player initially has.  These dice do not move for the rest of the draft.\r\n* Players are NOT allowed to look at cards other players have on their stack or playmat, but they can look at any dice.\r\n* At their own speed, each player does these steps:\r\n  1. Right clicks and searches their \"Cards\" stack.\r\n  2. Drags a card of their choice out of the search window onto their playmat.\r\n  3. Closes the search and clicks Pass, which will automatically pass cards left.\r\n* If you get a message that someone is not ready, wait and click Pass again.\r\n* If you get a message to pass a certain number of cards, you might have taken too few or too many.  Fix it and click Pass again.\r\n* Once every player has 15 cards and clicks \"Done\", 15 more cards are handed out.  This time, cards automatically pass right.\r\n* After everyone clicks \"Done\" in the second round, everyone must flip and drag their Rivals decks onto their drafted decks.\r\n* After all cards are taken, everyone must right click and save their decks.\r\n\r\n\r\nWinchester Draft:\r\n* This is an experimental draft mode that only supports 2 players.\r\n* For this mode, each player is given 8 packs (40 cards) in facedown piles.  These cannot be searched.\r\n* A random player is selected to pick first.\r\n* For each turn, the following happens:\r\n  1. Each facedown pile automatically deals 2 cards to the table.  This produces 4 zones of cards.\r\n  2. The current player then clicks a \"Take\" button to draft all cards in the corresponding zone.\r\n  3. It is now the next player's turn.\r\n* Note that as the draft continues, some zones will grow in size unevenly until they are finally taken.\r\n* After all cards are taken, everyone must right click and save their decks.\r\n\r\n\r\nCube Draft:\r\n* This is the same as Normal Draft, but a cube deck must be dragged onto the \"Cube\" board before starting.\r\n* Please be familiar with drafting rules and how the mod works before you try this mode.\r\n* If you do something truly crazy like a cube of all rares and legendaries, please use every other seat (4 players suggested max).\r\n\r\n\r\nSealed Game:\r\n* For this mode, each player is given the Rivals set (20 cards).  These go directly to the \"Cards\" stack.\r\n* Each player is also given 8 packs (40 cards).  These also go in the \"Cards\" stack.\r\n* After all cards are generated, everyone must right click and save their decks.\r\n\r\n\r\n=========\r\nNOTES\r\n=========\r\n\r\nAfter drafting, color-coded zones are created.  If you like, you can move the camera inside your zone to deckbuild without the zone coloring your view.\r\n\r\nPacks chosen using the \"Mix Expansions\" option will be drafted in order.\r\n\r\nIf anyone stands up or sits down after setup, things may get out of sync.\r\nIf players interact with cards while draft or sealed packs are generating, things may get out of sync.\r\nIf a cube deck with too few cards is used, error(s) may occur.\r\n\r\nCube drafting generates 1 rare/legendary, 1 uncommon, and 3 commons per pack.  These substitutions are used:\r\n  If a common is not found, an uncommon will be substituted, or failing that a rare/legendary.\r\n  If an uncommon is not found, a common will be substituted, or failing that a rare/legendary.\r\n  If a rare/legendary is not found, an uncommon will be substituted, or failing that a common.\r\n\r\nIf a crazy cube is used (e.g. all legendaries), 4 players max are recommended and using every other seat.  Otherwise, dice may overlap.\r\n\r\nCube drafting for more than 4 players has NOT been tested.  Please let me know if you have any problems besides dice overlap.\r\n\r\n\r\n===========\r\nCREDITS\r\n===========\r\n\r\nStar Wars Destiny properties are owned by Disney and FFG.  No infringement is intended, and no profit is made.\r\n\r\nMod based on IceKobra's mod, huge thanks for their work.\r\n\r\nPlaymats by permission of Artificery.com, thehyperloops.com, facebook.com/IRebelDestiny, facebook.com/goldendicepodcast, facebook.com/knightsofrenpodcast, and irafay.com/DestinyLeague/.\r\n\r\nTabletop image by permission of buddingmonkey.\r\n\r\nSpecial thanks:\r\n\r\n  * IceKobra\r\n  * Pearl Yeti\r\n  * Agent of Zion\r\n  * TheDrProfessor\r\n  * XeroHour\r\n  * Gnars\r\n  * jstevenson\r\n  * Neblix\r\n  * Daigoro\r\n  * Lando\r\n  * Lasci\r\n  * Lityk\r\n  * FenrirG\r\n  * Stealthmoose\r\n  * Spoonman\r\n  * Gameslayer989\r\n  * Nerf Herder\r\n  * Inception\r\n  * mercviper\r\n  * zulux21\r\n  * XShagrath\r\n  * Boat Times\r\n  * Kr0ozin\r\n  * thegandork\r\n  * wiwwt\r\n  * Vika\r\n  * Skillet M\r\n  * HonestlySarcastc\r\n  * Gonzo\r\n  * ussgordoncaptain\r\n  * lev\r\n  * Locoparentus\r\n  * Destiny Down Under\r\n  * buddingmonkey\r\n  * swdestinydb.com\r\n\r\n\r\n",
      "color": "Grey",
      "visibleColor": {
        "r": 0.5,
        "g": 0.5,
        "b": 0.5
      },
      "id": 0
    },
    "1": {
      "title": "White",
      "body": "",
      "color": "White",
      "visibleColor": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "id": 1
    },
    "2": {
      "title": "Brown",
      "body": "",
      "color": "Brown",
      "visibleColor": {
        "r": 0.443,
        "g": 0.231,
        "b": 0.09
      },
      "id": 2
    },
    "3": {
      "title": "Red",
      "body": "",
      "color": "Red",
      "visibleColor": {
        "r": 0.856,
        "g": 0.1,
        "b": 0.094
      },
      "id": 3
    },
    "4": {
      "title": "Orange",
      "body": "",
      "color": "Orange",
      "visibleColor": {
        "r": 0.956,
        "g": 0.392,
        "b": 0.113
      },
      "id": 4
    },
    "5": {
      "title": "Yellow",
      "body": "",
      "color": "Yellow",
      "visibleColor": {
        "r": 0.905,
        "g": 0.898,
        "b": 0.172
      },
      "id": 5
    },
    "6": {
      "title": "Green",
      "body": "",
      "color": "Green",
      "visibleColor": {
        "r": 0.192,
        "g": 0.701,
        "b": 0.168
      },
      "id": 6
    },
    "7": {
      "title": "Blue",
      "body": "",
      "color": "Blue",
      "visibleColor": {
        "r": 0.118,
        "g": 0.53,
        "b": 1.0
      },
      "id": 7
    },
    "8": {
      "title": "Teal",
      "body": "",
      "color": "Teal",
      "visibleColor": {
        "r": 0.129,
        "g": 0.694,
        "b": 0.607
      },
      "id": 8
    },
    "9": {
      "title": "Purple",
      "body": "",
      "color": "Purple",
      "visibleColor": {
        "r": 0.627,
        "g": 0.125,
        "b": 0.941
      },
      "id": 9
    },
    "10": {
      "title": "Pink",
      "body": "",
      "color": "Pink",
      "visibleColor": {
        "r": 0.96,
        "g": 0.439,
        "b": 0.807
      },
      "id": 10
    },
    "11": {
      "title": "Black",
      "body": "",
      "color": "Black",
      "visibleColor": {
        "r": 0.25,
        "g": 0.25,
        "b": 0.25
      },
      "id": 11
    }
  },
  "VersionNumber": "v10.9.3"
}